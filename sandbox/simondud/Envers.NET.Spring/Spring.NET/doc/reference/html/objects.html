<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;5.&nbsp;The IoC container</title><link rel="stylesheet" href="styles/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_8103"><link rel="home" href="index.html" title="The Spring.NET Framework"><link rel="up" href="spring-core.html" title="Part&nbsp;I.&nbsp;Core Technologies"><link rel="prev" href="spring-core.html" title="Part&nbsp;I.&nbsp;Core Technologies"><link rel="next" href="objects-misc.html" title="Chapter&nbsp;6.&nbsp;The IObjectWrapper and Type conversion"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.springframework.net/" title="The Spring Framework"><img style="border:none;" src="images/xdev-spring_logo.jpg"></img></a><a style="border:none;" href="http://www.springsource.com/" title="SpringSource"><img style="border:none;position:absolute;padding-top:5px;right:42px;" src="images/S2-banner-rhs.png"></img></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="objects"></a>Chapter&nbsp;5.&nbsp;The IoC container</h2></div></div></div>
  

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-introduction"></a>5.1.&nbsp;Introduction</h2></div></div></div>
    

    <p>This chapter covers the Spring Framework implementation of the
    Inversion of Control (IoC) <sup>[<a name="d4e276" href="#ftn.d4e276" class="footnote">1</a>]</sup> principle</p>

    <p>The <code class="literal">Spring.Core</code> assembly is the basis for
    Spring.NET's IoC container. The <code class="literal"><a class="link" href="http://www.springframework.net/doc-latest/api/net-2.0/html/Spring.Core~Spring.Objects.Factory.IObjectFactory.html" target="_top">IObjectFactory</a></code>
    interface provides an advanced configuration mechanism capable of managing
    any type of object. <code class="literal"><a class="link" href="http://www.springframework.net/doc-latest/api/net-2.0/html/Spring.Core~Spring.Context.IApplicationContext.html" target="_top">IApplicationContext</a></code>
    is a sub-interface of <code class="literal">IObjectFactory</code>. It adds easier
    integration with Spring.NET's Aspect Oriented Programming (AOP) features,
    message resource handling (for use in internationalization), event
    propagation and application layer-specific context such as
    <code class="literal">WebApplicationContext</code> for use in web
    applications.</p>

    <p>In short, the <code class="literal">IObjectFactory</code> provides the
    configuration framework and basic functionality, and the
    <code class="literal">IApplicationContext</code> adds more enterprise-specific
    functionality. The <code class="literal">IApplicationContext</code> is a complete
    superset of the <code class="literal">IObjectFactory</code> and is used exclusively
    in this chapter in descriptions of Spring's IoC container.</p>

    <p>If you are new to Spring.NET or IoC containers in general, you may
    want to consider starting with <a class="xref" href="quickstarts.html" title="Chapter&nbsp;35.&nbsp;IoC Quickstarts">Chapter&nbsp;35, <i>IoC Quickstarts</i></a>, which
    contains a number of introductory level examples that actually demonstrate
    a lot of what is described in detail below. Don't worry if you don't
    absorb everything at once... those examples serve only to paint a picture
    of how Spring.NET hangs together in really broad brushstrokes. Once you
    have finished with those examples, you can come back to this section which
    will fill in all the fine detail.</p>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-basics"></a>5.2.&nbsp;Container overview</h2></div></div></div>
    

    <p>The interface <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span> represents
    the Spring IoC container and is responsible for instantiating,
    configuring, and assembling many of the objects in your application. The
    container gets its instructions on what objects to instantiate, configure,
    and assemble by reading configuration metadata. The configuration metadata
    is represented in XML. The configuration metadata allows you to express
    the objects that compose your application and the rich interdependencies
    between such objects.</p>

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
      <p>Note that other ways to specify the metadata, such as attributes
      and .NET code, are planned for future releases, the core IoC container
      does not assume any specific metadata format. The Java version of Spring
      already supports such functionality.</p>
    </td></tr></table></div>

    <p>Several implementations of the
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span> interface are supplied
    out-of-the-box with Spring. In standalone applications it is common to
    create an instance of an <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">XmlApplicationContext</span>
    either programmatically or declaratively in your applications App.config
    file. In web applications Spring provides a
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">WebApplicationContext</span> implementation which is
    configured by adding a custom HTTP module and HTTP handler to your
    Web.config file. See the section on <a class="link" href="web.html#web-configuration" title="22.3.1.&nbsp;Configuration of a web application">Web
    Configuration</a> for more details.</p>

    <p>The following diagram is a high-level view of how Spring works. Your
    application classes are combined with configuration metadata so that after
    the ApplicationContext is created and initialized, you have a fully
    configured and executable system or application.</p>

    <div class="mediaobject"><img src="images/container-in-action.gif"></div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-configuration-metadata"></a>5.2.1.&nbsp;Configuration metadata</h3></div></div></div>
      

      <p>As the preceding diagram shows, the Spring IoC container consumes
      a form of <span class="emphasis"><em>configuration metadata</em></span>; this
      configuration metadata represents how you as an application developer
      tell the Spring container to instantiate, configure, and assemble the
      objects in your application. Configuration metadata is supplied in a
      simple and intuitive XML format</p>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p>XML-based metadata is by far the most commonly used form of
        configuration metadata. It is not however the only form of
        configuration metadata that is allowed. The Spring IoC container
        itself is totally decoupled from the format in which this
        configuration metadata is actually written. Attribute based and code
        based metadata will be part of an upcoming release and it is already
        part of the Spring Java framework.</p>
      </td></tr></table></div>

      <p>Spring configuration consists of at least one and typically more
      than one object definition that the container must manage. XML- based
      configuration shows these objects as <code class="literal">&lt;object/&gt;</code>
      elements inside a top-level &lt;objects/&gt; element.</p>

      <p>These object definitions correspond to the actual objects that
      make up your application. Typically you define service layer objects,
      data access objects (DAOs), presentation objects such as ASP.NET page
      instances, infrastructure objects such as NHibernate
      <code class="literal">SessionFactories</code>, and so forth. Typically one does
      not configure fine-grained domain objects in the container, because it
      is usually the responsibility of DAOs and business logic to create/load
      domain objects.</p>

      <p>The following example shows the basic structure of XML-based
      configuration metadata:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"..."</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">&gt;</span>
    <i style="color: #008000">&lt;!-- collaborators and configuration for this object go here --&gt;</i>
  <span style="color: #A31515">&lt;/object&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"...."</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">&gt;</span>
    <i style="color: #008000">&lt;!-- collaborators and configuration for this object go here --&gt;</i>
  <span style="color: #A31515">&lt;/object&gt;</span>
 
  <i style="color: #008000">&lt;!-- more object definitions go here --&gt;</i>

<span style="color: #A31515">&lt;/objects&gt;</span></pre>

      <p>The <code class="literal">id</code> attribute is a string that you use to
      identify the individual object definition. The type attribute defines
      the type of the object and uses the fully qualified type name, including
      the assembly name. The value of the <code class="literal">id</code> attribute
      refers to collaborating objects. The XML for referring to collaborating
      objects is not shown in this example; <a class="link" href="objects.html#objects-dependencies" title="5.3.&nbsp;Dependencies">Dependencies</a> for more
      information.</p>

      <p>Spring.NET comes with an XSD schema to make the validation of the
      XML object definitions a whole lot easier. The XSD document is
      thoroughly documented so feel free to take a peek inside (see <a class="xref" href="springobjectsxsd.html" title="Appendix&nbsp;D.&nbsp;Spring.NET's spring-objects.xsd">Appendix&nbsp;D, <i>Spring.NET's spring-objects.xsd</i></a>). The XSD is currently used in the
      implementation code to validate the XML document. The XSD schema serves
      a dual purpose in that it also facilitates the editing of XML object
      definitions inside an XSD aware editor (typically Visual Studio) by
      providing validation (and Intellisense support in the case of Visual
      Studio). You may wish to refer to <a class="xref" href="vsnet.html" title="Chapter&nbsp;34.&nbsp;Visual Studio.NET Integration">Chapter&nbsp;34, <i>Visual Studio.NET Integration</i></a> for more
      information regarding such integration.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-instantiation"></a>5.2.2.&nbsp;Instantiating a container</h3></div></div></div>
      

      <p>Instantiating a Spring IoC container is straightforward. The
      location path or paths suppied to an IApplicationContext constructor are
      actually resource strings that allow the container to load configuration
      metadata from a variety of external resources such as the local file
      system, embedded assembly resources, and so on.</p>

      <pre class="programlisting">IApplicationContext context = <span style="color: #0000FF">new</span> XmlApplicationContext(<span style="color: #000000">"services.xml"</span>, <span style="color: #000000">"data-access.xml"</span>);
</pre>

      <p>The following example shows the service layer objects
      <code class="literal">(services.xml)</code> configuration file.</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span> 

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"PetStore"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"PetStore.Services.PetStoreService, PetStore"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"AccountDao"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"AccountDao"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ItemDao"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"ItemDao"</span><span style="color: #A31515">/&gt;</span>
    <i style="color: #008000">&lt;!-- additional collaborators and configuration for this object go here --&gt;</i>
  <span style="color: #A31515">&lt;/object&gt;</span>

  <i style="color: #008000">&lt;!-- more object definitions for services go here --&gt;</i>

<span style="color: #A31515">&lt;/objects&gt;</span></pre><p>The following example shows the data access
      objects <code class="literal">(daos.xml)</code> configuration file:</p>

      <pre class="programlisting">&lt;objects xmlns="http://www.springframework.net"&gt; 

  &lt;object id="AccountDao" type="Petstore.Dao.HibernateAccountDao, PetStore"&gt;
    &lt;!-- additional collaborators and configuration for this object go here --&gt;
  &lt;/object&gt;

  &lt;object id="ItemDao" type="Petstore.Dao.HibernateItemDao, PetStore"&gt;
    &lt;!-- additional collaborators and configuration for this object go here --&gt;
  &lt;/object&gt;
  
  &lt;!-- more object definitions for data access objects go here --&gt;
&lt;/objects&gt;</pre>

      <p>In the preceeding example, the service layer consists of the class
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">PetStoreService</span>, and two data access objects of
      the type <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">HibernateAccountDao</span> and
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">HibernateItemDao</span> are based on the NHibernate
      Object/Relational mapping framework. The property name element refers to
      the name of the class's property, and the ref element refers to the name
      of another object definition. This linkage between id and ref elements
      expresses the dependency between collaborating objects. For details of
      configuring an object's dependencies, see <a class="link" href="objects.html#objects-dependencies" title="5.3.&nbsp;Dependencies">Dependencies</a>.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e343"></a>5.2.2.1.&nbsp;Loading configuration metadata from non-default resource
        locations</h4></div></div></div>
        

        <p>In the previous example the configuration resources are assumed
        to be located in the bin\Debug directory. You can use Spring's
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF"><a xmlns="" class="link" href="http://www.springframework.net/doc-latest/api/net-2.0/html/Spring.Core~Spring.Core.IO.IResource.html" target="_top">IResource</a></span>
        abstraction to load resources from other locations.</p>

        <p>The following example shows how to create an IoC container
        referring to resources located in the root directory of the filesystem
        an as an embedded assembly resource.</p>

        <pre class="programlisting">IApplicationContext context = <span style="color: #0000FF">new</span> XmlApplicationContext(
                 <span style="color: #000000">"file:///services.xml"</span>,
                 <span style="color: #000000">"assembly://MyAssembly/MyDataAccess/data-access.xml"</span>);
</pre><p>The above example uses Spring.NET's <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF"><a xmlns="" class="link" href="http://www.springframework.net/doc-latest/api/net-2.0/html/Spring.Core~Spring.Core.IO.IResource.html" target="_top">IResource</a></span>
        abstraction. The <code class="literal">IResource</code> interface provides a
        simple and uniform interface to a wide array of IO resources that can
        represent themselves as <code class="literal">System.IO.Stream</code>.</p>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
          <p>After you learn about Spring's IoC container, you may want to
          know more about Spring's <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF"><a xmlns="" class="link" href="http://www.springframework.net/doc-latest/api/net-2.0/html/Spring.Core~Spring.Core.IO.IResource.html" target="_top">IResource</a></span>
          abstraction to load metadata from other locations as desribed below
          and alsoin the chapter <a class="xref" href="resources.html" title="Chapter&nbsp;7.&nbsp;Resources">Chapter&nbsp;7, <i>Resources</i></a></p>
        </td></tr></table></div>

        <p>These resources are most frequently files or URLs but can also
        be resources that have been embedded inside a .NET assembly. A simple
        URI syntax is used to describe the location of the resource, which
        follows the standard conventions for files, i.e.
        <code class="literal">file:///services.xml</code> and other well known protocols
        such as http.</p>

        <p>The following snippet shows the use of the URI syntax for
        referring to a resource that has been embedded inside a .NET assembly,
        <code class="literal">assembly://&lt;AssemblyName&gt;/&lt;NameSpace&gt;/&lt;ResourceName&gt;</code>.
        The <code class="literal">IResource</code> abstraction is explained further in
        <a class="xref" href="resources.html#objects-iresource" title="7.1.&nbsp;Introduction">Section&nbsp;7.1, &#8220;Introduction&#8221;</a>.</p>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
          <p>To create an embedded resource using Visual Studio you must
          set the Build Action of the .xml configuration file to Embedded
          Resource in the file property editor. Also, you will need to
          explicitly rebuild the project containing the configuration file if
          it is the only change you make between successive builds. If using
          NAnt to build, add a &lt;resources&gt; section to the csc task. For
          example usage, look at the Spring.Core.Tests.build file included the
          distribution.</p>
        </td></tr></table></div>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e368"></a>5.2.2.2.&nbsp;Declarative configuration of the container in
        App.config/Web.config</h4></div></div></div>
        

        <p>You can also create a container by using a custom configuration
        section in the standard .NET application configuration file (one of
        <code class="literal">App.config</code> or <code class="literal">Web.config</code>). A
        custom configuration section that creates the same
        <code class="literal">IApplicationContext</code> as the previous example is
        </p><pre class="programlisting"><span style="color: #A31515">&lt;spring&gt;</span>
  <span style="color: #A31515">&lt;context&gt;</span>
    <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"file://services.xml"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"assembly://MyAssembly/MyDataAccess/data-access.xml"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/context&gt;</span>
<span style="color: #A31515">&lt;/spring&gt;</span> </pre><p>The context type (specified as the value of
        the <code class="literal">type</code> attribute of the
        <code class="literal">context</code> element) is optional. In a standalone
        application the context type defaults to the
        <code class="literal">Spring.Context.Support.XmlApplicationContext</code> class
        and in a Web application defaults to WebApplicationContext. An example
        of explicitly configuring the context type The following example shows
        explicit use of the context type attribute: </p><pre class="programlisting"><span style="color: #A31515">&lt;spring&gt;</span>
  <span style="color: #A31515">&lt;context</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.XmlApplicationContext, Spring.Core"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"file:///services.xml"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"assembly://MyAssembly/MyDataAccess/data-access.xml"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/context&gt;</span>
<span style="color: #A31515">&lt;/spring&gt;</span></pre>

        <p>To acquire a reference to an
        <code class="literal">IApplicationContext</code> using a custom configuration
        section, one simply uses the following code; </p><pre class="programlisting">IApplicationContext ctx = ContextRegistry.GetContext();</pre><p>
        The <code class="literal">ContextRegistry</code> is used to both instantiate the
        application context and to perform service locator style access to
        other objects. (See <a class="xref" href="objects.html#objects-servicelocator" title="5.15.&nbsp;Service Locator access">Section&nbsp;5.15, &#8220;Service Locator access&#8221;</a> for more
        information). The glue that makes this possible is an implementation
        of the Base Class Library (BCL) provided
        <code class="literal">IConfigurationSectionHandler</code> interface, namely the
        <code class="literal">Spring.Context.Support.ContextHandler</code> class. The
        handler class needs to be registered in the
        <code class="literal">configSections</code> section of the .NET configuration
        file as shown below. </p><pre class="programlisting"><span style="color: #A31515">&lt;configSections&gt;</span>
  <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"context"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.ContextHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
<span style="color: #A31515">&lt;/configSections&gt;</span> </pre><p>This declaration now enables the use
        of a custom context section starting at the <code class="literal">spring</code>
        root element.</p>

        <p>In some usage scenarios, user code will not have to explicitly
        instantiate an appropriate implementation
        <code class="literal">IApplicationContext</code> interface, since Spring.NET
        code will do it for you. For example, the ASP.NET web layer provides
        support code to load a Spring.NET
        <code class="literal">WebApplicationContext</code> automatically as part of the
        normal startup process of an ASP.NET web application. As such, once
        the container has been created for you, it is often the case that you
        will never need to explicitly interact with it again in your code, for
        example when configuring ASP.NET pages.</p>

        <p>Spring.NET comes with an XSD schema to make the validation of
        the XML object definitions a whole lot easier. The XSD document is
        thoroughly documented so feel free to take a peek inside (see <a class="xref" href="springobjectsxsd.html" title="Appendix&nbsp;D.&nbsp;Spring.NET's spring-objects.xsd">Appendix&nbsp;D, <i>Spring.NET's spring-objects.xsd</i></a>). The XSD is currently used in the
        implementation code to validate the XML document. The XSD schema
        serves a dual purpose in that it also facilitates the editing of XML
        object definitions inside an XSD aware editor (typically Visual
        Studio) by providing validation (and Intellisense support in the case
        of Visual Studio). You may wish to refer to <a class="xref" href="vsnet.html" title="Chapter&nbsp;34.&nbsp;Visual Studio.NET Integration">Chapter&nbsp;34, <i>Visual Studio.NET Integration</i></a>
        for more information regarding such integration.</p>

        <p>Your XML object definitions can also be defined within the
        standard .NET application configuration file by registering the
        <code class="literal">Spring.Context.Support.DefaultSectionHandler</code> class
        as the configuration section handler for inline object definitions.
        This allows you to completely configure one or more
        <code class="literal">IApplicationContext</code> instances within a single
        standard .NET application configuration file as shown in the following
        example. </p><pre class="programlisting"><span style="color: #A31515">&lt;configuration&gt;</span>

  <span style="color: #A31515">&lt;configSections&gt;</span>
    <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"context"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.ContextHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objects"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.DefaultSectionHandler, Spring.Core"</span><span style="color: #A31515"> /&gt;</span>
    <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
  <span style="color: #A31515">&lt;/configSections&gt;</span>

  <span style="color: #A31515">&lt;spring&gt;</span>

    <span style="color: #A31515">&lt;context&gt;</span>
      <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"config://spring/objects"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/context&gt;</span>
       
    <span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>
        ...
    <span style="color: #A31515">&lt;/objects&gt;</span>

  <span style="color: #A31515">&lt;/spring&gt;</span>

<span style="color: #A31515">&lt;/configuration&gt;</span></pre>

        <p>Other options available to structure the configuration files are
        described in <a class="xref" href="objects.html#context-functionality-hierarchy" title="5.12.1.&nbsp;Context Hierarchies">Section&nbsp;5.12.1, &#8220;Context Hierarchies&#8221;</a> and
        <a class="xref" href="objects.html#objects-factory-xml-import" title="5.2.2.3.&nbsp;Composing XML-based configuration metadata">Section&nbsp;5.2.2.3, &#8220;Composing XML-based configuration metadata&#8221;</a>.</p>

        <p>The <code class="literal">IApplicationContext</code> can be configured to
        register other resource handlers, custom parsers to integrate
        user-contributed XML schema into the object definitions section, type
        converters, and define type aliases. These features are discussed in
        section <a class="xref" href="objects.html#context-configuration" title="5.11.&nbsp;Configuration of IApplicationContext">Section&nbsp;5.11, &#8220;Configuration of IApplicationContext&#8221;</a></p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-xml-import"></a>5.2.2.3.&nbsp;Composing XML-based configuration metadata</h4></div></div></div>
        

        <p>It can be useful to have object definitions span multiple XML
        files. Often each individual XML configuration file represents a
        logical layer or module in your architecture.</p>

        <p>You can use the <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span>
        constructor to load object definitions from all these XML fragments.
        This constructor takes multiple <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IResource</span>
        locations, as was shown in the previous section. Alternatively, use
        one or more occurrences of the <code class="literal">&lt;import/&gt;</code>
        element to load object definitions from another file (or files). For
        example:</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>

  <span style="color: #A31515">&lt;import</span> <span style="color: #FF0000">resource</span>=<span style="color: #0000FF">"services.xml"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;import</span> <span style="color: #FF0000">resource</span>=<span style="color: #0000FF">"resources/messageSource.xml"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;import</span> <span style="color: #FF0000">resource</span>=<span style="color: #0000FF">"/resources/themeSource.xml"</span><span style="color: #A31515">/&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"object1"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"object2"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">/&gt;</span>

<span style="color: #A31515">&lt;/objects&gt;</span></pre>

        <p>In the preceeding example, external object definitions are being
        loaded from three files, <code class="literal">services.xml</code>,
        <code class="literal">messageSource.xml</code>, and
        <code class="literal">themeSource.xml</code>. All location paths are relative to
        the definition file doing the importing, so
        <code class="literal">services.xml</code> must be in the same directory as the
        file doing the importing, while <code class="literal">messageSource.xml</code>
        and <code class="literal">themeSource.xml</code> must be in a
        <code class="literal">resources</code> location below the location of the
        importing file. As you can see, a leading slash is ignored, but given
        that these paths are relative, it is better form not to use the slash
        at all. The contents of the files being imported, including the top
        level <code class="literal">&lt;objects/&gt;</code> element, must be valid XML
        object definitions according to the Spring Schema.</p>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-client"></a>5.2.3.&nbsp;Using the container</h3></div></div></div>
      

      <p>An <code class="literal">IApplicationContext</code> is the interface for an
      advanced factory capable of maintaining a registry of different objects
      and their dependencies. Using the method
      <code class="literal">GetObject(string)</code> or the indexer
      <code class="literal">[string]</code> you can retrieve instances of your
      objects.</p>

      <p>The <code class="literal">IApplicationContext</code> enables you to read
      object definitions and access them as follows:</p>

      <pre class="programlisting"><i style="color: #008000">// create and configure objects</i>
IApplicationContext context = <span style="color: #0000FF">new</span> XmlApplicationContext(<span style="color: #000000">"services.xml"</span>, <span style="color: #000000">"daos.xml"</span>);

<i style="color: #008000">// retrieve configured instance</i>
PetStoreService service = (PetStoreService) context.GetObject(<span style="color: #000000">"PetStoreService"</span>);

<i style="color: #008000">// use configured instance</i>
IList userList = service.GetUserNames();
</pre>

      <p>You use the method <code class="literal">GetObject</code> to retrieve
      instances of your objects. The IApplicationContext interface has a few
      other methods for retrieving objects, but ideally your application code
      should never use them. Indeed, your application code should have no
      calls to the GetObject method at all, and thus no dependency on Spring
      APIs at all. For example, Spring's integration with web frameworks
      provides for dependency injection for various web framework classes such
      as ASP.NET pages and user controls.</p>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p>The syntactical inconvenience of the cast will be addressed in a
        future release of Spring.NET that is based on a generic API. Note,
        that even when using a generic API, looking up an object by name in no
        way guarantees that the return type will be that of the generic
        type.</p>
      </td></tr></table></div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-definition"></a>5.2.4.&nbsp;Object definition overview</h3></div></div></div>
      

      <p>A Spring IoC container manages one or more objects. These objects
      are created with the configuration metadata that you supply to the
      container.</p>

      <p>Within the container itself, these object definitions are
      represented as <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IObjectDefinition</span> objects, which
      contain (among other information) the following metadata: </p><div class="itemizedlist"><ul type="disc" compact><li>
            <p><span class="emphasis"><em>A type name</em></span>: typically the actual
            implementation class of the object being defined..</p>
          </li><li>
            <p>Object behavioral configuration elements, which state how
            the object should behave in the container (i.e. prototype or
            singleton, lifecycle callbacks, and so forth)</p>
          </li><li>
            <p>References to other objects which are needed for the object
            to do its work: these references are also called
            <span class="emphasis"><em>collaborators</em></span> or
            <span class="emphasis"><em>dependencies</em></span>.</p>
          </li><li>
            <p>Other configuration settings to set in the newly created
            object. An example would be the number of threads to use in an
            object that manages a worker thread pool, or the size limit of the
            pool.</p>
          </li></ul></div>

      <p>This metadata translates to a set of properties that make up each
      object definition. The following table lists some of these properties,
      with links to documentation </p><div class="table"><a name="d4e454"></a><div class="title">Table&nbsp;5.1.&nbsp;Object definition explanation</div><div class="table-contents">
          

          <table summary="Object definition explanation" border="1"><colgroup><col><col></colgroup><thead><tr><th>Property</th><th>More info</th></tr></thead><tbody><tr><td>type</td><td><a class="xref" href="objects.html#objects-factory-class" title="5.2.5.&nbsp;Instantiating objects">Section&nbsp;5.2.5, &#8220;Instantiating objects&#8221;</a></td></tr><tr><td>id and name</td><td><a class="xref" href="objects.html#objects-objectname" title="5.2.4.1.&nbsp;Naming objects">Section&nbsp;5.2.4.1, &#8220;Naming objects&#8221;</a></td></tr><tr><td>singleton or prototype</td><td><a class="xref" href="objects.html#objects-factory-scopes" title="5.4.&nbsp;Object Scopes">Section&nbsp;5.4, &#8220;Object Scopes&#8221;</a></td></tr><tr><td>object properties</td><td><a class="xref" href="objects.html#objects-factory-collaborators" title="5.3.1.&nbsp;Dependency injection">Section&nbsp;5.3.1, &#8220;Dependency injection&#8221;</a></td></tr><tr><td>constructor arguments</td><td><a class="xref" href="objects.html#objects-factory-collaborators" title="5.3.1.&nbsp;Dependency injection">Section&nbsp;5.3.1, &#8220;Dependency injection&#8221;</a></td></tr><tr><td>autowiring mode</td><td><a class="xref" href="objects.html#objects-factory-autowire" title="5.3.6.&nbsp;Autowiring collaborators">Section&nbsp;5.3.6, &#8220;Autowiring collaborators&#8221;</a></td></tr><tr><td>dependency checking mode</td><td><a class="xref" href="objects.html#objects-factory-dependencies" title="5.3.7.&nbsp;Checking for dependencies">Section&nbsp;5.3.7, &#8220;Checking for dependencies&#8221;</a></td></tr><tr><td>initialization method</td><td><a class="xref" href="objects.html#objects-factory-lifecycle" title="5.6.1.&nbsp;Lifecycle interfaces">Section&nbsp;5.6.1, &#8220;Lifecycle interfaces&#8221;</a></td></tr><tr><td>destruction method</td><td><a class="xref" href="objects.html#objects-factory-lifecycle" title="5.6.1.&nbsp;Lifecycle interfaces">Section&nbsp;5.6.1, &#8220;Lifecycle interfaces&#8221;</a></td></tr></tbody></table>
        </div></div><p><br class="table-break"></p>

      <p>In addition to object definitions which contain information on how
      to create a specific object, the
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span> implementations also permit
      the registration of existing objects that are created outside the
      container, by users. This is done by accessing the
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">ApplicationContext's</span>
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IObjectFactory</span> via the property
      <code class="literal">ObjectFactory</code> which returns the
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IObjectFactory</span> implementation
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">DefaultListableObjectFactory</span>.
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">DefaultListableObjectFactory</span> supports
      registration through the methods
      <code class="literal">RegisterSingleton(..)</code> and
      <code class="literal">RegisterObjectDefinition(..)</code>. However, typical
      applications work soley with objects defined through metadata object
      definitions.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-objectname"></a>5.2.4.1.&nbsp;Naming objects</h4></div></div></div>
        

        <p>Every object has one or more identifiers. These identifiers must
        be unique within the container that hosts the objects. An object
        usually has only one identifier, but if it requires more than one, the
        extra ones can be considered aliases.</p>

        <div class="sidebar"><div class="title"></div>
          <p>A convention that has evolved is to use the standard C#
          convention for Property names when naming objects. That is, object
          names start with a uppercase letter, and are camel-cased from then
          on. Examples of such names would be (without quotes)
          'AccountManager', 'AccountService', 'UserDao', 'LoginController',
          and so forth.</p>

          <p>Naming object consistently makes your configuration easier to
          read and understand, and if you are using Spring AOP it helps a lot
          when applying advice to a set of objects related by name.</p>
        </div>

        <p>When using XML-based configuration metadata, you use the
        <code class="literal">'id'</code> and/or <code class="literal">'name'</code>attributes to
        specify the object identifier(s). The <code class="literal">'id'</code>
        attribute allows you to specify exactly one id, and because it is a
        real XML element ID attribute, the XML parser is able to do some extra
        validation when other elements reference the id. As such, it is the
        preferred way to specify an object id. However, the XML specification
        does limit the characters which are legal in XML IDs. This is usually
        not a constraint, but if you have a need to use one of these special
        XML characters, or want to introduce other aliases to the object, you
        can specify them in the <code class="literal">'name'</code> attribute ,
        separated by a comma (<code class="literal">,</code>), semicolon
        (<code class="literal">;</code>), or whitespace.</p>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
          <p>You are not required to supply a name or id for a object. If
          no name or id is supplied explicitly, the container will generate a
          unique name for that object. However, if you want to refer to that
          object by name, through the use of the ref element or Service
          Location style lookup, you must provide a name. The motivations for
          not supplying a name for a object are to use <a class="link" href="objects.html#objects-factory-autowire" title="5.3.6.&nbsp;Autowiring collaborators">autowiring</a> and <a class="link" href="objects.html#objects-inline-object" title="5.3.2.3.&nbsp;Inner objects">inline-objects</a> which will be
          discussed later.</p>
        </td></tr></table></div>

        <div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d4e527"></a>5.2.4.1.1.&nbsp;Aliasing an object outside the object definition</h5></div></div></div>
          

          <p>In an object definition itself, you may supply more than one
          name for the object, by using a combination of up to one name
          specified by the <code class="literal">id</code> attribute, and any number of
          other names in the <code class="literal">name</code> attribute. These names
          are equivalent aliases to the same object, and are useful for some
          situations, such as allowing each component in an application to
          refer to a common dependency by using a object name that is specific
          to that component itself.</p>

          <p>Specifying all aliases where the object is actually defined is
          not always adequate, however. It is sometimes desirable to introduce
          an alias for an object that is defined elsewhere. This is commonly
          the case in large systems where configuration is split amongst each
          subsystem, each subsystem having its own set of object defintions.
          In XML-based configuration metadata, you can use of the
          &lt;alias/&gt; element to accomplish this.</p>

          <pre class="programlisting"> <span style="color: #A31515">&lt;alias</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"fromName"</span> <span style="color: #FF0000">alias</span>=<span style="color: #0000FF">"toName"</span><span style="color: #A31515">/&gt;</span></pre>

          <p>In this case, an object in the same container which is named
          <code class="literal">fromName</code>, may also after the use of this alias
          definition, be referred to as <code class="literal">toName</code>.</p>

          <p>For example, the configuration metadata for subsystem A may
          refer to a DbProvider via the name 'SubsystemA-DbProvider. The
          configuration metadata for subsystem B may refer to a DbProvider via
          the name 'SubsystemB-DbProvider'. When composing the main
          application that uses both these subsystems the main application
          refers to the DbProvider via the name 'MyApp-DbProvider'. To have
          all three names refer to the same object you add to the MyApp
          configuration metadata the following aliases definitions:</p>

          <pre class="programlisting">&lt;alias name="SubsystemA-DbProvider" alias="SubsystemB-DbProvider"/&gt;
&lt;alias name="SubsystemA-DbProvider" alias="MyApp-DbProvider"/&gt;</pre>

          <p>Now each component and the main app can refer to the
          connection through a name that is unique and guaranteed not to clash
          with any other definition (effectively there is a namespace), yet
          they refer to the same object.</p>
        </div>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-class"></a>5.2.5.&nbsp;Instantiating objects</h3></div></div></div>
      

      <p>An object definition essentially is a recipe for creating one or
      more objects. The container looks at the recipe for a named object when
      asked, and uses the configuration metadata encapsulated by that object
      definition to create (or acquire) an actual object.</p>

      <p>If you are using XML-based configuration metadata, you can specify
      the type of object that is to be instantiated in the
      <code class="literal">'type'</code> attribute of the
      <code class="literal">&lt;object/&gt;</code> element. This
      <code class="literal">'type'</code> attribute (which internally is a
      <code class="literal">Type</code> property on a
      <code class="literal">IObjectDefinition</code> instance) is usually mandatory.
      (For exceptions see the section called <a class="link" href="objects.html#objects-factory-class-instance-factory-method" title="5.2.5.3.&nbsp;Object creation via an instance factory method">Instantiation
      using an instance factory method </a>and <a class="link" href="objects.html#objects-childobjects" title="5.7.&nbsp;Object definition inheritance">Object definition inheritance</a>.)
      You use the Type property in one of two ways:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Typically, to specify the type of of the object to be
          constructed in the case where the container itself directly creates
          the object by calling its constructor reflectively, somewhat
          equivalent to C# code using the <span class="emphasis"><em>'new'</em></span>
          operator.</p>
        </li><li>
          <p>To specify the actual class containing the
          <code class="literal">static</code> factory method that will be invoked to
          create the object, in the less common case where the container
          invokes a <code class="literal">static</code> <span class="emphasis"><em>factory</em></span>
          method on a class to create the object. The object type returned
          from the invocation of the <code class="literal">static</code> factory method
          may be the same type or another type entirely.</p>
        </li></ul></div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-class-ctor"></a>5.2.5.1.&nbsp;Instantiatoin with a constructor</h4></div></div></div>
        

        <p>When you create an object using the constructor approach, all
        normal classes are usable by and compatible with Spring. That is, the
        class being developed does not need to implement any specific
        interfaces or to be coded in a specific fashion. Simply specifying the
        object type should be sufficient. However, depending on what type of
        IoC you are going to use for that specific object, you may need to
        create a default constructor.</p>

        <p>With XML-based configuration metadata you can specify your
        object class as follows: </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span></pre>

        <p>For details about the mechanism for supplying arguments to the
        constructor (if required), and setting object instance properties
        after the object is constructed, see <a class="xref" href="objects.html#objects-factory-collaborators" title="5.3.1.&nbsp;Dependency injection">Section&nbsp;5.3.1, &#8220;Dependency injection&#8221;</a>.</p>

        <p>This XML fragment describes an object definition that will be
        identified by the <span class="emphasis"><em>exampleObject</em></span> name, instances
        of which will be of the <code class="literal">Examples.ExampleObject</code> type
        that has been compiled into the <code class="literal">ExamplesLibrary</code>
        assembly. Take special note of the structure of the
        <code class="literal">type</code> attribute's value... the namespace-qualified
        name of the class is specified, followed by a comma, followed by (at a
        bare minimum) the name of the assembly that contains the class. In the
        preceding example, the <code class="literal">ExampleObject</code> class is
        defined in the <code class="literal">Examples</code> namespace, and it has been
        compiled into the <code class="literal">ExamplesLibrary</code> assembly.</p>

        <p>The name of the assembly that contains the type
        <span class="emphasis"><em>must</em></span> be specified in the <code class="literal">type</code>
        attribute. Furthermore, it is recommended that you specify the fully
        qualified assembly name <sup>[<a name="d4e579" href="#ftn.d4e579" class="footnote">2</a>]</sup> in order to guarantee that the type that Spring.NET uses
        to instantiate your object (s) is indeed the one that you expect.
        Usually this is only an issue if you are using classes from (strongly
        named) assemblies that have been installed into the Global Assembly
        Cache (GAC).</p>

        <p>If you have defined nested classes use the addition symbol, +,
        to reference the nested class. For example, if the class
        <code class="literal">Examples.ExampleObject</code> had a nested class
        <code class="literal">Person</code> the XML declaration would be </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject+Person, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span></pre>

        <p>If you are defining classes that have been compiled into
        assemblies that are available to your application (such as the
        <code class="literal">bin</code> directory in the case of ASP.NET applications)
        via the standard assembly probing mechanisms, then you can specify
        simply the name of the assembly (e.g.
        <code class="literal">ExamplesLibrary.Data</code>)... this way, when (or if) the
        assemblies used by your application are updated, you won't have to
        change the value of every <code class="literal">&lt;object/&gt;</code>
        definition's <code class="literal">type</code> attribute to reflect the new
        version number (if the version number has changed)... Spring.NET will
        automatically locate and use the newer versions of your assemblies
        (and their attendant classes) from that point forward.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-class-static-factory-method"></a>5.2.5.2.&nbsp;Instantiation with a static factory method</h4></div></div></div>
        

        <p>When defining an object which is to be created using a static
        factory method, you use the type attribute to specify the type
        containing the static factory method and an attribute named
        factory-method to specify the name of the factory method itself. You
        should be able to call this method (with an optional list of arguments
        as described later) and return a live object, which subsequently is
        treated as if it had been created through a constructor. One use for
        such an object definition is to call static factories in legacy
        code.</p>

        <p>The following object definition specifies that the object will
        be created by calling a factory-method. The definition does not
        specify the type of the returned object, only the type containing the
        factory method. In this example, <code class="literal">CreateInstance</code>
        must be a static method. </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span>
      <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObjectFactory, ExamplesLibrary"</span>
      <span style="color: #FF0000">factory-method</span>=<span style="color: #0000FF">"CreateInstance"</span><span style="color: #A31515">/&gt;</span></pre>

        <p>For details about the mechanism for supplying (optional)
        arguments to the factory method and setting object instance properties
        after it has been returned from the factory, see <a class="xref" href="objects.html#object-factory-properties-detailed" title="5.3.2.&nbsp;Dependencies and configuration in detail">Section&nbsp;5.3.2, &#8220;Dependencies and configuration in detail&#8221;</a></p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-class-instance-factory-method"></a>5.2.5.3.&nbsp;Object creation via an instance factory method</h4></div></div></div>
        

        <p>Similar to instantiation through a <a class="link" href="objects.html#objects-factory-class-static-factory-method" title="5.2.5.2.&nbsp;Instantiation with a static factory method">static factory
        method</a>, instantiation with an instance factory method invokes a
        a non-static method on an existing object from the container to create
        a new object. To use this mechanism, leave the <code class="literal">type</code>
        attribute empty, and in the <code class="literal">factory-object</code>
        attribute specify the name of an object in the current (or
        parent/ancestor) container that contains the instance method that is
        to be invoked to create the object. Set the name of the factory method
        itself with the <code class="literal">factory-method</code>
        attribute.</p><pre class="programlisting"><i style="color: #008000">&lt;!-- the factory object, which contains an instance method called 'CreateInstance' --&gt;</i>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleFactory"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">&gt;</span>
  <i style="color: #008000">&lt;!-- inject any dependencies required by this object --&gt;</i>
<span style="color: #A31515">&lt;/object&gt;</span>

<i style="color: #008000">&lt;!-- the object that is to be created by the factory object --&gt;</i>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span>
      <span style="color: #FF0000">factory-method</span>=<span style="color: #0000FF">"CreateInstance"</span>
      <span style="color: #FF0000">factory-object</span>=<span style="color: #0000FF">"exampleFactory"</span><span style="color: #A31515">/&gt;</span></pre>

        <p>This approach shows that the factory object itself can be
        managed and configured through dependency injection (DI). See <a class="link" href="objects.html#object-factory-properties-detailed" title="5.3.2.&nbsp;Dependencies and configuration in detail">Dependencies and
        configuraiton in detail</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
            <p>In Spring documentation, '<span class="emphasis"><em>factory
            object</em></span>', refers to an object that is configured in the
            Spring container that will create objects via an <a class="link" href="objects.html#objects-factory-class-instance-factory-method" title="5.2.5.3.&nbsp;Object creation via an instance factory method">instance</a>
            or <a class="link" href="objects.html#objects-factory-class-static-factory-method" title="5.2.5.2.&nbsp;Instantiation with a static factory method">static</a>
            factory method. By contrast, <code class="literal">IFactoryObject</code>
            (notice the capitalization) refers to a Spring-specific
            <code class="literal">IFactoryObject</code> .</p>
          </td></tr></table></div>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-creation-generic-types"></a>5.2.6.&nbsp;Object creation of generic types</h3></div></div></div>
      

      <p>Generic types can also be created in much the same manner an
      non-generic types.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-generic-class-ctor"></a>5.2.6.1.&nbsp;Object creation of generic types via constructor
        invocation</h4></div></div></div>
        

        <p>The following examples shows the definition of simple generic
        types and how they can be created in Spring's XML based configuration
        file. </p><pre class="programlisting"><span style="color: #0000FF">namespace</span> GenericsPlay
{
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> FilterableList&lt;T&gt;
    {
        <span style="color: #0000FF">private</span> List&lt;T&gt; list;
        
        <span style="color: #0000FF">private</span> String name;

        <span style="color: #0000FF">public</span> List&lt;T&gt; Contents
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> list; }
            <span style="color: #0000FF">set</span> { list = <span style="color: #0000FF">value</span>; }
        }

        <span style="color: #0000FF">public</span> String Name
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> name; }
            <span style="color: #0000FF">set</span> { name = <span style="color: #0000FF">value</span>; }
        }
        
        <span style="color: #0000FF">public</span> List&lt;T&gt; ApplyFilter(<span style="color: #0000FF">string</span> filterExpression)
        {
            <b>/// should really apply filter to list ;)</b>
            <span style="color: #0000FF">return</span> <span style="color: #0000FF">new</span> List&lt;T&gt;();
        }

    }
}</pre><p> The XML configuration to create and configure this object
        is shown below </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myFilteredIntList"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"GenericsPlay.FilterableList&amp;lt;int&gt;, GenericsPlay"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Name"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"My Integer List"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre><p> There are a few items to note in terms how to
        specify a generic type. First, the left bracket that specifies the
        generic type, i.e. <code class="literal">&lt;</code>, is replaced with the
        string &amp;lt; due to XML escape syntax for the less than symbol.
        Yes, we all realize this is less than ideal from the readability point
        of view. Second, the generic type arguments can not be fully assembly
        qualified as the comma is used to separate generic type arguments.
        Alternative characters used to overcome the two quirks can be
        implemented in the future but so far, all proposals don't seem to help
        clarify the text. The suggested solution to improve readability is to
        use type aliases as shown below </p><pre class="programlisting"><span style="color: #A31515">&lt;typeAliases&gt;</span>
 <span style="color: #A31515">&lt;alias</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"GenericDictionary"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">" System.Collections.Generic.Dictionary&amp;lt;,&gt;"</span><span style="color: #A31515"> /&gt;</span>
 <span style="color: #A31515">&lt;alias</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myDictionary"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"System.Collections.Generic.Dictionary&amp;lt;int,string&gt;"</span><span style="color: #A31515"> /&gt;</span>
<span style="color: #A31515">&lt;/typeAliases&gt;</span>
</pre><p> So that instead of something like this </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myGenericObject"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"GenericsPlay.ExampleGenericObject&amp;lt;System.Collections.Generic.Dictionary&amp;lt;int , string&gt;&gt;, GenericsPlay"</span><span style="color: #A31515"> /&gt;</span></pre><p>
        It can be shortened to </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myOtherGenericObject"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"GenericsPlay.ExampleGenericObject&amp;lt;GenericDictionary&amp;lt;int , string&gt;&gt;, GenericsPlay"</span><span style="color: #A31515"> /&gt;</span></pre><p>
        or even shorter </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myOtherOtherGenericObject"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"GenericsPlay.ExampleGenericObject&amp;lt;MyIntStringDictionary&gt;, GenericsPlay"</span><span style="color: #A31515"> /&gt;</span>
</pre><p> Refer to <a class="xref" href="objects.html#context-configuration" title="5.11.&nbsp;Configuration of IApplicationContext">Section&nbsp;5.11, &#8220;Configuration of IApplicationContext&#8221;</a> for
        additional information on using type aliases.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-generic-static-factory"></a>5.2.6.2.&nbsp;Object creation of generic types via static factory
        method</h4></div></div></div>
        

        <p>The following classes are used to demonstrate the ability to
        create instances of generic types that themselves are created via a
        static generic factory method. </p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> TestGenericObject&lt;T, U&gt;
{
    <span style="color: #0000FF">public</span> TestGenericObject()
    {
    }

    <span style="color: #0000FF">private</span> IList&lt;T&gt; someGenericList = <span style="color: #0000FF">new</span> List&lt;T&gt;();
    
    <span style="color: #0000FF">private</span> IDictionary&lt;<span style="color: #0000FF">string</span>, U&gt; someStringKeyedDictionary =
        <span style="color: #0000FF">new</span> Dictionary&lt;<span style="color: #0000FF">string</span>, U&gt;();

    <span style="color: #0000FF">public</span> IList&lt;T&gt; SomeGenericList
    {
        <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> someGenericList; }
        <span style="color: #0000FF">set</span> { someGenericList = <span style="color: #0000FF">value</span>; }
    }

    <span style="color: #0000FF">public</span> IDictionary&lt;<span style="color: #0000FF">string</span>, U&gt; SomeStringKeyedDictionary
    {
        <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> someStringKeyedDictionary; }
        <span style="color: #0000FF">set</span> { someStringKeyedDictionary = <span style="color: #0000FF">value</span>; }
    }

}</pre><p> The accompanying factory class is </p><pre class="programlisting">
<span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> TestGenericObjectFactory
{
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">static</span> TestGenericObject&lt;V, W&gt; StaticCreateInstance&lt;V, W&gt;()
    {
        <span style="color: #0000FF">return</span> <span style="color: #0000FF">new</span> TestGenericObject&lt;V, W&gt;();
    }

    <span style="color: #0000FF">public</span> TestGenericObject&lt;V, W&gt; CreateInstance&lt;V, W&gt;()
    {
        <span style="color: #0000FF">return</span> <span style="color: #0000FF">new</span> TestGenericObject&lt;V, W&gt;();
    }
}
</pre><p> The XML snippet to create an instance of TestGenericObject
        where <code class="literal">V</code> is a List of integers and
        <code class="literal">W</code> is an integer is shown below </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myTestGenericObject"</span>
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"GenericsPlay.TestGenericObjectFactory, GenericsPlay"</span>
        <span style="color: #FF0000">factory-method</span>=<span style="color: #0000FF">"StaticCreateInstance&amp;lt;System.Collections.Generic.List&amp;lt;int&gt;,int&gt;"</span><span style="color: #A31515">
/&gt;</span></pre><p> The StaticCreateInstance method is responsible for
        instantiating the object that will be associated with the id
        'myTestGenericObject'.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-generic-instance-factory"></a>5.2.6.3.&nbsp;Object creation of generic types via instance factory
        method</h4></div></div></div>
        

        <p>Using the class from the previous example the XML snippet to
        create an instance of a generic type via an instance factory method is
        shown below </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleFactory"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"GenericsPlay.TestGenericObject&amp;lt;int,string&gt;, GenericsPlay"</span><span style="color: #A31515">/&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"anotherTestGenericObject"</span>
        <span style="color: #FF0000">factory-object</span>=<span style="color: #0000FF">"exampleFactory"</span> 
        <span style="color: #FF0000">factory-method</span>=<span style="color: #0000FF">"CreateInstance&amp;lt;System.Collections.Generic.List&amp;lt;int&gt;,int&gt;"</span><span style="color: #A31515">/&gt;</span>
</pre><p> This creates an instance of
        <code class="literal">TestGenericObject&lt;List&lt;int&gt;,int&gt;</code></p>
      </div>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-dependencies"></a>5.3.&nbsp;Dependencies</h2></div></div></div>
    

    <p>A typical enterprise application does not consist of a single
    object. Even the simplest application has a few objects that work together
    to present what the end-user sees as a coherent application. This next
    section explains how you go from defining a number of object definitions
    that stand-alone to a fully realized application where objects collaborate
    to achieve a goal.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-collaborators"></a>5.3.1.&nbsp;Dependency injection</h3></div></div></div>
      

      <p>Dependency injection (DI) is a process whereby objects define
      their dependencies, that is, the other objects they work with, only
      through constructor arguments and properties that are set on the object
      instance after it is constructed. (Factory methods may be considered a
      special case of providing constructor arguments for the purposes of this
      description). The container injects these dependencies when it creates
      the object. This process is fundamentally the inverse to the case when
      the object itself is controlling the instantiation or location of its
      dependencies by using direct construction of classes, or the Service
      Locator pattern. The inverting of this responsibility is why the name
      Inversion of Control (IoC) is used to describe the container's
      actions.</p>

      <p>Code is cleaner when using DI and decoupling is more effective
      when objects are provided with their dependencies. The object does not
      look up its dependencies, and does not know the location or class of the
      dependencies. Long sections of initialization code that you used to hide
      in a #region tag simply go away, and are placed by container
      configuration metadata. One can also consider this clean up an
      application of the principal of Separation of Concerns. Before using DI,
      you class was responsible for business logic AND its configuration, it
      was concerns with doing more than one thing. DI removes the
      responsibility of configuration from the class, leaving it only with a
      single purpose, as the location of business logic. Furthermore, since
      you class does not know the location of its dependencies these classes
      also become easier to test, in particular when the dependencies are
      interfaces or abstract base classes allowing for stub or mock
      implementation to be used in unit tests.</p>

      <p>Dependency injection exists in two major variants,
      Constructor-based dependency injection and Setter-based dependency
      injection.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-ctor-injection"></a>5.3.1.1.&nbsp;Constructor-based dependency injection</h4></div></div></div>
        

        <p>Constructor-based DI is accomplished by the container invoking a
        constructor with a number of arguments, each representing a
        dependency. Calling a static factory method with specific arguments to
        construct the object is nearly equivalent, and this discussion treats
        arguments to a constructor and to a static factory method similarly.
        The following example shows a class that can only be
        dependency-injected with constructor injection. Notice that there is
        nothing special about this class (no container specific interfaces,
        base classes or attributes)</p>

        <pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> SimpleMovieLister
{
  <i style="color: #008000">// the SimpleMovieLister has a dependency on a MovieFinder</i>
  <span style="color: #0000FF">private</span> IMovieFinder movieFinder;

  <i style="color: #008000">// a constructor so that the Spring container can 'inject' a MovieFinder</i>
  <span style="color: #0000FF">public</span> MovieLister(IMovieFinder movieFinder)
  {
    <span style="color: #0000FF">this</span>.movieFinder = movieFinder;
  }

  <i style="color: #008000">// business logic that actually 'uses' the injected IMovieFinder is omitted...</i>

}</pre>

        <div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="objects-ctor-arg-resolution"></a>5.3.1.1.1.&nbsp;Constructor argument resolution</h5></div></div></div>
          

          <p>Constructor argument resolution matching occurs using the
          argument's type. If ambiguity exists in the constructor arguments of
          a object definition, then the order in which the constructor
          arguments are defined in a object definition is the order in which
          those arguments are supplied to the appropriate constructor when the
          object being instantiated. Consider the following class:</p>

          <pre class="programlisting"><span style="color: #0000FF">namespace</span> X.Y
{
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> Foo
    {
        <span style="color: #0000FF">public</span> Foo(Bar bar, Baz baz)
        {
           <i style="color: #008000">// ...</i>
        }
    }
}</pre>

          <p>No potential ambiguity exists, assuming of course that Bar and
          Baz classes are not related by inheritance. Thus the following
          configuration will work just fine, and you do not need to specify
          the constructor argument indexes and / or types explicitly in the
          <code class="literal">&lt;contructor-arg/&gt;</code> element.</p>

          <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"foo"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"X.Y.Foo, Example"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"bar"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"baz"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>   

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"bar"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"X.Y.Bar, Example"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"baz"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"X.Y.Baz, Example"</span><span style="color: #A31515">/&gt;</span>
</pre>

          <p>When another object is referenced, the type is known, and
          matching can occur (as was the case with the preceding
          example).</p>

          <p>When a simple type is used, such as
          <code class="literal">&lt;value&gt;true&lt;value&gt;</code>, Spring cannot
          determine the type of the value, and so cannot match by type without
          help. Consider the following class:</p>

          <pre class="programlisting"><span style="color: #0000FF">using</span> System;

<span style="color: #0000FF">namespace</span> SimpleApp
{
  <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> ExampleObject
  {
    <span style="color: #0000FF">private</span> <span style="color: #0000FF">int</span> years;              <i style="color: #008000">//No. of years to the calculate the Ultimate Answer</i>

    <span style="color: #0000FF">private</span> <span style="color: #0000FF">string</span> ultimateAnswer;  <i style="color: #008000">//The Answer to Life, the Universe, and Everything</i>

    <span style="color: #0000FF">public</span> ExampleObject(<span style="color: #0000FF">int</span> years, <span style="color: #0000FF">string</span> ultimateAnswer)
    {
       <span style="color: #0000FF">this</span>.years = years;
       <span style="color: #0000FF">this</span>.ultimateAnswer = ultimateAnswer;
    }

}</pre>

          <div class="sect5" lang="en"><div class="titlepage"><div><div><h6 class="title"><a name="objects-ctor-arg-type-matching"></a>5.3.1.1.1.1.&nbsp;Constructor argument type matching</h6></div></div></div>
            

            <p>In the preceding scenario, the container
            <span class="emphasis"><em>can</em></span> use type matching with simple types by
            explicitly specifying the type of the constructor argument using
            the <code class="literal">'type'</code> attribute. For example:
            </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SimpleApp.ExampleObject, SimpleApp"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"int"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"7500000"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"string"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"42"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

            <p>The type attribute specifies the
            <code class="literal">System.Type</code> of the constructor argument, such
            as System.Int32. Alias' are available to for common simple types
            (and their array equivalents). These alias' are... </p><div class="table"><a name="d4e675"></a><div class="title">Table&nbsp;5.2.&nbsp;Type aliases</div><div class="table-contents">
                

                <table summary="Type aliases" border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Type</th><th>Alias'</th><th>Array Alias'</th></tr></thead><tbody><tr><td>System.Char</td><td>char, Char</td><td>char[], Char()</td></tr><tr><td>System.Int16</td><td>short, Short</td><td>short[], Short()</td></tr><tr><td>System.Int32</td><td>int, Integer</td><td>int[], Integer()</td></tr><tr><td>System.Int64</td><td>long, Long</td><td>long[], Long()</td></tr><tr><td>System.UInt16</td><td>ushort</td><td>ushort[]</td></tr><tr><td>System.UInt32</td><td>uint</td><td>uint[]</td></tr><tr><td>System.UInt64</td><td>ulong</td><td>ulong[]</td></tr><tr><td>System.Float</td><td>float, Single</td><td>float[], Single()</td></tr><tr><td>System.Double</td><td>double, Double</td><td>double[], Double()</td></tr><tr><td>System.Date</td><td>date, Date</td><td>date[], Date()</td></tr><tr><td>System.Decimal</td><td>decimal, Decimal</td><td>decimal[], Decimal()</td></tr><tr><td>System.Bool</td><td>bool, Boolean</td><td>bool[], Boolean()</td></tr><tr><td>System.String</td><td>string, String</td><td>string[], String()</td></tr></tbody></table>
              </div></div><p><br class="table-break"></p>
          </div>

          <div class="sect5" lang="en"><div class="titlepage"><div><div><h6 class="title"><a name="objects-ctor-arg-index"></a>5.3.1.1.1.2.&nbsp;Constructor argument Index</h6></div></div></div>
            

            <p>Use the <code class="literal">index</code> attribute to specify
            explicitly the index of constructor arguments. For example:</p>

            <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SimpleApp.ExampleObject, SimpleApp"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">index</span>=<span style="color: #0000FF">"0"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"7500000"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">index</span>=<span style="color: #0000FF">"1"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"42"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre><p>In addition to resolving the ambiguity of
            multiple simple values, specifying an index also resolves
            ambiguity where a constructor has two arguments of the same type.
            Note that the <span class="emphasis"><em>index is 0 based</em></span>.</p>
          </div>

          <div class="sect5" lang="en"><div class="titlepage"><div><div><h6 class="title"><a name="objects-ctor-arg-by-name"></a>5.3.1.1.1.3.&nbsp;Constructor arguments by name</h6></div></div></div>
            

            <p>You can specify constructor argumetn by name using
            <code class="literal">name</code> attribute of the
            <code class="literal">&lt;constructor-arg&gt;</code> element.</p>

            <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SimpleApp.ExampleObject, SimpleApp"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"years"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"7500000"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ultimateAnswer"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"42"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
          </div>
        </div>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-setter-injection"></a>5.3.1.2.&nbsp;Setter-based dependency injection</h4></div></div></div>
        

        <p>Setter-based DI is accomplished by the container invoking setter
        properties on your objects after invoking a no-argument constructor or
        no-argument static factory method to instantiate your object.</p>

        <p>The following eample shows a class that can only be dependency
        injected using pure setter injection.</p>

        <pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> MovieLister
{
  <span style="color: #0000FF">private</span> IMovieFinder movieFinder;

  <span style="color: #0000FF">public</span> IMovieFinder MovieFinder
  {
      <span style="color: #0000FF">set</span>
      {
          movieFinder = <span style="color: #0000FF">value</span>;
      }
  }

  <i style="color: #008000">// business logic that actually 'uses' the injected IMovieFinder is omitted...</i>
}</pre>

        <div class="sidebar"><div class="title">Constructor-based or setter-based DI?</div>
          

          <p>The Spring team generally advocates the usage of setter
          injection, since a large number of constructor arguments can get
          unwieldy, especially when some properties are optional. The presence
          of setter properties also makes objects of that class amenable to
          reconfigured or reinjection later. Managment through WMI is a
          compelling use case.</p>

          <p>Some purists favor constructor-based injection. Supplying all
          object dependencies means that the object is always returned to
          client (calling) code in a totally initialized state. The
          disadvantage is that the object becomes less amenable to
          reconfiguration and re-injection.</p>

          <p>Use the DI that makes the most sense for a particular class.
          Sometimes, when dealing with third-party classes to which you do not
          have the source, the choice is made for you. A legacy class may not
          expose any setter methods, and so constructor injection is the only
          available DI.</p>

          <p>Since you can mix both, Constructor- and Setter-based DI, it
          is a good rule of thumb to use constructor arguments for mandatory
          dependencies and setters for optional dependencies.</p>
        </div>

        <p>The <code class="literal">IAppliationContext</code> supports constructor-
        and setter-based DI for the objects it manages. It also supports
        setter-based DI after some dependencies have already been supplied via
        the constructor approach..</p>

        <p>The configuration for the dependencies comes in the form of the
        <code class="literal">IObjectDefinition</code> class, which is used together
        with <code class="literal">TypeConverters</code> to know how to convert
        properties from one format to another. However, most users of
        Spring.NET will not be dealing with these classes directly (that is
        programatically), but rather with an XML definition file which will be
        converted internally into instances of these classes, and used to load
        an entire Spring IoC container instance. Refer to <a class="xref" href="objects-misc.html#objects-objects-conversion" title="6.3.&nbsp;Type conversion">Section&nbsp;6.3, &#8220;Type conversion&#8221;</a> for more information regarding
        type conversion, and how you can design your classes to be convertible
        by Spring.NET.</p>

        <p>The container resolves object dependeices as: </p><div class="orderedlist"><ol type="1" compact><li>
              <p>The <code class="literal">IApplicationContext</code> is created and
              initialized with a configuration that describes all the objects.
              Most Spring.NET users use an <code class="literal">IObjectFactory</code>
              or <code class="literal">IApplicationContext</code> variant that supports
              XML format configuration files.</p>
            </li><li>
              <p>Each object has dependencies expressed in the form of
              properties, constructor arguments, or arguments to the
              static-factory method if you are using that instead of a normal
              constructor. These dependencies apre provided to the object,
              <span class="emphasis"><em>when the object is actually created</em></span>.</p>
            </li><li>
              <p>Each property or constructor argument is either an actual
              definition of the value to set, or a reference to another object
              in the container.</p>
            </li><li>
              <p>Each property or constructor argument which is a value
              must be able to be converted from whatever format it was
              specified in, to the actual <code class="literal">System.Type</code> of
              that property or constructor argument. By default Spring.NET can
              convert a value supplied in string format to all built-in types,
              such as <code class="literal">int</code>, <code class="literal">long</code>,
              <code class="literal">string</code>, <code class="literal">bool</code>, etc.</p>
            </li></ol></div>

        <p>The Spring container validates the configuration of each object
        as the container is created, including the validation of whether
        object reference properties refer to valid object. However, the object
        properties themselves are not set until the object is actually
        created. Objects that are defined as singletons and set to be
        pre-instantiated, are created when the container is created.
        Otherwise, the object is created only when it is requested. Creation
        of an object potentially causes a graph of objects to be created as
        the objects dependencies and its dependencies' dependencies (and so
        on) are created and assigned.</p>

        <div class="sidebar"><div class="title">Circular Dependencies</div>
          

          <p>If you are using predominantly constructor injection it is
          possible to create unresolvable circular dependency scenario.</p>

          <p>For example: Class A, which requires an instance of class B to
          be provided via constructor injection, and class B, which requires
          an instance of class A to be provided via constructor injection. If
          you configure objects for classes A and B to be injected into each
          other, the Spring IoC container detects this circular reference at
          runtime, and throw a
          <code class="literal">ObjectCurrentlyInCreationException</code>.</p>

          <p>One possible solution to this issue is to edit the source code
          of some of your classes to be configured via setters instead of via
          constructors. Alternatively, avoid constructor injection and stick
          to setter injection only. In other words, although it is not
          recommended, you can configure circular dependencies with setter
          injection.</p>

          <p>Unlike the typical case (with no circular dependencies), a
          circular dependency between object A and object B will force one of
          the objects to be injected into the other prior to being fully
          initialized itself (a classic chicken/egg scenario).</p>
        </div>

        <p>You can generally trust Spring.NET to do the right thing. It
        detects configuration problems, such as references to non-existent
        object definitions and circular dependencies, at container load-time.
        Spring sets properties and resolves dependencies as late as possible,
        which is when the object is actually created. This means that a Spring
        container which has loaded correctly can later generate an exception
        when you request an object if there is a problem creating that object
        or one of its dependencies. For example, the object throws an
        exception as a result of a missing or invalid property. This
        potentially delayed visibility of some configuration issues is why
        <code class="literal">IApplicationContext</code> by default pre-instantiate
        singleton objects. At the cost of some upfront time and memory to
        create these objects before they are actually needed, you discover
        configuration issues when the <code class="literal">IApplicationContext</code>
        is created, not later. If you wish, you can still override this
        default behavior and set any of these singleton objects will
        lazy-initialize, rather than be pre-instantiated.</p>

        <p>If no circular dependencies exist, when one or more
        collaborating objects are being injected into a dependent object, each
        collaborating object is <span class="emphasis"><em>totally</em></span> configured prior
        to being passed into the dependent object. This means that if object A
        has a dependency on object B, the Spring IoC container completely
        configures object B prior to invoking the setter method on object A.
        In other words, the object is instantiated (if not a pre-instantiated
        singleton), its dependencies are set, and the relevant lifecycle
        methods (such as a configured init method or the
        <code class="literal">IIntializingObject</code> callback method) will all be
        invoked.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-di-examples"></a>5.3.1.3.&nbsp;Examples of dependency injection</h4></div></div></div>
        

        <p>First, an example of using XML-based configuration metadata for
        setter-based DI. A small part of a Spring XML configuration file
        specifying some object definitions:</p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject, ExamplesLibrary"</span><span style="color: #A31515">&gt;</span>

    <i style="color: #008000">&lt;!-- setter injection using the ref attribute --&gt;</i>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objectOne"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"anotherExampleObject"</span><span style="color: #A31515">/&gt;</span>    
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objectTwo"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"yetAnotherObject"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"IntegerProperty"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"1"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"anotherExampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.AnotherObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"yetAnotherObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.YetAnotherObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span></pre><p>
        </p><pre class="programlisting">[C#]
<span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> ExampleObject
{
  <span style="color: #0000FF">private</span> AnotherObject objectOne;
  <span style="color: #0000FF">private</span> YetAnotherObject objectTwo;
  <span style="color: #0000FF">private</span> <span style="color: #0000FF">int</span> i;
  
  <span style="color: #0000FF">public</span> AnotherObject ObjectOne
  {
    <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.objectOne = <span style="color: #0000FF">value</span>; }
  }
  
  <span style="color: #0000FF">public</span> YetAnotherObject ObjectTwo
  {
    <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.objectTwo = <span style="color: #0000FF">value</span>; }
  }
  
  <span style="color: #0000FF">public</span> <span style="color: #0000FF">int</span> IntegerProperty
  {
    <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.i = <span style="color: #0000FF">value</span>; }
  }  
}</pre>

        <p>In the preceding example, setters have been declared to match
        against the properties specified in the XML file. Find below an
        example of using constructor-based DI.</p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject, ExamplesLibrary"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objectOne"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"anotherExampleObject"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objectTwo"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"yetAnotherObject"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"IntegerProperty"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"1"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"anotherExampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.AnotherObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"yetAnotherObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.YetAnotherObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span></pre><p>
        </p><pre class="programlisting">[Visual Basic.NET]
Public Class ExampleObject

    Private myObjectOne As AnotherObject
    Private myObjectTwo As YetAnotherObject
    Private i As Integer
    
    Public Sub New (
        anotherObject <span style="color: #0000FF">as</span> AnotherObject,
        yetAnotherObject <span style="color: #0000FF">as</span> YetAnotherObject,
        i <span style="color: #0000FF">as</span> Integer)
        
        myObjectOne = anotherObject
        myObjectTwo = yetAnotherObject
        Me.i = i
    End Sub
End Class</pre><p>Ghe constructor arguments specified in the object
        definition will be used to pass in as arguments to the constructor of
        the <code class="literal">ExampleObject</code>.</p>

        <p>Now consider a variant of this where instead of using a
        constructor, Spring is told to call a static factory method to return
        an instance of the object </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleFactoryMethodObject, ExamplesLibrary"</span>
     <span style="color: #FF0000">factory-method</span>=<span style="color: #0000FF">"CreateInstance"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objectOne"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"anotherExampleObject"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objectTwo"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"yetAnotherObject"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"intProp"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"1"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"anotherExampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.AnotherObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"yetAnotherObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.YetAnotherObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span></pre><p>
        </p><pre class="programlisting">[C#]
<span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> ExampleFactoryMethodObject
{
  <span style="color: #0000FF">private</span> AnotherObject objectOne;
  <span style="color: #0000FF">private</span> YetAnotherObject objectTwo;
  <span style="color: #0000FF">private</span> <span style="color: #0000FF">int</span> i;
  
  <i style="color: #008000">// a private constructor</i>
  <span style="color: #0000FF">private</span> ExampleFactoryMethodObject()
  {
  }

  <span style="color: #0000FF">public</span> <span style="color: #0000FF">static</span> ExampleFactoryMethodObject CreateInstance(AnotherObject objectOne,
                               YetAnotherObject objectTwo,
                               <span style="color: #0000FF">int</span> intProp)
  {
    ExampleFactoryMethodObject fmo = <span style="color: #0000FF">new</span> ExampleFactoryMethodObject();
    fmo.AnotherObject = objectOne;
    fmo.YetAnotherObject = objectTwo;
    fmo.IntegerProperty = intProp;
    <span style="color: #0000FF">return</span> fmo;
  }

  <i style="color: #008000">// Property definitions</i>

}</pre><p>Arguments to the static factory method are supplied via
        <code class="literal">&lt;constructor-arg/&gt;</code> elements, exactly the same
        as if a constructor had actually been used. The type of the class
        being returned by the factory method does not have to be of the same
        type as the class which contains the static factory method, although
        in this example it is. An instance (non-static) factory method would
        be used in an essentially identical fashion (aside from the use of the
        <code class="literal">factory-object</code> attribute instead of the
        <code class="literal">type</code> attribute), so will not be detailed
        here.</p>

        <p>Note that Setter Injection and Constructor Injectionare not
        mutually exclusive. It is perfectly reasonable to use both for a
        single object definition, as can be seen in the following example:
        </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.MixedIocObject, ExamplesLibrary"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objectOne"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"anotherExampleObject"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objectTwo"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"yetAnotherObject"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"IntegerProperty"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"1"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"anotherExampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.AnotherObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"yetAnotherObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.YetAnotherObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span></pre><p>
        </p><pre class="programlisting">[C#]
<span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> MixedIocObject
{
  <span style="color: #0000FF">private</span> AnotherObject objectOne;
  <span style="color: #0000FF">private</span> YetAnotherObject objectTwo;
  <span style="color: #0000FF">private</span> <span style="color: #0000FF">int</span> i;
  
  <span style="color: #0000FF">public</span> MixedIocObject (AnotherObject obj)
  {
    <span style="color: #0000FF">this</span>.objectOne = obj;
  }
  
  <span style="color: #0000FF">public</span> YetAnotherObject ObjectTwo
  {
    <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.objectTwo = <span style="color: #0000FF">value</span>; }
  }
  
  <span style="color: #0000FF">public</span> <span style="color: #0000FF">int</span> IntegerProperty
  {
    <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.i = <span style="color: #0000FF">value</span>; }
  }  
}</pre>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="object-factory-properties-detailed"></a>5.3.2.&nbsp;Dependencies and configuration in detail</h3></div></div></div>
      

      <p>As mentioned in the previous section, you can define object
      properties and constructor arguments as either references to other
      managed objects (collaborators), or as values defined inline. Spring's
      XML-based configuration metadata supports sub-element types within its
      <code class="literal">&lt;property/&gt;</code> and
      &lt;<code class="literal">constructor-arg/&gt;</code> elements for this
      purpose.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-simple-values"></a>5.3.2.1.&nbsp;Straight values (primitives, <code class="literal">strings</code>, and so
        on)</h4></div></div></div>
        

        <p>The <code class="literal">value</code> attribute of the
        <code class="literal">&lt;property/&gt;</code> element specifies a property or
        constructor argument as a human-readable string representation. As
        mentioned previously, <code class="literal">TypeConverter</code> instances are
        used to convert these string values from a
        <code class="literal">System.String</code> to the actual property or argument
        type.</p>

        <p>In the following example, we use a
        <code class="literal">SqlConnection</code> from the
        <code class="literal">System.Data.SqlClient</code> namespace. This class (like
        many other existing classes) can easily configured by Spring as it
        offers a convenient public property for configuration of its
        <code class="literal">ConnectionString</code> property.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myConnection"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"System.Data.SqlClient.SqlConnection"</span><span style="color: #A31515">&gt;</span>
      <i style="color: #008000">&lt;!-- results in a call to the setter of the ConnectionString property --&gt;</i>
      <span style="color: #A31515">&lt;property</span>
          <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ConnectionString"</span>
          <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Integrated Security=SSPI;database=northwind;server=mySQLServer"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/object&gt;</span>
<span style="color: #A31515">&lt;/objects&gt;</span></pre>

        <div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d4e839"></a>5.3.2.1.1.&nbsp;The idref element</h5></div></div></div>
          

          <p>An idref element is simply an error-proof way to pass the
          <span class="emphasis"><em>id</em></span> (string value - not a reference) of another
          object in the container to a
          <code class="literal">&lt;constructor-arg/&gt;</code> or
          <code class="literal">&lt;property/&gt;</code> element.</p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"theTargetObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">&gt;</span> 
   . . .
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"theClientObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"targetName"</span><span style="color: #A31515">&gt;</span> 
    <span style="color: #A31515">&lt;idref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"theTargetObject"</span><span style="color: #A31515">/&gt;</span> 
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre><p>This above object definition snipped is
          <span class="emphasis"><em>exactly</em></span> equivalent (at runtime) to the
          following snippit:</p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"theTargetObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">&gt;</span> 
  . . .
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"theClientObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"targetName"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"theTargetObject"</span><span style="color: #A31515">/&gt;</span> 
<span style="color: #A31515">&lt;/object&gt;</span></pre><p>The first form is preferable to the second is
          that using the <code class="literal">idref</code> tag allows the container to
          validate <span class="emphasis"><em>at deployment time</em></span> that the
          referenced, named object actually exists. In the second variation,
          no validation is performed on the value that is passed to the
          <code class="literal">targetName</code> property of the client object. Typos
          are only discovered (with ost mikely fatal results) when the
          'client' object is actually instantiated. If the 'client' object is
          a prototype object, this typo and the resulting exception may only
          be discovered long after the container is deployed.</p>

          <p>Additionally, if the reference object is in the same XML unit,
          and the object name is the object <span class="emphasis"><em>id</em></span>, you can
          use the <code class="literal">local</code> attribute which allows the XML
          parser itself to validate the object name earlier, at XML document
          parse time. </p><pre class="programlisting"><span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"targetName"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;idref</span> <span style="color: #FF0000">local</span>=<span style="color: #0000FF">"theTargetObject"</span><span style="color: #A31515">/&gt;</span> 
<span style="color: #A31515">&lt;/property&gt;</span></pre>
        </div>

        <div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d4e855"></a>5.3.2.1.2.&nbsp;Whitespace Handling</h5></div></div></div>
          

          <p>Usually all leading and trailing whitespaces are trimmed from
          a &lt;value /&gt; element's text. In some cases it is necessary to
          maintain whitespaces exactly as they are written into the xml
          element. The parser does understand the xml:space attribute in this
          case:</p>

          <pre class="programlisting"><span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myProp"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;value</span> <span style="color: #FF0000">xml:space</span>=<span style="color: #0000FF">"preserve"</span><span style="color: #A31515">&gt;</span> &amp;#x000a;&amp;#x000d;&amp;#x0009;<span style="color: #A31515">&lt;/value&gt;</span>
<span style="color: #A31515">&lt;/property&gt;</span></pre>

          <p>The above configuration will result in the string " \n\r\t".
          Note, that you don't have to explicitely specifiy the 'xml'
          namespace on top of your configuration.</p>
        </div>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-ref-element"></a>5.3.2.2.&nbsp;References to other objects (collaborators)</h4></div></div></div>
        

        <p>The <code class="literal">ref</code> element is the final element allowed
        inside a <code class="literal">&lt;constructor-arg/&gt; or
        &lt;property/&gt;</code> definition element. Here you set the value
        of the specified property to be a reference to another object (a
        collaborator) managed by the container. The referenced object is a
        dependency of the object whose property will be set, and it is
        initialzed on demand as needed before the property is set. (If the
        collaborator is a singleton object it may be initialized already by
        the container.) All references are ultimately just a reference to
        another object. Scoping and validation depend on whether you specify
        the id/name of the object through the <code class="literal">object</code>,
        <code class="literal">local</code>, or <code class="literal">parent</code>
        attributes.</p>

        <p>Specifying the target object through the
        <code class="literal">object</code> attribute of the <code class="literal">ref</code> tag
        is the most general form, and allows creation of a reference to any
        object in the same container or parent container, regardless of
        whether it is in the same XML file. The value of the
        <code class="literal">object</code> attribute may be the same as the
        <code class="literal">id</code> attribute of the target object, or as one of the
        values in the <code class="literal">name</code> attribute of the target
        object.</p><pre class="programlisting"><span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"someObject"</span><span style="color: #A31515">/&gt;</span></pre>

        <p>Specifying the target object by using the
        <code class="literal">local</code> attribute leverages the ability of the XML
        parser to validate XML id references within the same file. The value
        of the <code class="literal">local</code> attribute must be the same as the
        <code class="literal">id</code> attribute of the target object. The XML parser
        will issue an error if no matching element is found in the same file.
        As such, using the local variant is the best choice (in order to know
        about errors are early as possible) if the target object is in the
        same XML file.</p><pre class="programlisting"><span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">local</span>=<span style="color: #0000FF">"someObject"</span><span style="color: #A31515">/&gt;</span></pre>

        <p>Specifying the target object through the
        <code class="literal">parent</code> attribute creates a reference to an object
        that is in a parent container of the current container. The value of
        the '<code class="literal">parent'</code> attribute may be the same as either
        the '<code class="literal">id'</code> attribute of the target object, or one of
        the values in the '<code class="literal">name'</code> attribute of the target
        object, and the target object must be in a parent container to the
        current one. You us ethis object reference variant mainly when you
        have a hierarchy of containers and you want to wrap an existing object
        in a parent container with some sort of proxy which will have the same
        name as the parent object.</p><pre class="programlisting"><i style="color: #008000">&lt;!-- in the parent context --&gt;</i>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"AccountService"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyApp.SimpleAccountService, MyApp"</span><span style="color: #A31515">&gt;</span>
  <i style="color: #008000">&lt;!-- insert dependencies as required as here --&gt;</i>
<span style="color: #A31515">&lt;/object&gt;</span></pre><pre class="programlisting">&lt;!-- in the child (descendant) context --&gt;
&lt;object id="AccountService" &lt;-- notice that the name of this object is the same as the name of the 'parent' object
        type="Spring.Aop.Framework.ProxyFactoryObject, Spring.Aop"&gt;
  &lt;property name="target"&gt;
    &lt;ref parent="AccountService"/&gt; &lt;-- notice how we refer to the parent object --&gt;
  &lt;/property&gt;
  &lt;!-- insert other configuration and dependencies as required as here --&gt;
&lt;/object&gt;</pre>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-inline-object"></a>5.3.2.3.&nbsp;Inner objects</h4></div></div></div>
        

        <p>An <code class="literal">&lt;object/&gt;</code> element inside the
        &lt;<code class="literal">constructor-arg/&gt; or &lt;property/&gt;</code>
        element defines so called inner object.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"outer"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"..."</span><span style="color: #A31515">&gt;</span>

  <i style="color: #008000">&lt;!-- Instead of using a reference to target, just use an inner object --&gt;</i> 

  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"target"</span><span style="color: #A31515">&gt;</span> 
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"ExampleApp.Person, ExampleApp"</span><span style="color: #A31515">&gt;</span> 
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"name"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Tony"</span><span style="color: #A31515">/&gt;</span> 
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"age"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"51"</span><span style="color: #A31515">/&gt;</span> 
    <span style="color: #A31515">&lt;/object&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>An inner object definition does not require a defined id or
        name; the container ignores these values. It also ignores the
        <code class="literal">scope</code> flag. Inner object are
        <span class="emphasis"><em>always</em></span> anonymous and they are
        <span class="emphasis"><em>always</em></span> scoped as prototypes. It is not possible
        to inject inner objects into collaborating objects other than into the
        enclosing object.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-collections-values"></a>5.3.2.4.&nbsp;Setting collection values</h4></div></div></div>
        

        <p>The <code class="literal">list</code>, <code class="literal">set</code>,
        <code class="literal">name-values</code> and <code class="literal">dictionary</code>
        elements allow properties and arguments of the type
        <code class="literal">IList</code>, <code class="literal">ISet</code>,
        <code class="literal">NameValueCollection</code> and
        <code class="literal">IDictionary</code>, respectively, to be defined and set.
        </p><pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"moreComplexObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Example.ComplexObject"</span><span style="color: #A31515">&gt;</span>
      <i style="color: #008000">&lt;!--
      results in a call to the setter of the SomeList (System.Collections.IList) property
      --&gt;</i>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"SomeList"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;list&gt;</span>
              <span style="color: #A31515">&lt;value&gt;</span>a list element followed by a reference<span style="color: #A31515">&lt;/value&gt;</span>
              <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"myConnection"</span><span style="color: #A31515">/&gt;</span>
          <span style="color: #A31515">&lt;/list&gt;</span>
      <span style="color: #A31515">&lt;/property&gt;</span>
      <i style="color: #008000">&lt;!--
      results in a call to the setter of the SomeDictionary (System.Collections.IDictionary) property
      --&gt;</i>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"SomeDictionary"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;dictionary&gt;</span>
              <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"a string =&gt; string entry"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"just some string"</span><span style="color: #A31515">/&gt;</span>
              <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key-ref</span>=<span style="color: #0000FF">"myKeyObject"</span> <span style="color: #FF0000">value-ref</span>=<span style="color: #0000FF">"myConnection"</span><span style="color: #A31515">/&gt;</span>
          <span style="color: #A31515">&lt;/dictionary&gt;</span>
      <span style="color: #A31515">&lt;/property&gt;</span>
      <i style="color: #008000">&lt;!--
      results in a call to the setter of the SomeNameValue (System.Collections.NameValueCollection) property
      --&gt;</i>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"SomeNameValue"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;name-values&gt;</span>
              <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"HarryPotter"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"The magic property"</span><span style="color: #A31515">/&gt;</span>
              <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"JerrySeinfeld"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"The funny (to Americans) property"</span><span style="color: #A31515">/&gt;</span>
          <span style="color: #A31515">&lt;/name-values&gt;</span>
      <span style="color: #A31515">&lt;/property&gt;</span>
      <i style="color: #008000">&lt;!-- 
      results in a call to the setter of the SomeSet (Spring.Collections.ISet) property 
      --&gt;</i>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"someSet"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;set&gt;</span>
              <span style="color: #A31515">&lt;value&gt;</span>just some string<span style="color: #A31515">&lt;/value&gt;</span>
              <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"myConnection"</span><span style="color: #A31515">/&gt;</span>
          <span style="color: #A31515">&lt;/set&gt;</span>
      <span style="color: #A31515">&lt;/property&gt;</span>
  <span style="color: #A31515">&lt;/object&gt;</span>
<span style="color: #A31515">&lt;/objects&gt;</span></pre>

        <p>Many classes in the BCL expose only read-only properties for
        collection classes. When Spring.NET encounters a read-only collection,
        it will configure the collection by using the getter property to
        obtain a reference to the collection class and then proceed to add the
        additional elements to the existing collection. This results in an
        additive behavior for collection properties that are exposed in this
        manner.</p>

        <p><span class="emphasis"><em>The value of a Dictionary entry, or a set value, can
        also again be any of the following elements:</em></span>
        </p><pre class="programlisting">(object | ref | idref | expression | list | set | dictionary |
      name-values | value | null)</pre>

        <p>The shortcut forms for value and references are useful to reduce
        XML verbosity when setting collection properties. See <a class="xref" href="objects.html#objects-shortcutforms" title="5.3.2.9.&nbsp;Value and ref shortcut forms">Section&nbsp;5.3.2.9, &#8220;Value and ref shortcut forms&#8221;</a> for more information.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-generic-collections-values"></a>5.3.2.5.&nbsp;Setting generic collection values</h4></div></div></div>
        

        <p>Spring supports setting values for classes that expose
        properties based on the generic collection interfaces
        <code class="literal">IList&lt;T&gt;</code> and <code class="literal">IDictionary&lt;TKey,
        TValue&gt;</code>. The type parameter for these collections is
        specified by using the XML attribute <code class="literal">element-type</code>
        for <code class="literal">IList&lt;T&gt;</code> and the XML attributes
        <code class="literal">key-type</code> and <code class="literal">value-type</code> for
        <code class="literal">IDictionary&lt;TKey, TValue&gt;</code>. The values of the
        collection are automaticaly converted from a string to the appropriate
        type. If you are using your own user-defined type as a generic type
        parameter you will likely need to register a custom type converter.
        Refer to <a class="xref" href="objects.html#objects-type-conversion" title="5.5.&nbsp;Type conversion">Section&nbsp;5.5, &#8220;Type conversion&#8221;</a> for more
        information. The implementations of <code class="literal">IList&lt;T&gt;</code>
        and <code class="literal">IDictionary&lt;TKey, TValue&gt;</code> that is created
        are <code class="literal">System.Collections.Generic.List</code> and
        <code class="literal">System.Collections.Generic.Dictionary</code>.</p>

        <p>The following class represents a lottery ticket and demonstrates
        how to set the values of a generic IList. </p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> LotteryTicket { 

  List&lt;<span style="color: #0000FF">int</span>&gt; list;

  DateTime date; 

  <span style="color: #0000FF">public</span> List&lt;<span style="color: #0000FF">int</span>&gt; Numbers { 
    <span style="color: #0000FF">set</span> { list = <span style="color: #0000FF">value</span>; }
    <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> list; } 
  }

  <span style="color: #0000FF">public</span> DateTime Date { 
    <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> date; } 
    <span style="color: #0000FF">set</span> { date = <span style="color: #0000FF">value</span>; } 
  } 
}</pre><p> The XML fragment that can be used to configure this class
        is shown below </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"MyLotteryTicket"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"GenericsPlay.Lottery.LotteryTicket, GenericsPlay"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Numbers"</span><span style="color: #A31515">&gt;</span> 
    <span style="color: #A31515">&lt;list</span> <span style="color: #FF0000">element-type</span>=<span style="color: #0000FF">"int"</span><span style="color: #A31515">&gt;</span> 
      <span style="color: #A31515">&lt;value&gt;</span>11<span style="color: #A31515">&lt;/value&gt;</span>
      <span style="color: #A31515">&lt;value&gt;</span>21<span style="color: #A31515">&lt;/value&gt;</span> 
      <span style="color: #A31515">&lt;value&gt;</span>23<span style="color: #A31515">&lt;/value&gt;</span>
      <span style="color: #A31515">&lt;value&gt;</span>34<span style="color: #A31515">&lt;/value&gt;</span> 
      <span style="color: #A31515">&lt;value&gt;</span>36<span style="color: #A31515">&lt;/value&gt;</span>
      <span style="color: #A31515">&lt;value&gt;</span>38<span style="color: #A31515">&lt;/value&gt;</span> 
    <span style="color: #A31515">&lt;/list&gt;</span> 
  <span style="color: #A31515">&lt;/property&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Date"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"4/16/2006"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>The following shows the definition of a more complex class that
        demonstrates the use of generics using the
        <code class="literal">Spring.Expressions.IExpression</code> interface as the
        generic type parameter for the IList element-type and the value-type
        for IDictionary. <code class="literal">Spring.Expressions.IExpression</code> has
        an associated type converter,
        <code class="literal">Spring.Objects.TypeConverters.ExpressionConverter</code>
        that is already pre-registered with Spring. </p><pre class="programlisting">    <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> GenericExpressionHolder
    {
        <span style="color: #0000FF">private</span> System.Collections.Generic.IList&lt;IExpression&gt; expressionsList;

        <span style="color: #0000FF">private</span> System.Collections.Generic.IDictionary&lt;<span style="color: #0000FF">string</span>,IExpression&gt; expressionsDictionary;

        <span style="color: #0000FF">public</span> System.Collections.Generic.IList&lt;IExpression&gt; ExpressionsList
        {
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.expressionsList = <span style="color: #0000FF">value</span>; }
        }

        <span style="color: #0000FF">public</span> System.Collections.Generic.IDictionary&lt;<span style="color: #0000FF">string</span>, IExpression&gt; ExpressionsDictionary
        {
            <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.expressionsDictionary = <span style="color: #0000FF">value</span>; }
        }

        <span style="color: #0000FF">public</span> IExpression <span style="color: #0000FF">this</span>[<span style="color: #0000FF">int</span> index]
        {
            <span style="color: #0000FF">get</span>
            {
                <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.expressionsList[index];
            }
        }

        <span style="color: #0000FF">public</span> IExpression <span style="color: #0000FF">this</span>[<span style="color: #0000FF">string</span> key]
        {
            <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.expressionsDictionary[key]; }
        }
    }</pre><p> An example XML configuration of this class is shown
        below </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"genericExpressionHolder"</span>
    <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Xml.GenericExpressionHolder,
    Spring.Core.Tests"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ExpressionsList"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;list</span> <span style="color: #FF0000">element-type</span>=<span style="color: #0000FF">"Spring.Expressions.IExpression, Spring.Core"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;value&gt;</span>1 + 1<span style="color: #A31515">&lt;/value&gt;</span>
            <span style="color: #A31515">&lt;value&gt;</span>date('1856-7-9').Month<span style="color: #A31515">&lt;/value&gt;</span>
            <span style="color: #A31515">&lt;value&gt;</span>'Nikola Tesla'.ToUpper()<span style="color: #A31515">&lt;/value&gt;</span>
            <span style="color: #A31515">&lt;value&gt;</span>DateTime.Today &gt; date('1856-7-9')<span style="color: #A31515">&lt;/value&gt;</span>
        <span style="color: #A31515">&lt;/list&gt;</span>
    <span style="color: #A31515">&lt;/property&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ExpressionsDictionary"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;dictionary</span> <span style="color: #FF0000">key-type</span>=<span style="color: #0000FF">"string"</span> <span style="color: #FF0000">value-type</span>=<span style="color: #0000FF">"Spring.Expressions.IExpression, Spring.Core"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"zero"</span><span style="color: #A31515">&gt;</span>
                <span style="color: #A31515">&lt;value&gt;</span>1 + 1<span style="color: #A31515">&lt;/value&gt;</span>
            <span style="color: #A31515">&lt;/entry&gt;</span>
            <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"one"</span><span style="color: #A31515">&gt;</span>
                <span style="color: #A31515">&lt;value&gt;</span>date('1856-7-9').Month<span style="color: #A31515">&lt;/value&gt;</span>
            <span style="color: #A31515">&lt;/entry&gt;</span>
            <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"two"</span><span style="color: #A31515">&gt;</span>
                <span style="color: #A31515">&lt;value&gt;</span>'Nikola Tesla'.ToUpper()<span style="color: #A31515">&lt;/value&gt;</span>
            <span style="color: #A31515">&lt;/entry&gt;</span>
            <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"three"</span><span style="color: #A31515">&gt;</span>
                <span style="color: #A31515">&lt;value&gt;</span>DateTime.Today &gt; date('1856-7-9')<span style="color: #A31515">&lt;/value&gt;</span>
            <span style="color: #A31515">&lt;/entry&gt;</span>
        <span style="color: #A31515">&lt;/dictionary&gt;</span>
    <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e940"></a>5.3.2.6.&nbsp;Collection Merging</h4></div></div></div>
        

        <p>As of Spring 1.3, the container supports the merging of
        collections. An application developer can define a parent-style
        <code class="literal">&lt;list/&gt;</code>,
        <code class="literal">&lt;dictionary/&gt;</code>,
        <code class="literal">&lt;set/&gt;</code> or
        <code class="literal">&lt;name-value/&gt;</code> element, and have child-style
        <code class="literal">&lt;list/&gt;</code>,
        <code class="literal">&lt;dictionary/&gt;</code>,
        <code class="literal">&lt;set/&gt;</code> or
        <code class="literal">&lt;name-value/&gt;</code> elements inherit and override
        values from the parent collection. That is, the child collection's
        values are the result of merging the elements of the parent and child
        collections, with the child's collection elements overriding values
        specified in the parent collection.</p>

        <p><span class="emphasis"><em>This section on merging discusses the parent-child
        object mechanism. Readers unfamiliar with parent and child object
        definitions may wish to read the <a class="link" href="objects.html#objects-childobjects" title="5.7.&nbsp;Object definition inheritance">relevant section</a> before
        continuing.</em></span></p>

        <p>The following example demonstrates collection merging:</p>

        <pre class="programlisting">  &lt;object id="parent" abstract="true" type="Example.ComplexObject, Examples"&gt;
    &lt;property name="AdminEmails"&gt;
      &lt;name-values&gt;
        &lt;add key="administrator" value="administrator@example.com"/&gt;
        &lt;add key="support" value="support@example.com"/&gt;
      &lt;/name-values&gt;
    &lt;/property&gt;
  &lt;/object&gt;

  &lt;object id="child" parent="parent" &gt;
    &lt;property name="AdminEmails"&gt;
      &lt;!-- the merge is specified on the *child* collection definition --&gt;
      &lt;name-values merge="true"&gt;
        &lt;add key="sales" value="sales@example.com"/&gt;
        &lt;add key="support" value="support@example.co.uk"/&gt;                
      &lt;/name-values&gt;
    &lt;/property&gt;
  &lt;/object&gt;</pre>

        <p>Notice the use of the <code class="literal">merge=true</code> attribute on
        the <code class="literal">&lt;name-values/&gt;</code> element of the
        <code class="literal">AdminEmails</code> property of the child object
        definition. When the child object is resolved and instantiated by the
        container, the resulting instance has an
        <code class="literal">AdminEmails</code> Properties collection that contains the
        result of the merging of the child's <code class="literal">AdminEmails</code>
        collection with the parent's <code class="literal">AdminEmails</code>
        collection.</p>

        <pre class="programlisting">administrator=administrator@example.com
sales=sales@example.com
support=support@example.co.uk</pre>

        <p>The child Properties collection's value set inherits all
        property elements from the parent
        <code class="literal">&lt;name-values/&gt;</code>, and the child's value for the
        support value overrides the value in the parent collection. This
        merging behavior applies similarly to the
        <code class="literal">&lt;list/&gt;</code>,
        <code class="literal">&lt;dictionary/&gt;</code>, and
        <code class="literal">&lt;set/&gt;</code> collection types. In the specific case
        of the <code class="literal">&lt;list/&gt;</code> element, the semantics
        associated with the <code class="literal">IList</code> collection type, that is,
        the notion of an ordered collection of values, is maintained; the
        parent's values precede all of the child list's values. In the case of
        the <code class="literal">IDictionary</code>, <code class="literal">ISet</code>, and
        <code class="literal">NameValue</code> collection types, no ordering exists.
        Hence no ordering semantics are in effect for the collection types
        that underlie the associated <code class="literal">IDictionary</code>,
        <code class="literal">ISet</code>, and <code class="literal">NameValueCollection</code>
        implementation types that the container uses internally.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-null-values"></a>5.3.2.7.&nbsp;Null and empty values</h4></div></div></div>
        

        <p>Spring treats empty arguments for properties and the like as
        empty Strings. The following XML-based configuration metadata snippet
        sets the email property to the empty String value ("")</p>

        <pre class="programlisting">&lt;object type="Examples.ExampleObject, ExamplesLibrary"&gt; 
  &lt;property name="email" value=""/&gt; 
&lt;/object&gt;</pre>

        <p>This results in the email property being set to the empty string
        value (<code class="literal">""</code>), in much the same way as can be seen in
        the following snippet of C# code</p>

        <pre class="programlisting">exampleObject.Email = <span style="color: #000000">""</span>;</pre>

        <p>The <code class="literal">&lt;null&gt;</code> element is used to handle
        <code class="literal">null</code> values. For example:</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject, ExamplesLibrary"</span><span style="color: #A31515">&gt;</span> 
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"email"</span><span style="color: #A31515">&gt;</span><span style="color: #A31515">&lt;null/&gt;</span><span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>This results in the email property being set to
        <code class="literal">null</code>, again in much the same way as can be seen in
        the following snippet of C# code:</p><pre class="programlisting">exampleObject.Email = <span style="color: #0000FF">null</span>;</pre>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e991"></a>5.3.2.8.&nbsp;Setting indexer properties</h4></div></div></div>
        

        <p>An indexer lets you set and get values from a collection using a
        familiar bracket <code class="literal">[]</code> notation. Spring's XML
        configuration supports the setting of indexer properties. Overloaded
        indexers as well as multiparameter indexers are also supported. The
        property expression parser described in <a class="xref" href="expressions.html" title="Chapter&nbsp;11.&nbsp;Expression Evaluation">Chapter&nbsp;11, <i>Expression Evaluation</i></a>
        is used to perform the type conversion of the indexer name argument
        from a string in the XML file to a matching target type. As an example
        consider the following class </p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> Person
{
    <span style="color: #0000FF">private</span> IList favoriteNames = <span style="color: #0000FF">new</span> ArrayList();

    <span style="color: #0000FF">private</span> IDictionary properties = <span style="color: #0000FF">new</span> Hashtable();

    <span style="color: #0000FF">public</span> Person()
    {
        favoriteNames.Add(<span style="color: #000000">"p1"</span>);
        favoriteNames.Add(<span style="color: #000000">"p2"</span>);
    }

    <span style="color: #0000FF">public</span> <span style="color: #0000FF">string</span> <span style="color: #0000FF">this</span>[<span style="color: #0000FF">int</span> index]
    {
        <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> (<span style="color: #0000FF">string</span>) favoriteNames[index]; }
        <span style="color: #0000FF">set</span> { favoriteNames[index] = <span style="color: #0000FF">value</span>; }
    }

    <span style="color: #0000FF">public</span> <span style="color: #0000FF">string</span> <span style="color: #0000FF">this</span>[<span style="color: #0000FF">string</span> keyName]
    {
        <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> (<span style="color: #0000FF">string</span>) properties[keyName]; }
        <span style="color: #0000FF">set</span> { properties.Add(keyName, <span style="color: #0000FF">value</span>); }
    }
}</pre><p> The XML configuration snippet to populate this object with
        data is shown below </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"person"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Test.Objects.Person, Test.Objects"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"[0]"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Master Shake"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"['one']"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"uno"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
          <p>The use of the property expression parser in Release 1.0.2
          changed how you configure indexer properties. The following section
          describes this usage.</p>

          <p>The older style configuration uses the following syntax
          </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"objectWithIndexer"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.TestObject, Spring.Core.Tests"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Item[0]"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"my string value"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre><p> You can also change the name used to identify
          the indexer by adorning your indexer method declaration with the
          attribute <code class="literal">[IndexerName("MyItemName")]</code>. You would
          then use the string <code class="literal">MyItemName[0]</code> to configure
          the first element of that indexer.</p>

          <p>There are some limitations to be aware in the older indexer
          configuration. The indexer can only be of a single parameter that is
          convertible from a string to the indexer parameter type. Also,
          multiple indexers are not supported. You can get around that last
          limitation currently if you use the IndexerName attribute.</p>
        </td></tr></table></div>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-shortcutforms"></a>5.3.2.9.&nbsp;Value and ref shortcut forms</h4></div></div></div>
        

        <p>Spring XML used to be even more verbose. What is now popular
        usage is actually the shortcut from of the original way to specify
        values and references.</p>

        <p>There are also some shortcut forms that are less verbose than
        using the full <code class="literal">value</code> and <code class="literal">ref</code>
        elements. The <code class="literal">property</code>,
        <code class="literal">constructor-arg</code>, and <code class="literal">entry</code>
        elements all support a <code class="literal">value</code> attribute which may be
        used instead of embedding a full <code class="literal">value</code> element.
        Therefore, the following: </p><pre class="programlisting"><span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myProperty"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;value&gt;</span>hello<span style="color: #A31515">&lt;/value&gt;</span>
<span style="color: #A31515">&lt;/property&gt;</span>

<span style="color: #A31515">&lt;constructor-arg&gt;</span> 
  <span style="color: #A31515">&lt;value&gt;</span>hello<span style="color: #A31515">&lt;/value&gt;</span>
<span style="color: #A31515">&lt;/constructor-arg&gt;</span> 

<span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"myKey"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;value&gt;</span>hello<span style="color: #A31515">&lt;/value&gt;</span>
<span style="color: #A31515">&lt;/entry&gt;</span></pre><p> are equivalent to:</p><pre class="programlisting"><span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myProperty"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"hello"</span><span style="color: #A31515">/&gt;</span>

<span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"hello"</span><span style="color: #A31515">/&gt;</span> 

<span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"myKey"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"hello"</span><span style="color: #A31515">/&gt;</span></pre><p> In general, when
        typing definitions by hand, you will probably prefer to use the less
        verbose shortcut form.</p>

        <p>The <code class="literal">property</code> and
        <code class="literal">constructor-arg</code> elements support a similar shortcut
        <code class="literal">ref</code> attribute which may be used instead of a full
        nested <code class="literal">ref</code> element. Therefore, the following...
        </p><pre class="programlisting"><span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myProperty"</span><span style="color: #A31515">&gt;</span> 
  <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"anotherObject"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/property&gt;</span>

<span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">index</span>=<span style="color: #0000FF">"0"</span><span style="color: #A31515">&gt;</span> 
  <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"anotherObject"</span><span style="color: #A31515">/&gt;</span> 
<span style="color: #A31515">&lt;/constructor-arg&gt;</span></pre><p> is equivalent to... </p><pre class="programlisting"><span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myProperty"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"anotherObject"</span><span style="color: #A31515">/&gt;</span>

<span style="color: #A31515">&lt;constructor-arg</span> <span style="color: #FF0000">index</span>=<span style="color: #0000FF">"0"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"anotherObject"</span><span style="color: #A31515">/&gt;</span></pre>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
          <p>The shortcut form is equivalent to a <code class="literal">&lt;ref
          object="xxx"&gt;</code> element; there is no shortcut for either
          the <code class="literal">&lt;ref local="xxx"&gt;</code> or <code class="literal">&lt;ref
          parent="xxx"&gt;</code> elements. For a local or parent
          <code class="literal">ref</code>, you must still use the long form.</p>
        </td></tr></table></div>

        <p>Finally, the entry element allows a shortcut form the specify
        the key and/or value of a dictionary, in the form of key/key-ref and
        value/value-ref attributes. Therefore, the following </p><pre class="programlisting"><span style="color: #A31515">&lt;entry&gt;</span> 
  <span style="color: #A31515">&lt;key&gt;</span>
     <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"MyKeyObject"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/key&gt;</span> 
  <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"MyValueObject"</span><span style="color: #A31515">/&gt;</span> 
<span style="color: #A31515">&lt;/entry&gt;</span></pre><p> Is equivalent to: </p><pre class="programlisting"><span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key-ref</span>=<span style="color: #0000FF">"MyKeyObject"</span> <span style="color: #FF0000">value-ref</span>=<span style="color: #0000FF">"MyValueObject"</span><span style="color: #A31515">/&gt;</span></pre><p>
        As mentioned previously, the equivalence is to <code class="literal">&lt;ref
        object="xxx"&gt;</code> and not the local or parent forms of object
        references.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-referencing-compound-properties"></a>5.3.2.10.&nbsp;Compound property names and Spring expression
        references</h4></div></div></div>
        

        <p>You can use compound or nested property names when you set
        object properties. Property names are interpreted using the <a class="link" href="expressions.html" title="Chapter&nbsp;11.&nbsp;Expression Evaluation">Spring Expression Language</a> (SpEL) and
        therefore can leverage its many features to set property names. For
        example, in this object definition a simple nested property name is
        configured</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"foo"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Foo, Spring.Foo"</span><span style="color: #A31515">&gt;</span> 
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"bar.baz.name"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Bingo"</span><span style="color: #A31515">/&gt;</span> 
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>As an example of some alternative ways to declare the property
        name, you can use SpEL's support for indexers to configure a
        Dictionary key value pair as an alternative to the nested
        <code class="literal">&lt;dictionary&gt;</code> element. More importantly, you
        can use the 'expression' element to refer to a Spring expression as
        the value of the property. Simple examples of this are shown
        below</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">&#8220;minValue&#8221;</span> <span style="color: #FF0000">expression</span>=<span style="color: #0000FF">&#8220;int.MinValue&#8221;</span><span style="color: #A31515"> /&gt;</span>

<span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">&#8220;weekFromToday&#8221;</span> <span style="color: #FF0000">expression</span>=<span style="color: #0000FF">"DateTime.Today + 7"</span><span style="color: #A31515">/&gt;</span></pre>

        <p>Using SpEL's support for method evaluation, you can easily call
        static method on various helper classes in your XML
        configuraiton.</p>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1044"></a>5.3.3.&nbsp;Declarative Event Listener Registration</h3></div></div></div>
      

      <p>In C# events are built right into the language thanks to the
      <code class="literal">event</code> keyword. Under the scenes, events are
      essentially a shorthand notation for delegates with some additional
      guidelines as to what the parameters to an event handler method should
      be (i.e. a sender <code class="literal">System.Object</code> and an
      <code class="literal">System.EventArgs</code> object).</p>

      <pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> EventSource
<span style="color: #0000FF">public</span> <span style="color: #0000FF">event</span> EventHandler Click;</pre>

      <p>In use, .NET events are combined with one or more event handler
      methods. Each handler method is programmatically added, or removed, from
      the event and corresponds to an object's method that should be invoked
      when a particular event occurs. When more than one handler method is
      added to an event, then each of the registered methods will be invoked
      in turn when an event occurs.</p>

      <pre class="programlisting">TestObject source = <span style="color: #0000FF">new</span> TestObject();
TestEventHandler eventListener1 = <span style="color: #0000FF">new</span> TestEventHandler();
TestEventHandler eventListener2 = <span style="color: #0000FF">new</span> TestEventHandler();

source.Click += eventListener1.HandleEvent; <i style="color: #008000">// Adding the first event handler method to the event</i>
source.Click += eventListener2.HandleEvent; <i style="color: #008000">// Adding a second event handler method to the event</i>

source.OnClick(); <i style="color: #008000">// First eventListener1.HandleEvent is invoked, then eventListener2.HandleEvent</i></pre>

      <p>When OnClick() is invoked, the event is fired.</p>

      <pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">void</span> OnClick()
{
   <span style="color: #0000FF">if</span> (Click != <span style="color: #0000FF">null</span>)
   {
      Click(<span style="color: #0000FF">this</span>, EventArgs.Empty); <i style="color: #008000">// Fire the event off to the registered handler methods</i>
   }
}</pre>

      <p>One of the not so nice things about using events is that, without
      employing late binding, you declare the objects that are registered with
      a particular event programmatically. Spring .NET offers a way to
      declaratively register your handler methods with particular events using
      the <code class="literal">&lt;listener&gt;</code> element inside your
      <code class="literal">&lt;object&gt;</code> elements.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e1061"></a>5.3.3.1.&nbsp;Declarative event handlers</h4></div></div></div>
        

        <p>Rather than having to specifically declare in your code that you
        are adding a method to be invoked on an event, using the
        <code class="literal">&lt;listener&gt;</code> element you can register a plain
        object's methods with the corresponding event declaratively in your
        application configuration.</p>

        <p>Using the <code class="literal">listener</code> element you can:
        </p><div class="itemizedlist"><ul type="disc"><li>
              <a class="link" href="objects.html#objects-simple-event-configuration" title="5.3.3.2.&nbsp;Configuring a method to be invoked when an event is fired">Configure a
              method to be invoked when an event is fired.</a>
            </li><li>
              <a class="link" href="objects.html#objects-handler-reg-ex-configuration" title="5.3.3.3.&nbsp;Registering a collection of handler methods based on a regular expression">Register a
              collection of handler methods based on a regular
              expression.</a>
            </li><li>
              <a class="link" href="objects.html#objects-event-name-reg-ex-configuration" title="5.3.3.4.&nbsp;Registering a handler method against an event name that contains a regular expression">Register
              a handler method against an event name that contains a regular
              expression.</a>
            </li></ul></div>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-simple-event-configuration"></a>5.3.3.2.&nbsp;Configuring a method to be invoked when an event is
        fired</h4></div></div></div>
        

        <p>The same event registration in the example above can be achieved
        using configuration using the <code class="literal">&lt;listener&gt;</code>
        element.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"eventListener1"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SpringdotNETEventsExample.TestEventHandler, SpringdotNETEventsExample"</span><span style="color: #A31515">&gt;</span>
   <i style="color: #008000">&lt;!-- wired up to an event exposed on an instance --&gt;</i>
   <span style="color: #A31515">&lt;listener</span> <span style="color: #FF0000">event</span>=<span style="color: #0000FF">"Click"</span> <span style="color: #FF0000">method</span>=<span style="color: #0000FF">"HandleEvent"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"source"</span><span style="color: #A31515">/&gt;</span>
   <span style="color: #A31515">&lt;/listener&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"eventListener2"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SpringdotNETEventsExample.TestEventHandler, SpringdotNETEventsExample"</span><span style="color: #A31515">&gt;</span>
   <i style="color: #008000">&lt;!-- wired up to an event exposed on an instance --&gt;</i>
   <span style="color: #A31515">&lt;listener</span> <span style="color: #FF0000">event</span>=<span style="color: #0000FF">"Click"</span> <span style="color: #FF0000">method</span>=<span style="color: #0000FF">"HandleEvent"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"source"</span><span style="color: #A31515">/&gt;</span>
   <span style="color: #A31515">&lt;/listener&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>In this case the two different objects will have their
        <code class="literal">HandleEvent</code> method invoked, as indicated explicitly
        using the <code class="literal">method</code> attribute, when a
        <code class="literal">Click</code> event, as specified by the
        <code class="literal">event</code> attribute, is triggered on the object
        referred to by the <code class="literal">ref</code> element.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-handler-reg-ex-configuration"></a>5.3.3.3.&nbsp;Registering a collection of handler methods based on a regular
        expression</h4></div></div></div>
        

        <p>Regular expressions can be employed to wire up more than one
        handler method to an object that contains one or more events.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"eventListener"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SpringdotNETEventsExample.TestEventHandler, SpringdotNETEventsExample"</span><span style="color: #A31515">&gt;</span>
   <span style="color: #A31515">&lt;listener</span> <span style="color: #FF0000">method</span>=<span style="color: #0000FF">"Handle.+"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"source"</span><span style="color: #A31515">/&gt;</span>
   <span style="color: #A31515">&lt;/listener&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>Here all the <code class="literal">eventListener</code>'s handler methods
        that begin with 'Handle', and that have the corresponding two
        parameters of a <code class="literal">System.Object</code> and a
        <code class="literal">System.EventArgs</code>, will be registered against all
        events exposed by the <code class="literal">source</code> object.</p>

        <p>You can also use the name of the event in regular expression to
        filter your handler methods based on the type of event
        triggered.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"eventListener"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SpringdotNETEventsExample.TestEventHandler, SpringdotNETEventsExample"</span><span style="color: #A31515">&gt;</span>
   <i style="color: #008000">&lt;!-- For the Click event, the HandleClick handler method will be invoked. --&gt;</i>
   <span style="color: #A31515">&lt;listener</span> <span style="color: #FF0000">method</span>=<span style="color: #0000FF">"Handle${event}"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"source"</span><span style="color: #A31515">/&gt;</span>
   <span style="color: #A31515">&lt;/listener&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-event-name-reg-ex-configuration"></a>5.3.3.4.&nbsp;Registering a handler method against an event name that
        contains a regular expression</h4></div></div></div>
        

        <p>Finally, you can register an object's handler methods against a
        selection of events, filtering based on their name using a regular
        expression.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"eventListener"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SpringdotNETEventsExample.TestEventHandler, SpringdotNETEventsExample"</span><span style="color: #A31515">&gt;</span>
   <span style="color: #A31515">&lt;listener</span> <span style="color: #FF0000">method</span>=<span style="color: #0000FF">"HandleEvent"</span> <span style="color: #FF0000">event</span>=<span style="color: #0000FF">"Cl.+"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;ref</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"source"</span><span style="color: #A31515">/&gt;</span>
   <span style="color: #A31515">&lt;/listener&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>In this example the <code class="literal">eventListener</code>'s
        <code class="literal">HandleEvent</code> handler method will be invoked for any
        event that begins with 'Cl'.</p>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-dependson"></a>5.3.4.&nbsp;Using <code class="literal">depends-on</code></h3></div></div></div>
      

      <p>If an object is a dependency of another that usually means that
      one object is set as a property of another. Typically you accomplish
      this with the <code class="literal">&lt;ref/&gt;</code> element in XML-based
      configuration metadata. However, sometimes dependencies between objects
      are less direct; for example, a static initializer in a class needs to
      be triggered, such as device driver registration. The
      <code class="literal">depends-on</code> attribute can explicitly force one or more
      objects to be initialized before the object using this element is
      initialized. The following example uses the
      <code class="literal">depends-on</code> attribute to express a dependency on a
      single object: </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"objectOne"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject, ExamplesLibrary"</span> <span style="color: #FF0000">depends-on</span>=<span style="color: #0000FF">"manager"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"manager"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"manager"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"manager"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ManagerObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span></pre>

      <p>To express a dependency on multiple objects, supply a list of
      object names as the value of the '<code class="literal">depends-on</code>'
      attribute, with commas, whitespace and semicolons used as valid
      delimiters:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"objectOne"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject, ExamplesLibrary"</span> <span style="color: #FF0000">depends-on</span>=<span style="color: #0000FF">"manager,accountDao"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"manager"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"manager"</span><span style="color: #A31515"> /&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"manager"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ManagerObject, ExamplesLibrary"</span><span style="color: #A31515"> /&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"accountDao"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.AdoAccountDao, ExamplesLibrary"</span><span style="color: #A31515"> /&gt;</span></pre>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p>The <code class="literal">depends-on</code> attribute in the object
        definition can specify both an initialization time dependency and, in
        the case of a singleton object only, a corresponding destroy time
        dependency. Dependent objects that define a
        <code class="literal">depends-on</code> relationship with a given object are
        destroyed first, prior to the given object itself being destroyed.
        Thus <code class="literal">depends-on</code> can also control shutdown
        order.</p>
      </td></tr></table></div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1123"></a>5.3.5.&nbsp;Lazily-initialized objects</h3></div></div></div>
      

      <p>By default, <code class="literal">IApplicationContext</code> implementations
      eagerly pre-instantiate all singleton objects as part of the
      initialization process. Generally this pre-instantiation is desirable,
      because errors in configuration or the surrounding environment are
      discovered immediately, as opposed to hours or even days later. When
      this behavior is not desirable, you can prevent pre-instantiation of a
      singleton object by marking the object definition as lazy-initialized. A
      lazy-initialized object tells the IoC container to create an object
      instance when it is first requested, rather than at startup.</p>

      <p>In XML, this behavior is controlled by the
      <code class="literal">'lazy-init'</code>attribute on the
      <code class="literal">&lt;object/&gt;</code> element; for example:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"lazy"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyCompany.ExpensiveToCreateObject, MyApp"</span> <span style="color: #FF0000">lazy-init</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">/&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"not.lazy"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyCompany.AnotherObject, MyApp"</span><span style="color: #A31515">/&gt;</span></pre>

      <p>When the preceding configuration is consumed by an
      <code class="literal">IApplicationContext</code>, the object named
      <code class="literal">lazy</code> is not eagerly pre-instantiated when the
      <code class="literal">IApplicationContext</code> is starting up, whereas the
      <code class="literal">not.lazy</code> object is eagerly pre-instantiated.</p>

      <p>However, when a lazy-initialized object is a dependency of a
      singleton object that is <span class="emphasis"><em>not</em></span>
      <code class="literal">lazy-initialized</code>, the
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span> creates the lazy-initialized
      object at startup, because it must satisfy the singleton's dependencies.
      The lazy-initialized object is injected into a singleton object
      elsewhere that is not lazy-initialized.</p>

      <p>You can also control lazy-initialization at the container level by
      using the <code class="literal">default-lazy-init </code>attribute on the
      <code class="literal">&lt;objects/&gt;</code> element; for example:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">default-lazy-init</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">&gt;</span>
  <i style="color: #008000">&lt;!-- no objects will be pre-instantiated... --&gt;</i>
<span style="color: #A31515">&lt;/objects&gt;</span></pre>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-autowire"></a>5.3.6.&nbsp;Autowiring collaborators</h3></div></div></div>
      

      <p>The Spring container is able to autowire relationships between
      collaborating objects. This means that it is possible to automatically
      let Spring resolve collaborators (other objects) for your object by
      inspecting the contents of the IoC container.. The autowiring
      functionality has five modes. Autowiring is specified per object and can
      thus be enabled for some object, while other objects will not be
      autowired. Using autowiring, it is possible to reduce or eliminate the
      need to specify properties or constructor arguments, thus saving a
      significant amount of typing. When using XML-based configuration
      metadata, the autowire mode for an object definition is specified by
      using the autowire attribute of the &lt;object/&gt; element. The
      following values are allowed:</p>

      <div class="table"><a name="d4e1148"></a><div class="title">Table&nbsp;5.3.&nbsp;Autowiring modes</div><div class="table-contents">
          

          <table summary="Autowiring modes" border="1"><colgroup><col><col></colgroup><thead><tr><th>Mode</th><th>Explanation</th></tr></thead><tbody><tr><td>no</td><td>No autowiring at all. This is the default value and you
                are encouraged not to change this for large applications,
                since specifying your collaborators explicitly gives you a
                feeling for what you're actually doing (always a bonus) and is
                a great way of somewhat documenting the structure of your
                system.</td></tr><tr><td>byName</td><td>This option will inspect the objects within the
                container, and look for an object named exactly the same as
                the property which needs to be autowired. For example, if you
                have an object definition that is set to autowire by name, and
                it contains a <code class="literal">Master</code> property, Spring.NET
                will look for an object definition named
                <code class="literal">Master</code>, and use it as the value of the
                <code class="literal">Master</code> property on your object
                definition.</td></tr><tr><td>byType</td><td>This option gives you the ability to resolve
                collaborators by type instead of by name. Supposing you have
                an <code class="literal">IObjectDefinition</code> with a collaborator
                typed <code class="literal">SqlConnection</code>, Spring.NET will search
                the entire object factory for an object definition of type
                <code class="literal">SqlConnection</code> and use it as the
                collaborator. <span class="emphasis"><em>If 0 (zero) or more than 1 (one)
                object definitions of the desired type exist in the container,
                a failure will be reported and you won't be able to use
                autowiring for that specific object.</em></span></td></tr><tr><td>constructor</td><td>This is analogous to <span class="emphasis"><em>byType</em></span>, but
                applies to constructor arguments. If there isn't exactly one
                object of the constructor argument type in the object factory,
                a fatal error is raised.</td></tr><tr><td>autodetect</td><td>Chooses <span class="emphasis"><em>constructor</em></span> or
                <span class="emphasis"><em>byType</em></span> through introspection of the
                object class. If a default constructor is found,
                <span class="emphasis"><em>byType</em></span> gets applied.</td></tr></tbody></table>
        </div></div><p><br class="table-break"></p>

      <p>Note that explicit dependencies in property and constructor-arg
      settings always override autowiring. Please also note that it is not
      currently possible to autowire so-called simple properties such as
      primitives, Strings, and Types (and arrays of such simple properties).
      (This is by-design and should be considered a feature.) When using
      either the byType or constructor autowiring mode, it is possible to wire
      arrays and typed-collections. In such cases all autowire candidates
      within the container that match the expected type will be provided to
      satisfy the dependency. Strongly-typed IDictionaries can even be
      autowired if the expected key type is string. An autowired IDictionary
      values will consist of all object instances that match the expected
      type, and the IDictionary's keys will contain the corresponding object
      names.</p>

      <p>Autowire behavior can be combined with dependency checking, which
      will be performed after all autowiring has been completed. It is
      important to understand the various advantages and disadvantages of
      autowiring. Some advantages of autowiring include:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Autowiring can significantly reduce the volume of
          configuration required. However, mechanisms such as the use of a
          object template (discussed elsewhere in this chapter) are also
          valuable in this regard.</p>
        </li><li>
          <p>Autowiring can cause configuration to keep itself up to date
          as your objects evolve. For example, if you need to add an
          additional dependency to a class, that dependency can be satisfied
          automatically without the need to modify configuration. Thus there
          may be a strong case for autowiring during development, without
          ruling out the option of switching to explicit wiring when the code
          base becomes more stable.</p>
        </li></ul></div>

      <p>Some disadvantages of autowiring:</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>Autowiring is more magical than explicit wiring. Although, as
          noted in the above table, Spring is careful to avoid guessing in
          case of ambiguity which might have unexpected results, the
          relationships between your Spring-managed objects are no longer
          documented explicitly.</p>
        </li><li>
          <p>Wiring information may not be available to tools that may
          generate documentation from a Spring container.</p>
        </li></ul></div>

      <p>Another issue to consider when autowiring by type is that multiple
      object definitions within the container may match the type specified by
      the setter method or constructor argument to be autowired. For arrays,
      collections, or IDictionary, this is not necessarily a problem. However
      for dependencies that expect a single value, this ambiguity will not be
      arbitrarily resolved. Instead, if no unique object definition is
      available, an Exception will be thrown.</p>

      <p>When deciding whether to use autowiring, there is no wrong or
      right answer in all cases. A degree of consistency across a project is
      best though; for example, if autowiring is not used in general, it might
      be confusing to developers to use it just to wire one or two object
      definitions.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-dependencies"></a>5.3.7.&nbsp;Checking for dependencies</h3></div></div></div>
      

      <p>The Spring IoC container can check for unresolved dependencies of
      an object deployed into the container. When enabling checking for
      unresolved dependencies all properties of the object must have an
      explicit values set for them in the object definition or have their
      values set via autowiring.</p>

      <p>This feature useful when you want to ensure that all properties
      (or all properties of a certain type) are set on an object. An object
      often has default values for many properties, or some properties do not
      apply to all usage scenarios, so this feature is of limited use. You can
      enable dependency checking per object, just as with the autowiring
      functionality. The default is not <span class="emphasis"><em>not</em></span> check
      dependencies. In XML-based configuration metadata, you specify
      dependency checking via the <code class="literal">dependency-check</code>
      attribute in an object definition, which may have the following values.
      </p><div class="table"><a name="d4e1205"></a><div class="title">Table&nbsp;5.4.&nbsp;Dependency checking modes</div><div class="table-contents">
          

          <table summary="Dependency checking modes" border="1"><colgroup><col><col></colgroup><thead><tr><th>Mode</th><th>Explanation</th></tr></thead><tbody><tr><td>none</td><td>(Default) No dependency checking. Properties of the
                object which have no value specified for them are simply not
                set.</td></tr><tr><td>simple</td><td>Dependency checking for primitive types and collections
                (everything except collaborators).</td></tr><tr><td>object</td><td>Dependency checking for collaborators only.</td></tr><tr><td>all</td><td>Dependency checking for collaborators, primitive types
                and collections.</td></tr></tbody></table>
        </div></div><p><br class="table-break"></p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-method-injection"></a>5.3.8.&nbsp;Method injection</h3></div></div></div>
      

      <p>In most application scenarios, most object in the container are
      singletons. When a singleton object needs to collaborate with (use)
      another singleton object, or a non-singleton object needs to collaborate
      with another non-singleton object, you typically handle the dependency
      by defining one object as a property of the other. A problem arrises
      when the object lifecycles are different. Suppose singleton object A
      needs to use a non-singleton (prototype) object B, perhaps on each
      method invocation on A. The container only creates the singleton object
      A once, and thus only get the opportunity to set the properties. The
      container cannot provide object A with a new instance of object B every
      time one is needed.</p>

      <p>A solution is to forego some inversion of control. You can <a class="link" href="">make object A aware
      of the container</a> by implementing the
      <code class="literal">IApplicationContextAware</code> interface, and by <a class="link" href="objects.html#objects-factory-client" title="5.2.3.&nbsp;Using the container">making a GetObject("B") call to the
      container</a> ask for (a typically new) object B every time it needs
      it. Find below an example of this approach</p>

      <pre class="programlisting"><span style="color: #0000FF">using</span> System.Collections;
<span style="color: #0000FF">using</span> Spring.Objects.Factory;

<span style="color: #0000FF">namespace</span> Fiona.Apple
{
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> CommandManager : IObjectFactoryAware
    {
        <span style="color: #0000FF">private</span> IObjectFactory objectFactory;

        <span style="color: #0000FF">public</span> <span style="color: #0000FF">object</span> Process(IDictionary commandState)
        {
            <i style="color: #008000">// grab a new instance of the appropriate Command</i>
            Command command = CreateCommand();
            <i style="color: #008000">// set the state on the (hopefully brand new) Command instance</i>
            command.State = commandState;
            <span style="color: #0000FF">return</span> command.Execute();
        }

        <i style="color: #008000">// the Command returned here could be an implementation that executes asynchronously, or whatever</i>
        <span style="color: #0000FF">protected</span> Command CreateCommand()
        {
            <span style="color: #0000FF">return</span> (Command) objectFactory.GetObject(<span style="color: #000000">"command"</span>);  <i style="color: #008000">// notice the Spring API dependency </i>
        }

        <span style="color: #0000FF">public</span> IObjectFactory ObjectFactory
        {
            <span style="color: #0000FF">set</span> { objectFactory = <span style="color: #0000FF">value</span>; }
        }
    }
}</pre>

      <p>The preceding is not desirable, because the business code is aware
      of and coupled to the Sring Framework. Method Injection, a somewhat
      advanced feature of the Spring IoC container, allows this use case to be
      handled in a clean fashion.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-method-injection-lookup"></a>5.3.8.1.&nbsp;Lookup Method Injection</h4></div></div></div>
        

        <p>Lookup method injection is the ability of the container to
        override methods on <span class="emphasis"><em>container managed objects</em></span>, to
        return the result of looking up another named object in the container.
        The lookup typically involves a prototype object as in the scenario
        described in the preceding section. The Spring framework implements
        this method injection by a dynamically generating a subclass
        overriding the method using the classes in the
        <code class="literal">System.Reflection.Emit</code> namespace.</p>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
          <p>You can read more about the motivation for Method Injection in
          <a class="link" href="http://blog.springframework.com/rod/?p=1" target="_top">this blog
          entry</a>.</p>
        </td></tr></table></div>

        <p>Looking at the <code class="literal">CommandManager</code> class in the
        previous code snippit, you see that the Spring container will
        dynamically override the implementation of the
        <code class="literal">CreateCommand()</code> method. Your
        <code class="literal">CommandManager</code> class will not have any Spring
        dependencies, as can be seen in this reworked example below:</p>

        <pre class="programlisting"><span style="color: #0000FF">using</span> System.Collections;

<span style="color: #0000FF">namespace</span> Fiona.Apple
{
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">abstract</span> <span style="color: #0000FF">class</span> CommandManager
    {

        <span style="color: #0000FF">public</span> <span style="color: #0000FF">object</span> Process(IDictionary commandState)
        {
            Command command = CreateCommand();
            command.State = commandState;
            <span style="color: #0000FF">return</span> command.Execute();
        }

        <i style="color: #008000">// okay... but where is the implementation of this method?</i>
        <span style="color: #0000FF">protected</span> <span style="color: #0000FF">abstract</span> Command CreateCommand();
    }
}</pre>

        <p>In the client class containing the method to be injected (the
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">CommandManager</span> in this case) the method to be
        injected requires a signature of the following form:</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;public|protected&gt;</span> [abstract] <span style="color: #A31515">&lt;return-type&gt;</span> TheMethodName(no-arguments);</pre>

        <p>If the method is <code class="literal">abstract</code>, the
        dynamically-generated subclass implements the method. Otherwise, the
        dynamically-generated subclass overrides the concrete method defined
        in the original class. Let's look at an example:</p>

        <pre class="programlisting"><i style="color: #008000">&lt;!-- a stateful object deployed as a prototype (non-singleton) --&gt;</i>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"command"</span> <span style="color: #FF0000">class</span>=<span style="color: #0000FF">"Fiona.Apple.AsyncCommand, Fiona"</span> <span style="color: #FF0000">singleton</span>=<span style="color: #0000FF">"false"</span><span style="color: #A31515">&gt;</span>
  <i style="color: #008000">&lt;!-- inject dependencies here as required --&gt;</i>
<span style="color: #A31515">&lt;/object&gt;</span>

<i style="color: #008000">&lt;!-- commandProcessor uses a statefulCommandHelpder --&gt;</i>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"commandManager"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Fiona.Apple.CommandManager, Fiona"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;lookup-method</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"CreateCommand"</span> <span style="color: #FF0000">object</span>=<span style="color: #0000FF">"command"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>The object identified as <code class="literal">commandManager</code> will
        calls its own method <code class="literal">CreateCommand</code> whenever it
        needs a new instance of the <code class="literal">command</code> object. You
        must be careful to deploy the <code class="literal">command</code> object as
        prototype, if that is actually what is needed. If it is deployed as a
        <a class="link" href="objects.html#objects-factory-scopes-singleton" title="5.4.1.&nbsp;The singleton scope">singleton</a> the
        same instance of <code class="literal">singleShotHelper</code> will be returned
        each time.</p>

        <p>Note that lookup method injection can be combined with
        Constructor Injection (supplying optional constructor arguments to the
        object being constructed), and also with Setter Injection (settings
        properties on the object being constructed).</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-method-injection-replacement"></a>5.3.8.2.&nbsp;Arbitrary method replacement</h4></div></div></div>
        

        <p>A less commonly useful form of method injection than Lookup
        Method Injection is the ability to replace arbitrary methods in a
        managed object with another method implementation.</p>

        <p>With XML-based configuration metadata, you can use the
        <code class="literal">replaced-method</code> element to replace an existing
        method implementation with another, for a deployed object. Consider
        the following class, with a method <code class="literal">ComputeValue</code>,
        which we want to override:</p>

        <pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> MyValueCalculator {

  <span style="color: #0000FF">public</span> <span style="color: #0000FF">virtual</span> <span style="color: #0000FF">string</span> ComputeValue(<span style="color: #0000FF">string</span> input) {
    <i style="color: #008000">// ... some real code</i>
  }

  <i style="color: #008000">// ... some other methods</i>
}</pre>

        <p>A class implementing the
        <code class="literal">Spring.Objects.Factory.Support.IMethodReplacer</code>
        interface is needed to provide the new (injected) method
        definition.</p>

        <pre class="programlisting"><b>/// &lt;summary&gt;</b>
<b>/// Meant to be used to override the existing ComputeValue(string)</b>
<b>/// implementation in MyValueCalculator.</b>
<b>/// &lt;/summary&gt;</b>
<span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> ReplacementComputeValue : IMethodReplacer 
{
	<span style="color: #0000FF">public</span> <span style="color: #0000FF">object</span> Implement(<span style="color: #0000FF">object</span> target, MethodInfo method, <span style="color: #0000FF">object</span>[] arguments)
	{
		<i style="color: #008000">// get the input value, work with it, and return a computed result...</i>
		<span style="color: #0000FF">string</span> <span style="color: #0000FF">value</span> = (<span style="color: #0000FF">string</span>) arguments[0];
		<i style="color: #008000">// compute...</i>
		<span style="color: #0000FF">return</span> result;
	}
}</pre>

        <p>The object definition to deploy the original class and specify
        the method override would look like this:</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myValueCalculator"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.MyValueCalculator, ExampleAssembly"</span><span style="color: #A31515">&gt;</span>
  <i style="color: #008000">&lt;!-- arbitrary method replacement --&gt;</i>
  <span style="color: #A31515">&lt;replaced-method</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ComputeValue"</span> <span style="color: #FF0000">replacer</span>=<span style="color: #0000FF">"replacementComputeValue"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;arg-type</span> <span style="color: #FF0000">match</span>=<span style="color: #0000FF">"String"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/replaced-method&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"replacementComputeValue"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ReplacementComputeValue, ExampleAssembly"</span><span style="color: #A31515">/&gt;</span></pre>

        <p>You can use one or more contained <code class="literal">arg-type</code>
        elements within the <code class="literal">replaced-method</code> element to
        indicate the method signature of the method being overridden. The
        signature for the arguments is necessaryonly if the method is
        overloaded and multiple variants exist within the class. For
        convenience, the type string for an argument may be a substring of the
        fully qualified type name. For example, the following all match
        <code class="literal">System.String</code>.</p>

        <pre class="programlisting">    System.String
    String
    Str</pre>

        <p>Because the number of arguments is often enough to distinguish
        between each possible choice, this shortcut can save a lot of typing,
        by allowing you to typ just the shortest string which will match an
        argument type.</p>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-advancedproperty-setting"></a>5.3.9.&nbsp;Setting a reference using the members of other objects and
      classes.</h3></div></div></div>
      

      <p>This section details those configuration scenarios that involve
      the setting of properties and constructor arguments using the members of
      other objects and classes. This kind of scenario is quite common,
      especially when dealing with legacy classes that you cannot (or won't)
      change to accommodate some of Spring.NET's conventions... consider the
      case of a class that has a constructor argument that can only be
      calculated by going to say, a database. The
      <code class="literal">MethodInvokingFactoryObject</code> handles exactly this
      scenario ... it will allow you to inject the result of an arbitrary
      method invocation into a constructor (as an argument) or as the value of
      a property setter. Similarly,
      <code class="literal">PropertyRetrievingFactoryObject</code> and
      <code class="literal">FieldRetrievingFactoryObject</code> allow you to retrieve
      values from another object's property or field value. These classes
      implement the <code class="literal">IFactoryObject</code> interface which
      indicates to Spring.NET that this object is itself a factory and the
      factories product, not the factory itself, is what will be associated
      with the object id. Factory objects are discussed further in <a class="xref" href="objects.html#objects-factory-lifecycle-factoryobject" title="5.9.3.&nbsp;Customizing instantiation logic using IFactoryObjects">Section&nbsp;5.9.3, &#8220;Customizing instantiation logic using
      IFactoryObjects&#8221;</a></p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e1289"></a>5.3.9.1.&nbsp;Setting a reference to the value of property.</h4></div></div></div>
        

        <p>The <code class="literal">PropertyRetrievingFactoryObject</code> is an
        <code class="literal">IFactoryObject</code> that addresses the scenario of
        setting one of the properties and / or constructor arguments of an
        object to the value of a property exposed on another object or class.
        One can use it to get the value of any <span class="bold"><strong>public</strong></span> property exposed on either an instance
        or a class (in the case of a property exposed on a class, the property
        must obviously be static).</p>

        <p>In the case of a property exposed on an instance, the target
        object that a <code class="literal">PropertyRetrievingFactoryObject</code> will
        evaluate can be either an object instance specified directly inline or
        a reference to another arbitrary object. In the case of a static
        property exposed on a class, the target object will be the class (the
        .NET <code class="literal">System.Type</code>) exposing the property.</p>

        <p>The result of evaluating the property lookup may then be used in
        another object definition as a property value or constructor argument.
        Note that nested properties are supported for both instance and class
        property lookups. The <code class="literal">IFactoryObject</code> is discussed
        more generally in <a class="xref" href="objects.html#objects-factory-lifecycle-factoryobject" title="5.9.3.&nbsp;Customizing instantiation logic using IFactoryObjects">Section&nbsp;5.9.3, &#8220;Customizing instantiation logic using
      IFactoryObjects&#8221;</a>.</p>

        <p>Here's an example where a property path is used against another
        object instance. In this case, an inner object definition is used and
        the property path is nested, i.e. spouse.age. </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"person"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.TestObject, Spring.Core.Tests"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"age"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"20"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spouse"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.TestObject, Spring.Core.Tests"</span><span style="color: #A31515">&gt;</span>                      
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"age"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"21"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>          
<span style="color: #A31515">&lt;/object&gt;</span>
        
// will result in 21, which is the value of property 'spouse.age' of object 'person'        
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"theAge"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.PropertyRetrievingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetObject"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"person"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetProperty"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"spouse.age"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>An example of using a
        <code class="literal">PropertyRetrievingFactoryObject</code> to evaluate a
        <code class="literal">static</code> property is shown below.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"cultureAware"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Xml.XmlObjectFactoryTests+MyTestObject, Spring.Core.Tests"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"culture"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"cultureFactory"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"cultureFactory"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.PropertyRetrievingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"StaticProperty"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;value&gt;</span>System.Globalization.CultureInfo.CurrentUICulture, Mscorlib<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>Similarly, an example showing the use of an instance property is
        shown below.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"instancePropertyCultureAware"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Xml.XmlObjectFactoryTests+MyTestObject, Spring.Core.Tests"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Culture"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"instancePropertyCultureFactory"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"instancePropertyCultureFactory"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.PropertyRetrievingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetObject"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"instancePropertyCultureAwareSource"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetProperty"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"MyDefaultCulture"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"instancePropertyCultureAwareSource"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Xml.XmlObjectFactoryTests+MyTestObject, Spring.Core.Tests"</span><span style="color: #A31515">/&gt;</span>
    </pre>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e1309"></a>5.3.9.2.&nbsp;Setting a reference to the value of field.</h4></div></div></div>
        

        <p>The <code class="literal">FieldRetrievingFactoryObject</code> class
        addresses much the same area of concern as the
        <code class="literal">PropertyRetrievingFactoryObject</code> described in the
        previous section. However, as its name might suggest, the
        <code class="literal">FieldRetrievingFactoryObject</code> class is concerned
        with looking up the value of a <span class="bold"><strong>public</strong></span>
        field exposed on either an instance or a class (and similarly, in the
        case of a field exposed on a class, the field must obviously be
        static).</p>

        <p>The following example demonstrates using a
        <code class="literal">FieldRetrievingFactoryObject</code> to look up the value
        of a (public, static) field exposed on a class</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"withTypesField"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Xml.XmlObjectFactoryTests+MyTestObject, Spring.Core.Tests"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Types"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"emptyTypesFactory"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"emptyTypesFactory"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.FieldRetrievingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetType"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"System.Type, Mscorlib"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetField"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"EmPTytypeS"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>
      </pre>

        <p>The example in the next section demonstrates the look up of a
        (public) field exposed on an object instance.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"instanceCultureAware"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Xml.XmlObjectFactoryTests+MyTestObject, Spring.Core.Tests"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Culture"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"instanceCultureFactory"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"instanceCultureFactory"</span>
  <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.FieldRetrievingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetObject"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"instanceCultureAwareSource"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetField"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Default"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"instanceCultureAwareSource"</span> 
         <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Xml.XmlObjectFactoryTests+MyTestObject, Spring.Core.Tests"</span><span style="color: #A31515">/&gt;</span>
    </pre>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-methodfactory"></a>5.3.9.3.&nbsp;Setting a property or constructor argument to the return value
        of a method invocation.</h4></div></div></div>
        

        <p>The <code class="literal">MethodInvokingFactoryObject</code> rounds out
        the trio of classes that permit the setting of properties and
        constructor arguments using the members of other objects and classes.
        Whereas the <code class="literal">PropertyRetrievingFactoryObject</code> and
        <code class="literal">FieldRetrievingFactoryObject</code> classes dealt with
        simply looking up and returning the value of property or field on an
        object or class, the <code class="literal">MethodInvokingFactoryObject</code>
        allows one to set a constructor or property to the return value of an
        arbitrary method invocation,</p>

        <p>The <code class="literal">MethodInvokingFactoryObject</code> class handles
        both the case of invoking an (instance) method on another object in
        the container, and the case of a static method call on an arbitrary
        class. Additionally, it is sometimes necessary to invoke a method just
        to perform some sort of initialization.... while the mechanisms for
        handling object initialization have yet to be introduced (see <a class="xref" href="objects.html#objects-factory-lifecycle-initializingobject" title="5.6.1.1.&nbsp;IInitializingObject / init-method">Section&nbsp;5.6.1.1, &#8220;IInitializingObject / init-method&#8221;</a>), these
        mechanisms do not permit any arguments to be passed to any
        initialization method, and are confined to invoking an initialization
        method on the object that has just been instantiated by the container.
        The <code class="literal">MethodInvokingFactoryObject</code> allows one to
        invoke pretty much <span class="bold"><strong>any</strong></span> method on any
        object (or class in the case of a static method).</p>

        <p>The following example (in an XML based
        <code class="literal">IObjectFactory</code> definition) uses the
        <code class="literal">MethodInvokingFactoryObject</code> class to force a call
        to a static factory method prior to the instantiation of the
        object...</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"force-init"</span>
  <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.MethodInvokingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"StaticMethod"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>ExampleNamespace.ExampleInitializerClass.Initialize<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myService"</span> <span style="color: #FF0000">depends-on</span>=<span style="color: #0000FF">"force-init"</span><span style="color: #A31515">/&gt;</span></pre><p> Note
        that the definition for the <code class="literal">myService</code> object has
        used the <code class="literal">depends-on</code> attribute to refer to the
        <code class="literal">force-init</code> object, which will force the
        initialization of the <code class="literal">force-init</code> object first (and
        thus the calling of its configured <code class="literal">StaticMethod</code>
        static initializer method, when <code class="literal">myService</code> is first
        initialized. Please note that in order to effect this initialization,
        the <code class="literal">MethodInvokingFactoryObject</code> object <span class="bold"><strong>must</strong></span> be operating in
        <code class="literal">singleton</code> mode (the default.. see the next
        paragraph).</p>

        <p>Note that since this class is expected to be used primarily for
        accessing factory methods, this factory defaults to operating in
        <code class="literal">singleton</code> mode. As such, as soon as all of the
        properties for a <code class="literal">MethodInvokingFactoryObject</code> object
        have been set, and if the
        <code class="literal">MethodInvokingFactoryObject</code> object is still in
        <code class="literal">singleton</code> mode, the method will be invoked
        immediately and the return value cached for later access. The first
        request by the container for the factory to produce an object will
        cause the factory to return the cached return value for the current
        request (and all subsequent requests). The
        <code class="methodname">IsSingleton</code> property may be set to false, to
        cause this factory to invoke the target method each time it is asked
        for an object (in this case there is obviously no caching of the
        return value).</p>

        <p>A static target method may be specified by setting the
        <code class="methodname">targetMethod</code> property to a string
        representing the static method name, with
        <code class="methodname">TargetType</code> specifying the
        <code class="literal">Type</code> that the static method is defined on.
        Alternatively, a target instance method may be specified, by setting
        the <code class="methodname">TargetObject</code> property to the name of
        another Spring.NET managed object definition (the target object), and
        the <code class="methodname">TargetMethod</code> property to the name of the
        method to call on that target object.</p>

        <p>Arguments for the method invocation may be specified in two ways
        (or even a mixture of both)... the first involves setting the
        <code class="methodname">Arguments</code> property to the list of arguments
        for the method that is to be invoked. Note that the ordering of these
        arguments is significant... the order of the values passed to the
        <code class="methodname">Arguments</code> property must be the same as the
        order of the arguments defined on the method signature, including the
        argument <code class="literal">Type</code>. This is shown in the example below
        </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.MethodInvokingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetType"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Whatever.MyClassFactory, MyAssembly"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetMethod"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"GetInstance"</span><span style="color: #A31515">/&gt;</span>
  
  <i style="color: #008000">&lt;!-- the ordering of arguments is significant --&gt;</i>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Arguments"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;list&gt;</span>
      <span style="color: #A31515">&lt;value&gt;</span>1st<span style="color: #A31515">&lt;/value&gt;</span>
      <span style="color: #A31515">&lt;value&gt;</span>2nd<span style="color: #A31515">&lt;/value&gt;</span>
      <span style="color: #A31515">&lt;value&gt;</span>and 3rd arguments<span style="color: #A31515">&lt;/value&gt;</span>
      <i style="color: #008000">&lt;!-- automatic Type-conversion will be performed prior to invoking the method --&gt;</i>
    <span style="color: #A31515">&lt;/list&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>The second way involves passing an arguments dictionary to the
        <code class="methodname">NamedArguments</code> property... this dictionary
        maps argument names (<code class="literal">String</code>s) to argument values
        (any object). The argument names are not case-sensitive, and order is
        (obviously) not significant (since dictionaries by definition do not
        have an order). This is shown in the example below </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.MethodInvokingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetObject"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Whatever.MyClassFactory, MyAssembly"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetMethod"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Execute"</span><span style="color: #A31515">/&gt;</span>
  
  <i style="color: #008000">&lt;!-- the ordering of named arguments is not significant --&gt;</i>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"NamedArguments"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;dictionary&gt;</span>
      <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"argumentName"</span><span style="color: #A31515">&gt;</span><span style="color: #A31515">&lt;value&gt;</span>1st<span style="color: #A31515">&lt;/value&gt;</span><span style="color: #A31515">&lt;/entry&gt;</span>
      <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"finalArgumentName"</span><span style="color: #A31515">&gt;</span><span style="color: #A31515">&lt;value&gt;</span>and 3rd arguments<span style="color: #A31515">&lt;/value&gt;</span><span style="color: #A31515">&lt;/entry&gt;</span>
      <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"anotherArgumentName"</span><span style="color: #A31515">&gt;</span><span style="color: #A31515">&lt;value&gt;</span>2nd<span style="color: #A31515">&lt;/value&gt;</span><span style="color: #A31515">&lt;/entry&gt;</span>
    <span style="color: #A31515">&lt;/dictionary&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>The following example shows how use
        <code class="literal">MethodInvokingFactoryObject</code> to call an instance
        method.</p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myMethodObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Whatever.MyClassFactory, MyAssembly"</span><span style="color: #A31515"> /&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.MethodInvokingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetObject"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"myMethodObject"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetMethod"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Execute"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre><p> The above example could also have been
        written using an anonymous inner object definition... if the object on
        which the method is to be invoked is not going to be used outside of
        the factory object definition, then this is the preferred idiom
        because it limits the scope of the object on which the method is to be
        invoked to the surrounding factory object.</p>

        <p>Finally, if you want to use
        <code class="literal">MethodInvokingFactoryObject</code> in conjunction with a
        method that has a variable length argument list, then please note that
        the variable arguments need to be passed (and configured) as a
        <span class="emphasis"><em>list</em></span>. Let us consider the following method
        definition that uses the <code class="literal">params</code> keyword (in C#),
        and its attendant (XML) configuration... </p><pre class="programlisting">[C#]
<span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> MyClassFactory
{
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">object</span> CreateObject(Type objectType, <span style="color: #0000FF">params</span> <span style="color: #0000FF">string</span>[] arguments)
    {
        <span style="color: #0000FF">return</span> ... <i style="color: #008000">// implementation elided for clarity...</i>
    }
}</pre><p> </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myMethodObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Whatever.MyClassFactory, MyAssembly"</span><span style="color: #A31515"> /&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"paramsMethodObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.MethodInvokingFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetObject"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"myMethodObject"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TargetMethod"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"CreateObject"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Arguments"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;list&gt;</span>
      <span style="color: #A31515">&lt;value&gt;</span>System.String<span style="color: #A31515">&lt;/value&gt;</span>
      <i style="color: #008000">&lt;!-- here is the 'params string[] arguments' --&gt;</i>
      <span style="color: #A31515">&lt;list&gt;</span>
        <span style="color: #A31515">&lt;value&gt;</span>1st<span style="color: #A31515">&lt;/value&gt;</span>
        <span style="color: #A31515">&lt;value&gt;</span>2nd<span style="color: #A31515">&lt;/value&gt;</span>
      <span style="color: #A31515">&lt;/list&gt;</span>
    <span style="color: #A31515">&lt;/list&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-objectfactories"></a>5.3.10.&nbsp;Provided IFactoryObject implementations</h3></div></div></div>
      

      <p>In addition to <code class="literal">PropertyRetrievingFactoryObject</code>,
      <code class="literal">MethodInvokingFactoryObject</code>, and
      <code class="literal">FieldRetrievingFactoryObject </code> Spring.NET comes with
      other useful implementations of the <code class="literal">IFactoryObject</code>
      interface. These are discussed below.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-objectfactories-log4net"></a>5.3.10.1.&nbsp;Common logging</h4></div></div></div>
        

        <p>The <code class="literal">LogFactoryObject</code> is useful when you would
        like to share a Common.Logging log object across a number of classes
        instead of creating a logging instance per class or class hierarchy.
        Information on the Common.Logging project can be found <a class="link" href="http://netcommon.sourceforge.net/" target="_top">here</a>. In the
        example shown below the same logging instance, with a logging category
        name of "DAOLogger", is used in both the SimpleAccountDao and
        SimpleProductDao data access objects. </p><pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span> 
         <span style="color: #FF0000">xmlns:xsi</span>=<span style="color: #0000FF">"http://www.w3.org/2001/XMLSchema-instance"</span> 
         <span style="color: #FF0000">xsi:schemaLocation</span>=<span style="color: #0000FF">"http://www.springframework.net
         http://www.springframework.net/xsd/spring-objects.xsd"</span><span style="color: #A31515"> &gt;</span>

    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"daoLogger"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.LogFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"logName"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"DAOLogger"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>
        
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"productDao"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"PropPlayApp.SimpleProductDao, PropPlayApp "</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"maxResults"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"100"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"dbConnection"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"myConnection"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"log"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"daoLogger"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>

    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"accountDao"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"PropPlayApp.SimpleAccountDao, PropPlayApp "</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"maxResults"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"100"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"dbConnection"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"myConnection"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"log"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"daoLogger"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>
    
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myConnection"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"System.Data.Odbc.OdbcConnection, System.Data"</span><span style="color: #A31515">&gt;</span> 
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"connectionstring"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"dsn=MyDSN;uid=sa;pwd=myPassword;"</span><span style="color: #A31515">/&gt;</span> 
    <span style="color: #A31515">&lt;/object&gt;</span> 
    
<span style="color: #A31515">&lt;/objects&gt;</span></pre>
      </div>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-factory-scopes"></a>5.4.&nbsp;Object Scopes</h2></div></div></div>
    

    <p>When you create an object definition, you create a
    <span class="emphasis"><em>recipe</em></span> for creating actual instances of the class
    defined by that object definition. The idea that an object definition is a
    recipe is important, because it means that, as with a class, you can
    create many object instances from a single recipe.</p>

    <p>You can control not only the various dependencies and configuration
    values that are to be plugged into an object that is created from a
    particular object definition, but also the <span class="emphasis"><em>scope</em></span> of
    the objects created from a particular object definition. This approach
    powerful and flexible in that you can <span class="emphasis"><em>choose</em></span> the
    scope of the objects you create through configuration instead of having to
    bake in the scope of an object at the .NET class level. Ob jects can be
    defined to be deployed in one of a number of scopes: out of the box, the
    Spring Framework supports five scopes, three of which are available only
    if you use a web-aware
    <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span>.</p>

    <p>The following scopes supported. Support for user defined custom
    scopes is planned for Spring .NET 2.0.</p>

    <div class="table"><a name="d4e1400"></a><div class="title">Table&nbsp;5.5.&nbsp;Object Scopes</div><div class="table-contents">
      

      <table summary="Object Scopes" border="1"><colgroup><col><col></colgroup><thead><tr><th>Scope</th><th>Description</th></tr></thead><tbody><tr><td>singleton</td><td>Scopes a single object definition to a single object
            instance per Spring IoC container.</td></tr><tr><td>prototype</td><td>Scopes a single object definition to any number of object
            instances.</td></tr><tr><td>request</td><td>Scopes a single object definition to the lifecycle of a
            single HTTP request; that is, each and every HTTP request has its
            own instance of an object created off the back of a single object
            definition. Only valid in the context of a web-aware Spring
            ApplicationContext.</td></tr><tr><td>session</td><td>Scopes a single object definition to the lifecycle of a
            HTTP Session. Only valid in the context of a web-aware Spring
            ApplicationContext.</td></tr><tr><td>application</td><td>Scopes a single object definition to the lifecycle of a web
            application. Only valid in the context of a web-aware Spring
            ApplicationContext.</td></tr></tbody></table>
    </div></div><br class="table-break">

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-scopes-singleton"></a>5.4.1.&nbsp;The singleton scope</h3></div></div></div>
      

      <p>Singleton scoped objects have only one shared instance of an
      object managed by the container. All request for objects with an id or
      ids matching that object definition result in that one specific object
      instance being returned by the Spring container.</p>

      <p>To put it another way, when you define an object definition and it
      is scoped as a singleton, the Spring IoC container creates exactly one
      instance of the object defined by that object definition. This single
      instance is stored in a cache of such singleton object, and all
      subsequent requests and references for that named object return the
      cached object.</p>

      <p>Spring's concept of a singleton differns from the Singleton
      pattern as defined in the Gang of Four (GoF) patterns book. The GoF
      Singleton hard-codes the scope of an object such that one <span class="emphasis"><em>and
      only one</em></span> instance of a particular class is created per
      ApplicationDomain. The scope of the Spring singleton is best described
      as <span class="emphasis"><em>per container and per object</em></span>. This means that if
      you define one object for a particular class in a single Spring
      container, then the Spring container creates one <span class="emphasis"><em>and only
      one</em></span> instance of the class defined by that object definition.
      The singleton scope is the default scope in Spring. To define an object
      as a singleton in XML, you would write, for example:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"accountService"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyApp.DefaultAccountService, MyApp"</span><span style="color: #A31515">/&gt;</span>

<i style="color: #008000">&lt;!-- the following is equivalent, though redundant (singleton scope is the default) --&gt;</i>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"accountService"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyApp.DefaultAccountService, MyApp"</span> <span style="color: #FF0000">singleton</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">/&gt;</span>


</pre>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-scopes-prototype"></a>5.4.2.&nbsp;The prototype scope</h3></div></div></div>
      

      <p>The non-singleton, prototype scope of object deployment results in
      the creation of a <span class="emphasis"><em>new object instance</em></span> every time a
      request for that specific object is made. That is, the object is
      injected into another object or you request through a
      <code class="literal">GetObject()</code> method call on the container. As a rule
      use the prototype scope for all objects that are stateful and the
      singleton scope for stateless objects.</p>

      <p>The following examples defines an object as a prototype in
      XML:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject, ExamplesLibrary"</span> <span style="color: #FF0000">scope</span>=<span style="color: #0000FF">"prototype"</span><span style="color: #A31515">/&gt;</span></pre>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p>The <code class="literal">&lt;singleton/&gt;</code> attribute was
        introduced Spring 1.0 as there were only two types of scopes,
        singleton and prototype. The element singleton=true refers to
        singleton scope and singleton=false refers to prototype scope. In
        Spring 1.1 the additional web scopes were introduced along with the
        new elment 'scope'. The scope element is the preferred element to
        use.</p>
      </td></tr></table></div>

      <p>In contrast to the other scopes, Spring does not manage the
      complete lifecycle of a prototype object: the container instantiates,
      configures, decorates and otherwise assembles a prototype object, hands
      it to the client, with no further record of that prototype instance.
      Thus, although <span class="emphasis"><em>initialization</em></span> lifecycle callback
      methods are called on all objects regardless of scope, in the case of
      prototypes, configured <span class="emphasis"><em>destruction</em></span> lifecycle
      callbacks are <span class="emphasis"><em>not</em></span> called. The client code must
      clean up prototype-scoped objects and release any expensive resources
      that the prototype object(s) are holding. To get the Spring container to
      release resources held by prototype-scoped objects, try using a custom
      <a class="link" href="objects.html#objects-factory-customizing" title="5.9.1.&nbsp;Customizing objects with IObjectPostProcessors">object post processor</a>
      which would hold a reference to the objects that need to be cleaned
      up.</p>

      <p>In some respects, the Spring container's role in regard to a
      prototype-scoped object is a replacement for the C# 'new' operator. All
      lifecycle management past that point must be handled by the client. (For
      details on the lifecycle of an object in the Spring container, see <a class="xref" href="objects.html#objects-factory-lifecycle" title="5.6.1.&nbsp;Lifecycle interfaces">Section&nbsp;5.6.1, &#8220;Lifecycle interfaces&#8221;</a>.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-scopes-sing-prot-interaction"></a>5.4.3.&nbsp;Singleton objects with prototype-object dependencies</h3></div></div></div>
      

      <p>When you use singleton-scoped objects with dependencies on
      prototype objects, be aware that <span class="emphasis"><em>dependencies are resolved at
      instantiation time</em></span>. Thus if you dependency-inject a
      prototype-scoped objects into a singleton-scoped object, a new prototype
      object is instantiated and then dependency-injected into the singleton
      object. The prototype instance is the sole instance that is ever
      supplied to the singleton-scoped object.</p>

      <p>However, suppose you want the singleton-scoped object to acquire a
      new instance of the prototype-scoped object repeatedly at runtime. You
      cannot dependency-inject a prototype-scoped object into your singleton
      object, because that injection occurs only once, when the Spring
      container is instantiating the singleton object and resolving and
      injecting its dependencies. If you need a new instance of a prototype
      object at runtime more than once, see <a class="xref" href="objects.html#objects-method-injection" title="5.3.8.&nbsp;Method injection">Section&nbsp;5.3.8, &#8220;Method injection&#8221;</a>.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1457"></a>5.4.4.&nbsp;Request, session and web application scopes</h3></div></div></div>
      

      <p>The <a class="link" href="">request</a>, <a class="link" href="">session</a> and <a class="link" href="">application</a>
      scopes are <span class="emphasis"><em>only</em></span> available if you use a web-aware
      Spring <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span>
      implementation, such as <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">WebApplicationContext</span>. If
      you use these scopes with regular Spring IoC containers such as the
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">XmlApplicationContext</span>, you will get an exception
      complaining about an unknown object scope.</p>

      <p>Please refer to the <a class="link" href="web.html#web-objectscope" title="22.5.&nbsp;Web object scopes">web
      documentation on object scopes</a> for more information.</p>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-type-conversion"></a>5.5.&nbsp;Type conversion</h2></div></div></div>
    

    <p>Type converters are responsible for converting objects from one type
    to another. When using the XML based file to configure the IoC container,
    string based property values are converted to the target property type.
    Spring will rely on the standard .NET support for type conversion unless
    an alternative <code class="literal">TypeConverter</code> is registered for a given
    type. How to register custom TypeConverters will be described shortly. As
    a reminder, the standard .NET type converter support works by associating
    a <code class="literal">TypeConverter</code> attribute with the class definition by
    passing the type of the converter as an attribute argument. <sup>[<a name="d4e1474" href="#ftn.d4e1474" class="footnote">3</a>]</sup> For example, an abbreviated class definition for the BCL
    type <code class="literal">Font</code> is shown below. </p><pre class="programlisting">[Serializable, TypeConverter(<span style="color: #0000FF">typeof</span>(FontConverter)), ...]
<span style="color: #0000FF">public</span> <span style="color: #0000FF">sealed</span> <span style="color: #0000FF">class</span> Font : MarshalByRefObject, ICloneable, ISerializable, IDisposable
{
  <i style="color: #008000">// Methods</i>
  
  ... etc ..
}</pre>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-type-conversion-enums"></a>5.5.1.&nbsp;Type Conversion for Enumerations</h3></div></div></div>
      

      <p>The default type converter for enumerations is the
      <code class="literal">System.ComponentModel.EnumConverter</code> class. To specify
      the value for an enumerated property, simply use the name of the
      property. For example the <code class="literal">TestObject</code> class has a
      property of the enumerated type <code class="literal">FileMode</code>. One of the
      values for this enumeration is named <code class="literal">Create</code>. The
      following XML fragment shows how to configure this property</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"rod"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.TestObject, Spring.Core.Tests"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"name"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Rod"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"FileMode"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Create"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-type-conversion-builtin"></a>5.5.2.&nbsp;Built-in TypeConverters</h3></div></div></div>
      

      <p>Spring.NET pre-registers a number of custom
      <code class="literal">TypeConverter</code> instances (for example, to convert a
      type expressed as a string into a real <code class="literal">System.Type</code>
      object). Each of those is listed below and they are all located in the
      <code class="literal">Spring.Objects.TypeConverters</code> namespace of the
      <code class="literal">Spring.Core</code> library.</p>

      <div class="table"><a name="d4e1496"></a><div class="title">Table&nbsp;5.6.&nbsp;Built-in <code class="literal">TypeConverters</code></div><div class="table-contents">
          

          <table summary="Built-in TypeConverters" border="1"><colgroup><col><col></colgroup><thead><tr><th>Type</th><th>Explanation</th></tr></thead><tbody><tr><td><code class="literal">RuntimeTypeConverter</code></td><td>Parses strings representing
                <code class="literal">System.Types</code> to actual
                <code class="literal">System.Types</code> and the other way
                around.</td></tr><tr><td><code class="literal">FileInfoConverter</code></td><td>Capable of resolving strings to a
                <code class="literal">System.IO.FileInfo</code> object.</td></tr><tr><td><code class="literal">StringArrayConverter</code></td><td>Capable of resolving a comma-delimited list of strings
                to a string-array and vice versa.</td></tr><tr><td><code class="literal">UriConverter</code></td><td>Capable of resolving a string representation of a Uri
                to an actual <code class="literal">Uri</code>-object.</td></tr><tr><td><code class="literal">CredentialConverter</code></td><td>Capable of resolving a string representation of a
                credential for Web client authentication into an instance of
                <code class="literal">System.Net.ICredentials</code></td></tr><tr><td><code class="literal">StreamConverter</code></td><td>Capable of resolving Spring IResource Uri (string) to
                its corresponding
                <code class="literal">InputStream</code>-object.</td></tr><tr><td><code class="literal">ResourceConverter</code></td><td>Capable of resolving Spring IResource Uri (string) to
                an <code class="literal">IResource</code> object.</td></tr><tr><td><code class="literal">ResourceManagerConverter</code></td><td>Capable of resolving a two part string (resource name,
                assembly name) to a
                <code class="literal">System.Resources.ResourceManager</code>
                object.</td></tr><tr><td><code class="literal">RgbColorConverter</code></td><td>Capable of resolving a comma separated list of Red,
                Green, Blue integer values to a
                <code class="literal">System.Drawing.Color</code> structure.</td></tr><tr><td><code class="literal">ExpressionConverter</code></td><td>Capable of resolving a string into an instance of an
                object that implements the <code class="literal">IExpression</code>
                interface.</td></tr><tr><td><code class="literal">NameValueConverter</code></td><td>Capable of resolving an XML formatted string to a
                <code class="literal">Specialized.NameValueCollection</code></td></tr><tr><td><code class="literal">RegexConverter</code></td><td>Capable of resolving a string into an instance of
                <code class="literal">Regex</code></td></tr><tr><td><code class="literal">RegistryKeyConverter</code></td><td>Capable of resolving a string into a
                <code class="literal">Microsoft.Win32.RegistryKey</code> object.</td></tr></tbody></table>
        </div></div><p><br class="table-break"></p>

      <p>Spring.NET uses the standard .NET mechanisms for the resolution of
      <code class="literal">System.Types</code>, including, but not limited to checking
      any configuration files associated with your application, checking the
      Global Assembly Cache (GAC), and assembly probing.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-type-conversion-custom-overview"></a>5.5.3.&nbsp;Custom Type Conversion</h3></div></div></div>
      

      <p>There are a few ways to register custom type converters. The
      fundamental storage area in Spring for custom type converters is the
      <code class="literal">TypeConverterRegistry</code> class. The <span class="emphasis"><em>most
      convenient way</em></span> if using an XML based implementation of
      <code class="literal">IObjectFactory</code> or
      <code class="literal">IApplicationContext</code> is to use the custom
      configuration section handler
      <code class="literal">TypeConverterSectionHandler</code> This is demonstrated in
      section <a class="xref" href="objects.html#context-configuration" title="5.11.&nbsp;Configuration of IApplicationContext">Section&nbsp;5.11, &#8220;Configuration of IApplicationContext&#8221;</a></p>

      <p>An alternate approach, present for legacy reasons in the port of
      Spring.NET from the Java code base, is to use the object factory
      post-processor
      <code class="literal">Spring.Objects.Factory.Config.CustomConverterConfigurer</code>.
      This is described in the next section.</p>

      <p>If you are constructing your IoC container Programatically then
      you should use the <code class="literal">RegisterCustomConverter(Type requiredType,
      TypeConverter converter)</code> method of the
      <code class="literal">ConfigurableObjectFactory</code> interface.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-type-conversion-customconverter"></a>5.5.3.1.&nbsp;Using CustomConverterConfigurer</h4></div></div></div>
        

        <p>This section shows in detail how to define a custom type
        converter that does not use the .NET <code class="literal">TypeConverter</code>
        attribute. The type converter class is standalone and inherits from
        the <code class="literal">TypeConverter</code> class. It uses the legacy factory
        post-processor approach.</p>

        <p>Consider a user class <span class="emphasis"><em>ExoticType</em></span>, and
        another class <span class="emphasis"><em>DependsOnExoticType</em></span> which needs
        ExoticType set as a property:</p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> ExoticType
{
    <span style="color: #0000FF">private</span> <span style="color: #0000FF">string</span> name;
        
    <span style="color: #0000FF">public</span> ExoticType(<span style="color: #0000FF">string</span> name)
    {
        <span style="color: #0000FF">this</span>.name = name;
    }

    <span style="color: #0000FF">public</span> <span style="color: #0000FF">string</span> Name
    {
        <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.name; }
    }
}</pre><p> and </p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> DependsOnExoticType
{
    <span style="color: #0000FF">public</span> DependsOnExoticType() {}
    
    <span style="color: #0000FF">private</span> ExoticType exoticType;
        
    <span style="color: #0000FF">public</span> ExoticType ExoticType
    {
        <span style="color: #0000FF">get</span> { <span style="color: #0000FF">return</span> <span style="color: #0000FF">this</span>.exoticType; }
        <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.exoticType = <span style="color: #0000FF">value</span>; }
    }
    
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">string</span> ToString()
    {
        <span style="color: #0000FF">return</span> exoticType.Name;
    }
}</pre><p> When things are properly set up, we want to be able to
        assign the type property as a string, which a TypeConverter will
        convert into a real ExoticType object behind the scenes:
        </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"sample"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SimpleApp.DependsOnExoticType, SimpleApp"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"exoticType"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"aNameForExoticType"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre><p> The TypeConverter looks like this:
        </p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> ExoticTypeConverter : TypeConverter
{
	<span style="color: #0000FF">public</span> ExoticTypeConverter()
	{
	}

	<span style="color: #0000FF">public</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">bool</span> CanConvertFrom (
		ITypeDescriptorContext context, 
		Type sourceType) 
	{
		<span style="color: #0000FF">if</span> (sourceType == <span style="color: #0000FF">typeof</span> (<span style="color: #0000FF">string</span>)) 
		{
			<span style="color: #0000FF">return</span> <span style="color: #0000FF">true</span>;
		}
		<span style="color: #0000FF">return</span> <span style="color: #0000FF">base</span>.CanConvertFrom (context, sourceType);
	}

	<span style="color: #0000FF">public</span> <span style="color: #0000FF">override</span> <span style="color: #0000FF">object</span> ConvertFrom (
		ITypeDescriptorContext context, 
		CultureInfo culture, <span style="color: #0000FF">object</span> <span style="color: #0000FF">value</span>) 
	{
		<span style="color: #0000FF">string</span> s = <span style="color: #0000FF">value</span> <span style="color: #0000FF">as</span> <span style="color: #0000FF">string</span>;
		<span style="color: #0000FF">if</span> (s != <span style="color: #0000FF">null</span>) 
		{          
			<span style="color: #0000FF">return</span> <span style="color: #0000FF">new</span> ExoticType(s.ToUpper());
		}
		<span style="color: #0000FF">return</span> <span style="color: #0000FF">base</span>.ConvertFrom (context, culture, <span style="color: #0000FF">value</span>);
	}
}</pre><p> Finally, we use the
        <code class="literal">CustomConverterConfigurer</code> to register the new
        <code class="literal">TypeConverter</code> with the
        <code class="literal">IApplicationContext</code>, which will then be able to use
        it as needed: </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"customConverterConfigurer"</span> 
	<span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.CustomConverterConfigurer, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"CustomConverters"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;dictionary&gt;</span>
      <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"SimpleApp.ExoticType"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"SimpleApp.ExoticTypeConverter"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;/entry&gt;</span>
    <span style="color: #A31515">&lt;/dictionary&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
      </div>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-factory-nature"></a>5.6.&nbsp;Customizing the nature of an object</h2></div></div></div>
    

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-lifecycle"></a>5.6.1.&nbsp;Lifecycle interfaces</h3></div></div></div>
      

      <p>To interact with the container's management of the object
      lifecycle, you can implement the Spring
      <code class="literal">InitializingObject</code> and standard
      <code class="literal">System.IDisposable</code> interfaces. The container calls
      <code class="literal">AfterPropertiesSet()</code> method for the former and the
      <code class="literal">Dispose()</code> method for the latter, thus allowing you to
      do things upon the initialization and destruction of your objects. You
      can also achieve the same integration with the container without
      coupling your objects to Spring interfaces though the use of
      <code class="literal">init-method</code> and <code class="literal">destroy-method</code>
      object definition metadata.</p>

      <p>Internally, Spring.NET uses implementations of the
      <code class="literal">IObjectPostProcessor</code> interface to process any call
      interfaces it can find and call the appropriate methods. If you need
      custom features or other lifecycle behavior Spring.NET does not offer
      out-of-the-box, you can implement an
      <code class="literal">IObjectPostProcessor</code> yourself. For more information
      see<a class="xref" href="objects.html#objects-factory-customizing" title="5.9.1.&nbsp;Customizing objects with IObjectPostProcessors">Section&nbsp;5.9.1, &#8220;Customizing objects with
      IObjectPostProcessors&#8221;</a>.</p>

      <p></p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-lifecycle-initializingobject"></a>5.6.1.1.&nbsp;IInitializingObject / <code class="literal">init-method</code></h4></div></div></div>
        

        <p>The
        <code class="literal">Spring.Objects.Factory.IInitializingObject</code>
        interface allows an object to perform initialization work after all
        the necessary properties on an object are set by the container. The
        <code class="literal">IInitializingObject</code> interface specifies a single
        method: </p><div class="itemizedlist"><ul type="disc" compact><li>
              <p><code class="methodname">void AfterPropertiesSet()</code>: called
              after all properties have been set by the container. This method
              enables you to do checking to see if all necessary properties
              have been set correctly, or to perform further initialization
              work. You can throw <span class="emphasis"><em>any</em></span>
              <code class="literal">Exception</code> to indicate misconfiguration,
              initialization failures, etc.</p>
            </li></ul></div>

        <p>It is recommended that you do not use the
        <code class="literal">IInitializingObject</code> interface because it
        unnecessarily coupules the code to Spring. Alternatively, specify an
        POJO initialization method. In the case of XML-based configuration
        metadata, you use the <code class="literal">init-method</code> attribute to
        specify the name of the method that has a void no-argument signature.
        For example, the following definition:</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleInitObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject"</span> <span style="color: #FF0000">init-method</span>=<span style="color: #0000FF">"init"</span><span style="color: #A31515">/&gt;</span>
[C#]
public class ExampleObject
{
    public void Init()
    {
        // do some initialization work
    }
}</pre><p>...is exactly the same as... </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleInitObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.AnotherExampleObject"</span><span style="color: #A31515">/&gt;</span>
[C#]
public class AnotherExampleObject : IInitializingObject
{
    public void AfterPropertiesSet()
    {
        // do some initialization work
    }
}</pre><p>... but does not couple the code to Spring.NET.</p>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-lifecycle-disposableobject"></a>5.6.1.2.&nbsp;IDisposable / <code class="literal">destroy-method</code></h4></div></div></div>
        

        <p>Implementing the <code class="literal">System.IDisposable</code> interface
        allows an object to get a callback callback when the container
        containing it is destroyed. The <code class="literal">IDisposable</code>
        interface specifies a single method: </p><div class="itemizedlist"><ul type="disc" compact><li>
              <p><code class="literal">void Dispose()</code>: and is called on
              destruction of the container. This allows you to release any
              resources you are keeping in this object (such as database
              connections). You can throw <span class="emphasis"><em>any</em></span>
              <code class="literal">Exception</code> here... however, any such
              <code class="literal">Exception</code> will not stop the destruction of
              the container - it will only get logged.v</p>
            </li></ul></div>

        <p>Since the <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IDisposable</span> interface resides
        in the core .NET library, it does not couple your class to Spring as
        in the case with the <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IInitializingObject</span>
        interface. However, you may also specify a destruction method that is
        not tied to the <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IDisposable</span> interface. In the
        case of XML-based configuration metadata, you use the
        <code class="literal">destroy-method</code> attribute to specify the name of the
        method that has a void no-argument signature. For example, the
        following definition:</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleInitObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject"</span> <span style="color: #FF0000">destroy-method</span>=<span style="color: #0000FF">"cleanup"</span><span style="color: #A31515">/&gt;</span>
[C#]
public class ExampleObject
{
    public void cleanup()
    {
        // do some destruction work (such as closing any open connection (s))
    }
}</pre><p> is exactly the same as: </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleInitObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.AnotherExampleObject"</span><span style="color: #A31515">/&gt;</span>
[C#]
public class AnotherExampleObject : IDisposable
{
    public void Dispose()
    {
        // do some destruction work
    }
}</pre>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-aware"></a>5.6.2.&nbsp;IApplicationContextAware and IObjectNameAware</h3></div></div></div>
      

      <p>When an <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span> creates a class
      that implements the <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContextAware</span>
      interface, the class is provided with a reference to that
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span>.</p>

      <pre class="programlisting">public interface IApplicationContextAware {    
    IApplicationContext ApplicationContext { 
      set; 
    }
}</pre>

      <p>Thus objects can manipulate programmatically the
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span> that created them, through
      the <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span> interface, or by casting
      the reference to a known subclass of this interface, such as
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IConfigurableApplicationContext</span>, which exposes
      additional functionality. One use would be the programmatic retrieval of
      other objects. Sometimes this capability is useful; however, in general
      you should avoid it, because it couples the code to Spring and does not
      follow the Inversion of Control style, where collaborators are provided
      to objects as properties. Other methods of the
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span> provide access to file
      resources, publishing application events, and accessing a
      <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IMessageSource</span>. These additional features are
      described in <a class="xref" href="objects.html#context-introduction" title="5.10.&nbsp;The IApplicationContext">Section&nbsp;5.10, &#8220;The IApplicationContext&#8221;</a></p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-aware-objectnameaware"></a>5.6.2.1.&nbsp;IObjectNameAware</h4></div></div></div>
        

        <p>When an <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IApplicationContext</span> creates a
        class that implements the
        <code class="literal">Spring.Objects.Factory.IObjectNameAware</code> interface,
        the class is provided with a reference to the name defined in its
        associated object definition.</p>

        <pre class="programlisting">public interface IObjectNameAware {
  string ObjectName {
     set; 
  }
}</pre>

        <p>The callback is invoked after population of normal object
        properties but before an initialization callback such as
        <span xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="color: #2B91AF">IInitializingObject</span> 's AfterPropertiesSet
        method or a custom initalization method is invoked.</p>
      </div>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-childobjects"></a>5.7.&nbsp;Object definition inheritance</h2></div></div></div>
    

    <p>An object definition can contain a lot of configuration information,
    including constructor arguments, property values, and container-specific
    information such as initialization method, static factory method name, and
    so on. A child object definition inherits configuration data from a parent
    definition. The child definition can override some values, or add others,
    as needed. Using parent and child object definitions can save a lot of
    typing. Effectively, this is a form of templating.</p>

    <p>If you work with an IApplicationContext interface programmatically,
    child object definitions are represented by the
    <code class="literal">ChildObjectDefinition</code> class. Most users do not work
    with them on this level, instead configuring object definitions
    declaratively in something like the
    <code class="literal">XmlApplicationContext.</code> When you use XML-based
    configuration metadata, you indicate a child object using the parent
    attribute, specifying the parent object definition as the value of this
    attribute.</p>

    <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"inheritedTestObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.TestObject, Spring.Core.Tests"</span> <span style="color: #FF0000">abstract</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"name"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"parent"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"age"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"1"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"inheritsWithDifferentClass"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.DerivedTestObject, Spring.Core.Tests"</span>
  <span style="color: #FF0000">parent</span>=<span style="color: #0000FF">"inheritedTestObject"</span> <span style="color: #FF0000">init-method</span>=<span style="color: #0000FF">"Initialize"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"name"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"override"</span><span style="color: #A31515">/&gt;</span>
  <i style="color: #008000">&lt;!-- age will inherit value of 1 from parent --&gt;</i>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

    <p>A child object definition uses the object class from the parent
    definition if none is specified, but can also override it. In the latter
    case, the child object class must be compatible with the parent, that is,
    it must accept the parent's property values.</p>

    <p>A child object definition inherits constructor argument values,
    property values and method overrides from the parent, with the option to
    add new values. Any initialization method, destroy method and/or static
    factory methods that you specify will override the corresponding parent
    settings.</p>

    <p>The remaining settings are always be taken from the child
    definition: <code class="literal">depends on</code>, <code class="literal">autowire
    mode</code>, <code class="literal">dependency check</code>,
    <code class="literal">singleton</code>, <code class="literal">lazy init</code>.</p>

    <p>The preceding example explicitly marks the parent object definition
    as abstract using the <code class="literal">abstract</code> attribute. If the parent
    definition does not specify a class, explicitly marking the parent object
    definition as abstract is required, as follows:</p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"inheritedTestObjectWithoutClass"</span> <span style="color: #FF0000">abstract</span>=<span style="color: #0000FF">"true"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"name"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"parent"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"age"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"1"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"inheritsWithClass"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.DerivedTestObject, Spring.Core.Tests"</span>
  <span style="color: #FF0000">parent</span>=<span style="color: #0000FF">"inheritedTestObjectWithoutClass"</span> <span style="color: #FF0000">init-method</span>=<span style="color: #0000FF">"Initialize"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"name"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"override"</span><span style="color: #A31515">/&gt;</span>
  <i style="color: #008000">&lt;!-- age will inherit value of 1 from parent --&gt;</i>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

    <p>The parent object cannot be instantiated on its own since it
    incomplete, and it is also explicitly marked as abstract. When a
    definition is abstract like this, it is usable only as a pure template
    object definition that serves as a parent definition for child
    definitions. Trying to use such an abstract parent object on its own, by
    referring to it as a ref property of another object, or doing an explicit
    <code class="methodname">GetObject()</code> with the parent object id, returns an
    error. The container's internal
    <code class="methodname">PreInstantiateSingletons</code> method will completely
    ignore object definitions that are considered abstract.</p>

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
      <p>Application contexts pre-instantiate all singletons by default.
      Therefore it is important (at least for singleton objects) that if you
      have a (parent) object definition which you intend to use only as a
      template, and this definition specifies a class, you must make sure to
      set the <span class="emphasis"><em>abstract</em></span> attribute to
      <span class="emphasis"><em>true</em></span> , otherwise the application context will
      actually (attempt to) pre-instantiate the abstract object.</p>
    </td></tr></table></div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-factory-extension"></a>5.8.&nbsp;Container extension points</h2></div></div></div>
    

    <p>The Spring container is essentially nothing more than an advanced
    factory capable of maintaining a registry of different</p>

    <p>objects and their dependencies. The
    <code class="literal">IObjectFactory</code> enables you to read object definitions
    and access them using the object factory. When using just the
    <code class="literal">IObjectFactory</code> you would create an instance of one and
    then read in some object definitions in the XML format as follows:
    </p><pre class="programlisting">[C#]
IResource input = <span style="color: #0000FF">new</span> FileSystemResource (<span style="color: #000000">"objects.xml"</span>);
XmlObjectFactory factory = <span style="color: #0000FF">new</span> XmlObjectFactory(input);</pre>

    <p>That is pretty much it. Using <code class="literal">GetObject(string)</code>
    (or the more concise indexer method <code class="literal">factory ["string"]</code>)
    you can retrieve instances of your objects... </p><pre class="programlisting">[C#]
<span style="color: #0000FF">object</span> foo = factory.GetObject (<span style="color: #000000">"foo"</span>); <i style="color: #008000">// gets the object defined as 'foo'</i>
<span style="color: #0000FF">object</span> bar = factory [<span style="color: #000000">"bar"</span>];           <i style="color: #008000">// same thing, just using the indexer</i>
</pre>

    <p>You'll get a reference to the same object if you defined it as a
    singleton (the default) or you'll get a new instance each time if you set
    the <code class="literal">singleton</code> property of your object definition to
    <span class="emphasis"><em>false</em></span>. </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"exampleObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject, ExamplesLibrary"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"anotherObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Examples.ExampleObject, ExamplesLibrary"</span> <span style="color: #FF0000">singleton</span>=<span style="color: #0000FF">"false"</span><span style="color: #A31515">/&gt;</span></pre><p>
    </p><pre class="programlisting">[C#]
<span style="color: #0000FF">object</span> one = factory [<span style="color: #000000">"exampleObject"</span>];   <i style="color: #008000">// gets the object defined as 'exampleObject'</i>
<span style="color: #0000FF">object</span> two = factory [<span style="color: #000000">"exampleObject"</span>];
Console.WriteLine (one == two)            <i style="color: #008000">// prints 'true'</i>
<span style="color: #0000FF">object</span> three = factory [<span style="color: #000000">"anotherObject"</span>]; <i style="color: #008000">// gets the object defined as 'anotherObject'</i>
<span style="color: #0000FF">object</span> four = factory [<span style="color: #000000">"anotherObject"</span>];
Console.WriteLine (three == four);        <i style="color: #008000">// prints 'false'</i>
</pre>

    <p>The client-side view of the <code class="literal">IObjectFactory</code> is
    surprisingly simple. The <code class="literal">IObjectFactory</code> interface has
    only seven methods (and the aforementioned indexer) for clients to call:
    </p><div class="itemizedlist"><ul type="disc" compact><li>
          <p><code class="literal">bool ContainsObject(string)</code>: returns true
          if the <code class="literal">IObjectFactory</code> contains an object
          definition that matches the given name.</p>
        </li><li>
          <p><code class="literal">object GetObject(string)</code>: returns an
          instance of the object registered under the given name. Depending on
          how the object was configured by the
          <code class="literal">IObjectFactory</code> configuration, either a singleton
          (and thus shared) instance or a newly created object will be
          returned. An <code class="literal">ObjectsException</code> will be thrown when
          either the object could not be found (in which case it'll be a
          <code class="literal">NoSuchObjectDefinitionException</code>), or an exception
          occurred while instantiated and preparing the object.</p>
        </li><li>
          <p><code class="literal">Object this [string]</code>: this is the indexer
          for the <code class="literal">IObjectFactory</code> interface. It functions in
          all other respects in exactly the same way as the
          <code class="literal">GetObject(string)</code> method. The rest of this
          documentation will always refer to the
          <code class="literal">GetObject(string)</code> method, but be aware that you
          can use the indexer anywhere that you can use the
          <code class="literal">GetObject(string)</code> method.</p>
        </li><li>
          <p><code class="literal">Object GetObject(string, Type)</code>: returns an
          object, registered under the given name. The object returned will be
          cast to the given <code class="literal">Type</code>. If the object could not
          be cast, corresponding exceptions will be thrown
          (<code class="literal">ObjectNotOfRequiredTypeException</code>). Furthermore,
          all rules of the <code class="literal">GetObject(string)</code> method apply
          (see above).</p>
        </li><li>
          <p><code class="literal">bool IsSingleton(string)</code>: determines
          whether or not the object definition registered under the given name
          is a singleton or a prototype. If the object definition
          corresponding to the given name could not be found, an exception
          will be thrown
          (<code class="literal">NoSuchObjectDefinitionException</code>)</p>
        </li><li>
          <p><code class="literal">string[] GetAliases(string)</code>: returns the
          aliases for the given object name, if any were defined in the
          <code class="literal">IObjectDefinition</code>.</p>
        </li><li>
          <p><code class="literal">void ConfigureObject(object target):</code>
          Injects dependencies into the supplied target instance. The name of
          the abstract object definition is the
          <code class="literal">System.Type.FullName</code> of the target instance. This
          method is typically used when objects are instantiated outside the
          control of a developer, for example when ASP.NET instantiates web
          controls and when a WinForms application creates
          UserControls.</p>
        </li><li>
          <p><code class="literal">void ConfigureObject(object target, string
          name):</code> Offers the same functionality as the previously
          listed Configure method but uses a named object definition instead
          of using the type's full name.</p>
        </li></ul></div>

    <p>A sub-interface of <code class="literal">IObjectFactory</code>,
    <code class="literal">IConfigurableObjectFactory</code> adds some convenient methods
    such as</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p><code class="literal">void RegisterSingleton(string name, object
        objectInstance)</code> : Register the given existing object as
        singleton in the object factory under the given object name.</p>
      </li><li>
        <p><code class="literal">void RegisterAlias(string name, string
        theAlias)</code>; Given an object name, create an alias.</p>
      </li></ul></div>

    <p>Check the SDK docs for additional details on
    IConfigurableObjectFactory methods and properties and the full
    <code class="literal">IObjectFactory</code> class hierarchy.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1777"></a>5.8.1.&nbsp;Obtaining an <code class="literal">IFactoryObject</code>, not its
      product</h3></div></div></div>
      

      <p>Sometimes there is a need to ask an
      <code class="literal">IObjectFactory</code> for an actual
      <code class="literal">IFactoryObject</code> instance itself, not the object it
      produces. This may be done by prepending the object id with
      <code class="literal">&amp;</code> when calling the
      <code class="methodname">GetObject</code> method of the
      <code class="literal">IObjectFactory</code> and
      <code class="literal">IApplicationContext</code> interfaces. So for a given
      <code class="literal">IFactoryObject</code> with an id
      <code class="literal">myObject</code>, invoking
      <code class="literal">GetObject("myObject")</code> on the
      <code class="literal">IObjectFactory</code> will return the product of the
      <code class="literal">IFactoryObject</code>, but invoking
      <code class="literal">GetObject("&amp;myObject")</code> will return the
      <code class="literal">IFactoryObject</code> instance itself.</p>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e1794"></a>5.9.&nbsp;Container extension points</h2></div></div></div>
    

    <p>The IoC component of the Spring Framework has been designed for
    extension. There is typically no need for an application developer to
    subclass any of the various <code class="literal">IObjectFactory</code> or
    <code class="literal">IApplicationContext</code> implementation classes. The Spring
    IoC container can be infinitely extended by plugging in implementations of
    special integration interfaces. The next few sections are devoted to
    detailing all of these various integration interfaces.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-customizing"></a>5.9.1.&nbsp;Customizing objects with
      <code class="literal">IObjectPostProcessors</code></h3></div></div></div>
      

      <p>The first extension point that we will look at is the
      <code class="literal">Spring.Objects.Factory.Config.IObjectPostProcessor</code>
      interface. This interface defines a number of callback methods that you
      as an application developer can implement in order to provide your own
      (or override the containers default) instantiation logic,
      dependency-resolution logic, and so forth. If you want to do some custom
      logic after the Spring container has finished instantiating, configuring
      and otherwise initializing an object, you can plug in one or more
      <code class="literal">IObjectPostProcessor</code> implementations.</p>

      <p>You can configure multiple
      <code class="literal">IObjectPostProcessors</code> if you wish. You can control
      the order in which these <code class="literal">IObjectPostProcessor</code> execute
      by setting the 'Order' property (you can only set this property if the
      <code class="literal">IObjectPostProcessor</code> implements the
      <code class="literal">IOrdered</code> interface; if you write your own
      <code class="literal">IObjectPostProcessor</code> you should consider implementing
      the <code class="literal">IOrdered</code> interface too); consult the SDK docs for
      the <code class="literal">IObjectPostProcessor</code> and
      <code class="literal">IOrdered</code> interfaces for more details.</p>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p><code class="literal">IObjectPostProcessor</code> operate on object
        instances; that is to say, the Spring IoC container will have
        instantiated a object instance for you, and then
        <code class="literal">IObjectPostProcessors</code> get a chance to do their
        stuff. If you want to change the actual object definition (that is the
        recipe that defines the object), then you rather need to use a
        <code class="literal">IObjectFactoryPostProcessor</code> (described below in the
        section entitled <a class="link" href="objects.html#objects-factory-customizing-factory-postprocessors" title="5.9.2.&nbsp;Customizing configuration metadata with ObjectFactoryPostProcessors">Customizing
        configuration metadata with
        IObjectFactoryPostProcessors.</a></p>

        <p>Also, <code class="literal">IObjectPostProcessors</code> are scoped
        per-container. This is only relevant if you are using container
        hierarchies. If you define a <code class="literal">IObjectPostProcessor</code>
        in one container, it will only do its stuff on the objects in that
        container. Objects that are defined in another container will not be
        post-processed by <code class="literal">IObjectPostProcessors</code> in another
        container, even if both containers are part of the same
        hierarchy.</p>
      </td></tr></table></div>

      <p>The
      <code class="literal">Spring.Objects.Factory.Config.IObjectPostProcessor</code>
      interface, which consists of two callback methods shown below.
      </p><pre class="programlisting"><span style="color: #0000FF">object</span> PostProcessBeforeInitialization(<span style="color: #0000FF">object</span> instance, <span style="color: #0000FF">string</span> name);

<span style="color: #0000FF">object</span> PostProcessAfterInitialization(<span style="color: #0000FF">object</span> instance, <span style="color: #0000FF">string</span> name);</pre><p>When
      such a class is registered as a post-processor with the container, for
      each object instance that is created by the container,(see below for how
      this registration is effected), for each object instance that is created
      by the container, the post-processor will get a callback from the
      container both <span class="emphasis"><em>before</em></span> any initialization methods
      (such as the <code class="methodname">AfterPropertiesSet</code> method of the
      <code class="literal">IInitializingObject</code> interface and any declared init
      method) are called, and also afterwards. The post-processor is free to
      do what it wishes with the object, including ignoring the callback
      completely. An object post-processor will typically check for marker
      interfaces, or do something such as wrap an object with a proxy. Some
      Spring.NET AOP infrastructure classes are implemented as object
      post-processors as they do this proxy-wrapping logic.</p>

      <p>Other extensions to the <code class="literal">IObjectPostProcessors</code>
      interface are <code class="literal">IInstantiationAwareObjectPostProcessor</code>
      and <code class="literal">IDestructionAwareObjectPostProcessor</code> defined
      below </p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">interface</span> IInstantiationAwareObjectPostProcessor : IObjectPostProcessor
{
     <span style="color: #0000FF">object</span> PostProcessBeforeInstantiation(Type objectType, <span style="color: #0000FF">string</span> objectName);

     <span style="color: #0000FF">bool</span> PostProcessAfterInstantiation(<span style="color: #0000FF">object</span> objectInstance, <span style="color: #0000FF">string</span> objectName);

     IPropertyValues PostProcessPropertyValues(IPropertyValues pvs, PropertyInfo[] pis, <span style="color: #0000FF">object</span> objectInstance, <span style="color: #0000FF">string</span> objectName);
}

<span style="color: #0000FF">public</span> <span style="color: #0000FF">interface</span> IDestructionAwareObjectPostProcessor : IObjectPostProcessor
{
     <span style="color: #0000FF">void</span> PostProcessBeforeDestruction (<span style="color: #0000FF">object</span> instance, <span style="color: #0000FF">string</span> name);
}</pre><p> The <code class="literal">PostProcessBeforeInstantiation</code>
      callback method is called right before the container creates the object.
      If the object returned by this method is not null then the default
      instantiation behavior of the container is short circuited. The returned
      object is the one registered with the container and no other
      <code class="literal">IObjectPostProcessor</code> callbacks will be invoked on it.
      This mechanism is useful if you would like to expose a proxy to the
      object instead of the actual target object. The
      <code class="literal">PostProcessAfterInstantiation</code> callback method is
      called after the object has been instantiated but before Spring performs
      property population based on explicit properties or autowiring. A return
      value of false would short circuit the standard Spring based property
      population. The callback method
      <code class="literal">PostProcessPropertyValues</code> is called after Spring
      collects all the property values to apply to the object, but before they
      are applied. This gives you the opportunity to perform additional
      processing such as making sure that a property is set to a value if it
      contains a <code class="literal">[Required]</code> attribute or to perform
      attribute based wiring, i.e. adding the attribute
      <code class="literal">[Inject("objectName")]</code> on a property. Both of these
      features are scheduled to be included in Spring .12.</p>

      <p>The <code class="literal">IDestructionAwareObjectPostProcessor</code>
      callback contains a single method,
      <code class="literal">PostProcessBeforeDestruction</code>, which is called before
      a singleton's destroy method is invoked.</p>

      <p>It is important to know that the <code class="literal">IObjectFactory</code>
      treats object post-processors slightly differently than the
      <code class="literal">IApplicationContext</code>. An
      <code class="literal">IApplicationContext</code> will automatically detect any
      objects which are deployed into it that implement the
      <code class="literal">IObjectPostProcessor</code> interface, and register them as
      post-processors, to be then called appropriately by the factory on
      object creation. Nothing else needs to be done other than deploying the
      post-processor in a similar fashion to any other object. On the other
      hand, when using plain <code class="literal">IObjectFactories</code>, object
      post-processors have to manually be explicitly registered, with a code
      sequence such as... </p><pre class="programlisting">ConfigurableObjectFactory factory = <span style="color: #0000FF">new</span> .....; <i style="color: #008000">// create an IObjectFactory</i>
... <i style="color: #008000">// now register some objects</i>
<i style="color: #008000">// now register any needed IObjectPostProcessors</i>
MyObjectPostProcessor pp = <span style="color: #0000FF">new</span> MyObjectPostProcessor();
factory.AddObjectPostProcessor(pp);
<i style="color: #008000">// now start using the factory</i>
...</pre>

      <p>This explicit registration step is not convenient, and this is one
      of the reasons why the various <code class="literal">IApplicationContext</code>
      implementations are preferred above plain
      <code class="literal">IObjectFactory</code> implementations in the vast majority
      of Spring-backed applications, especially when using
      IObjectPostProcessors.</p>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p>IObjectPostProcessors and AOP auto-proxying</p>

        <p>Classes that implement the
        <code class="literal">IObjectPostProcessor</code> interface are special, and so
        they are treated differently by the container. All
        <code class="literal">IObjectPostProcessors</code> and their directly referenced
        object will be instantiated on startup, as part of the special startup
        phase of the IApplicationContext, then all those
        <code class="literal">IObjectPostProcessors</code> will be registered in a
        sorted fashion - and applied to all further objects. Since AOP
        auto-proxying is implemented as a
        <code class="literal">IObjectPostProcessor</code> itself, no
        <code class="literal">IObjectPostProcessors</code> or directly referenced
        objects are eligible for auto-proxying (and thus will not have aspects
        'woven' into them). For any such object, you should see an info log
        message: &#8220;Object 'foo' is not eligible for getting processed by all
        <code class="literal">IObjectPostProcessors</code> (for example: not eligible
        for auto-proxying)&#8221;.</p>
      </td></tr></table></div>

      <p></p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="object-factory-extension-opp-examples-hw"></a>5.9.1.1.&nbsp;Example: Hello World, IObjectPostProcessor-style</h4></div></div></div>
        

        <p>This first example is hardly compelling, but serves to
        illustrate basic usage. All we are going to do is code a custom
        IObjectPostProcessor implementation that simply invokes the ToString()
        method of each object as it is created by the container and prints the
        resulting string to the system console. Yes, it is not hugely useful,
        but serves to get the basic concepts across before we move into the
        second example which is actually useful. The basis of the example is
        the MovieFinder quickstart that is included with the Spring.NET
        distribution.</p>

        <p>Find below the custom IObjectPostProcessor implementation class
        definition</p>

        <pre class="programlisting"><span style="color: #0000FF">using</span> System;
<span style="color: #0000FF">using</span> Spring.Objects.Factory.Config;

<span style="color: #0000FF">namespace</span> Spring.IocQuickStart.MovieFinder
{
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> TracingObjectPostProcessor : IObjectPostProcessor
    {
        <span style="color: #0000FF">public</span> <span style="color: #0000FF">object</span> PostProcessBeforeInitialization(<span style="color: #0000FF">object</span> instance, <span style="color: #0000FF">string</span> name)
        {
            <span style="color: #0000FF">return</span> instance;
        }

        <span style="color: #0000FF">public</span> <span style="color: #0000FF">object</span> PostProcessAfterInitialization(<span style="color: #0000FF">object</span> instance, <span style="color: #0000FF">string</span> name)
        {
            Console.WriteLine(<span style="color: #000000">"Object '"</span> + name + <span style="color: #000000">"' created : "</span> + instance.ToString());
            <span style="color: #0000FF">return</span> instance;
        }
    }
}</pre><p>And the following configuration</p>

        <pre class="programlisting">&lt;?xml version="1.0" encoding="utf-8" ?&gt;
<span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515"> &gt;</span>
  <span style="color: #A31515">&lt;description&gt;</span>An example that demonstrates simple IoC features.<span style="color: #A31515">&lt;/description&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"MyMovieLister"</span> 
          <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.IocQuickStart.MovieFinder.MovieLister, Spring.IocQuickStart.MovieFinder"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"movieFinder"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"MyMovieFinder"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/object&gt;</span>

  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"MyMovieFinder"</span> 
          <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.IocQuickStart.MovieFinder.SimpleMovieFinder, Spring.IocQuickStart.MovieFinder"</span><span style="color: #A31515">/&gt;</span>

  <i style="color: #008000">&lt;!-- when the above objects are instantiated, this custom IObjectPostProcessor implementation 
       will output the fact to the system console --&gt;</i>
  <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.IocQuickStart.MovieFinder.TracingObjectPostProcessor, Spring.IocQuickStart.MovieFinder"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/objects&gt;</span></pre>

        <p>Notice how the TracingObjectPostProcessor is simply defined; it
        doesn't even have a name, and because it is a object it can be
        dependency injected just like any other object.</p>

        <p>Find below a small driver script to exercise the above code and
        configuration;</p>

        <pre class="programlisting">IApplicationContext ctx =
        <span style="color: #0000FF">new</span> XmlApplicationContext(
            <span style="color: #000000">"assembly://Spring.IocQuickStart.MovieFinder/Spring.IocQuickStart.MovieFinder/AppContext.xml"</span>);

MovieLister lister = (MovieLister) ctx.GetObject(<span style="color: #000000">"MyMovieLister"</span>);
Movie[] movies = lister.MoviesDirectedBy(<span style="color: #000000">"Roberto Benigni"</span>);
LOG.Debug(<span style="color: #000000">"Searching for movie..."</span>);
<span style="color: #0000FF">foreach</span> (Movie movie <span style="color: #0000FF">in</span> movies)
{
  LOG.Debug(<span style="color: #0000FF">string</span>.Format(<span style="color: #000000">"Movie Title = '{0}', Director = '{1}'."</span>, movie.Title, movie.Director));
}
LOG.Debug(<span style="color: #000000">"MovieApp Done."</span>);</pre><p>The output of executing the above
        program will be:</p>

        <pre class="programlisting">INFO  - Object 'Spring.IocQuickStart.MovieFinder.TracingObjectPostProcessor' is not eligible for being processed by all IObjectPostProcessors 
       (for example: not eligible for auto-proxying).
Object 'MyMovieFinder' created : Spring.IocQuickStart.MovieFinder.SimpleMovieFinder
Object 'MyMovieLister' created : Spring.IocQuickStart.MovieFinder.MovieLister
DEBUG - Searching for movie...
DEBUG - Movie Title = 'La vita e bella', Director = 'Roberto Benigni'.
DEBUG - MovieApp Done.</pre>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="object-factory-extension-opp-examplesrapp"></a>5.9.1.2.&nbsp;Example: the RequiredAttributeObjectPostProcessor</h4></div></div></div>
        

        <p>Using callback interfaces or annotations in conjunction with a
        custom IObjectPostProcessor implementation is a common means of
        extending the Spring IoC container. The <code class="literal">[Required]</code>
        attribute in the <code class="literal">Spring.Objects.Factory.Attributes</code>
        namespace can be used to <span class="emphasis"><em>mark</em></span> a property as
        being<span class="emphasis"><em> 'required-to-be-set' </em></span>(i.e. an setter
        property with this attribute applied must be configured to be
        dependency injected with a value), else an
        <code class="literal">ObjectInitializationException</code> will be thrown by the
        container at runtime.</p>

        <p>The best way to illustrate the usage of this attribute is with
        an example.</p>

        <pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> MovieLister
{
  <i style="color: #008000">// the MovieLister has a dependency on the MovieFinder</i>
  <span style="color: #0000FF">private</span> IMovieFinder _movieFinder;

  <i style="color: #008000">// a setter property so that the Spring container can 'inject' a MovieFinder</i>
  [Required]
  <span style="color: #0000FF">public</span> IMovieFinder MovieFinder
  {
    <span style="color: #0000FF">set</span> { _movieFinder = <span style="color: #0000FF">value</span>; }  
  }

  <i style="color: #008000">// business logic that actually 'uses' the injected MovieFinder is omitted...</i>

}</pre>

        <p>Hopefully the above class definition reads easy on the eye. Any
        and all <code class="literal">IObjectDefinitions</code> for the
        <code class="literal">MovieLister</code> class must be provided with a
        value.</p>

        <p>Let's look at an example of some XML configuraiton that will not
        pass validation.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"MyMovieLister"</span> 
          <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.IocQuickStart.MovieFinder.MovieLister, Spring.IocQuickStart.MovieFinder"</span><span style="color: #A31515">&gt;</span>
      <i style="color: #008000">&lt;!-- whoops, no MovieFinder is set (and this property is [Required]) --&gt;</i>
  <span style="color: #A31515">&lt;/object&gt;</span></pre>

        <p>At runtime the following message will be generated by the Spring
        container</p>

        <pre class="programlisting">Error creating context 'spring.root': Property 'MovieFinder' required for object 'MyMovieLister'</pre>

        <p>There is one last little piece of Spring configuration that is
        required to actually 'switch on' this behavior. Simply annotating the
        'setter' properties of your classes is not enough to get this
        behavior. You need to enable a component that is aware of the
        <code class="literal">[Required]</code> attribute and that can process it
        appropriately.</p>

        <p>This component is the
        <code class="literal">RequiredAttributeObjectPostProcessor</code> class. This is
        a special <code class="literal">IObjectPostProcessor</code> implementation that
        is <code class="literal">[Required]</code>-aware and actually provides the 'blow
        up if this required property has not been set' logic. It is very easy
        to configure; simply drop the following object definition into your
        Spring XML configuration.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Attributes.RequiredAttributeObjectPostProcessor, Spring.Core"</span><span style="color: #A31515">/&gt;</span></pre>

        <p>Finally, one can configure an instance of the
        <code class="literal">RequiredAttributeObjectPostProcessor</code> class to look
        for another <code class="literal">Attribute</code> type. This is great if you
        already have your own <code class="literal">[Required]</code>-style attribute.
        Simply plug it into the definition of a
        <code class="literal">RequiredAttributeObjectPostProcessor</code> and you are
        good to go. By way of an example, let's suppose you (or your
        organization / team) have defined an attribute called [Mandatory]. You
        can make a <code class="literal">RequiredAttributeObjectPostProcessor</code>
        instance <code class="literal">[Mandatory]</code>-aware like so:</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Attributes.RequiredAttributeObjectPostProcessor, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"RequiredAttributeType"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"MyApp.Attributes.MandatoryAttribute, MyApp"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-customizing-factory-postprocessors"></a>5.9.2.&nbsp;Customizing configuration metadata with
      ObjectFactoryPostProcessors</h3></div></div></div>
      

      <p>The next extension point that we will look at is the
      <code class="literal">Spring.Objects.Factory.Config.IObjectFactoryPostProcessor</code>.
      The semantics of this interface are similar to the
      <code class="literal">IObjectPostProcessor</code>, with one major difference.
      <code class="literal">IObjectFactoryPostProcessors</code> operate on; that is to
      say, the Spring IoC container will allow
      <code class="literal">IObjectFactoryPostProcessors</code> to read the
      configuration metadata and potentially change it before the container
      has actually instantiated any other objects. By implementing this
      interface, you will receive a callback after the all the object
      definitions have been loaded into the IoC container but before they have
      been instantiated. The signature of the interface is shown below
      </p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">interface</span> IObjectFactoryPostProcessor 
{
  <span style="color: #0000FF">void</span> PostProcessObjectFactory (IConfigurableListableObjectFactory factory);
}
</pre>

      <p>You can configure multiple
      <code class="literal">IObjectFactoryPostProcessors</code> if you wish. You can
      control the order in which these
      <code class="literal">IObjectFactoryPostProcessors</code> execute by setting the
      'Order' property (you can only set this property if the
      <code class="literal">IObjectFactoryPostProcessors</code> implements the
      <code class="literal">IOrdered</code> interface; if you write your own
      <code class="literal">IObjectFactoryPostProcessors</code> you should consider
      implementing the <code class="literal">IOrdered</code> interface too); consult the
      SDK docs for the <code class="literal">IObjectFactoryPostProcessors</code> and
      <code class="literal">IOrdered</code> interfaces for more details.</p>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p>If you want to change the actual object instances (the objects
        that are created from the configuration metadata), then you rather
        need to use a <code class="literal">IObjectObjectPostProcessor</code> (described
        above in the section entitled <a class="link" href="objects.html#objects-factory-customizing" title="5.9.1.&nbsp;Customizing objects with IObjectPostProcessors">Customizing objects with
        <code class="literal">IObjectPostProcessors</code></a>.</p>

        <p>Also, <code class="literal">IObjectFactoryPostProcessors</code> are scoped
        per-container. This is only relevant if you are using container
        hierarchies. If you define a
        <code class="literal">IObjectFactoryPostProcessors</code> in one container, it
        will only do its stuff on the object definitions in that container.
        Object definitions in another container will not be post-processed by
        <code class="literal">IObjectFactoryPostProcessors</code> in another container,
        even if both containers are part of the same hierarchy.</p>
      </td></tr></table></div>

      <p>An object factory post-processor is executed manually (in the case
      of a IObjectFactory) or automatically (in the case of an
      IApplicationContext) to apply changes of some sort to the configuration
      metadata that defines a container. Spring.NET includes a number of
      pre-existing object factory post-processors, such as
      <code class="literal">PropertyResourceConfigurer</code> and
      <code class="literal">PropertyPlaceHolderConfigurer</code>, both described below
      and ObjectNameAutoProxyCreator, which is very useful for wrapping other
      objects transactionally or with any other kind of proxy, as described
      later in this manual.</p>

      <p>In an <code class="literal">IObjectFactory</code>, the process of applying
      an <code class="literal">IObjectFactoryPostProcessor</code> is manual, and will be
      similar to this:</p>

      <pre class="programlisting">XmlObjectFactory factory = <span style="color: #0000FF">new</span> XmlObjectFactory(<span style="color: #0000FF">new</span> FileSystemResource(<span style="color: #000000">"objects.xml"</span>));
<em class="lineannotation"><span class="lineannotation">// create placeholderconfigurer to bring in some property
// values from a Properties file</span></em>
PropertyPlaceholderConfigurer cfg = <span style="color: #0000FF">new</span> PropertyPlaceholderConfigurer();
cfg.setLocation(<span style="color: #0000FF">new</span> FileSystemResource(<span style="color: #000000">"ado.properties"</span>));
<em class="lineannotation"><span class="lineannotation">// now actually do the replacement</span></em>
cfg.PostProcessObjectFactory(factory);</pre>

      <p><a name="objects-factory-autodetect-objectfactorypostprocessors"></a>This
      explicit registration step is not convenient, and this is one of the
      reasons why the various <code class="literal">IApplicationContext</code>
      implementations are preferred above plain
      <code class="literal">IObjectFactory</code> implementations in the vast majority
      of Spring-backed applications, especially when using
      <code class="literal">IObjectFactoryPostProcessors</code>.</p>

      <p>An <code class="literal">IApplicationContext</code> will detect any objects
      which are deployed into it that implement the
      <code class="literal">ObjectFactoryPostProcessor</code> interface, and
      automatically use them as object factory post-processors, at the
      appropriate time. Nothing else needs to be done other than deploying
      these post-processor in a similar fashion to any other object.</p>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p>Just as in the case of <code class="literal">IObjectPostProcessors</code>,
        you typically don't want to have
        <code class="literal">IObjectFactoryPostProcessors</code> marked as being
        lazily-initialized. If they are marked as such, then the Spring
        container will never instantiate them, and thus they won't get a
        chance to apply their custom logic. If you are using the
        'default-lazy-init' attribute on the declaration of your
        &lt;objects/&gt; element, be sure to mark your various
        <code class="literal">IObjectFactoryPostProcessor</code> object definitions with
        'lazy-init="false"'.</p>
      </td></tr></table></div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-placeholderconfigurer"></a>5.9.2.1.&nbsp;Example: The
        <code class="literal">PropertyPlaceholderConfigurer</code></h4></div></div></div>
        

        <p>The <code class="literal">PropertyPlaceholderConfigurer</code> is an
        excellent solution when you want to externalize a few properties from
        a file containing object definitions. This is useful to allow the
        person deploying an application to customize environment specific
        properties (for example database configuration strings, usernames, and
        passwords), without the complexity or risk of modifying the main XML
        definition file or files for the container.</p>

        <p>Variable substitution is performed on simple property values,
        lists, dictionaries, sets, constructor values, object type name, and
        object names in runtime object references. Furthermore, placeholder
        values can also cross-reference other placeholders.</p>

        <p>Note that <code class="literal">IApplicationContext</code>s are able to
        automatically recognize and apply objects deployed in them that
        implement the <code class="literal">IObjectFactoryPostProcessor</code>
        interface. This means that as described here, applying a
        <code class="literal">PropertyPlaceholderConfigurer</code> is much more
        convenient when using an <code class="literal">IApplicationContext</code>. For
        this reason, it is recommended that users wishing to use this or other
        object factory postprocessors use an
        <code class="literal">IApplicationContext</code> instead of an
        <code class="literal">IObjectFactory</code>.</p>

        <p>In the example below a data access object needs to be configured
        with a database connection and also a value for the maximum number of
        results to return in a query. Instead of hard coding the values into
        the main Spring.NET configuration file we use place holders, in the
        NAnt style of ${variableName}, and obtain their values from
        NameValueSections in the standard .NET application configuration file.
        The Spring.NET configuration file looks like: </p><pre class="programlisting"><span style="color: #A31515">&lt;configuration&gt;</span>

  <span style="color: #A31515">&lt;configSections&gt;</span>
    <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"context"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.ContextHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
    <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"DaoConfiguration"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"System.Configuration.NameValueSectionHandler"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"DatabaseConfiguration"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"System.Configuration.NameValueSectionHandler"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/configSections&gt;</span>

  <span style="color: #A31515">&lt;DaoConfiguration&gt;</span>
    <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"maxResults"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"1000"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/DaoConfiguration&gt;</span>
  
  <span style="color: #A31515">&lt;DatabaseConfiguration&gt;</span>
    <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"connection.string"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"dsn=MyDSN;uid=sa;pwd=myPassword;"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/DatabaseConfiguration&gt;</span>
  
  <span style="color: #A31515">&lt;spring&gt;</span>
    <span style="color: #A31515">&lt;context&gt;</span>
      <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"assembly://DaoApp/DaoApp/objects.xml"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/context&gt;</span>
  <span style="color: #A31515">&lt;/spring&gt;</span>

<span style="color: #A31515">&lt;/configuration&gt;</span></pre>

        <p>Notice the presence of two NameValueSections in the
        configuration file. These name value pairs will be referred to in the
        Spring.NET configuration file. In this example we are using an
        embedded assembly resource for the location of the Spring.NET
        configuration file so as to reduce the chance of accidental tampering
        in deployment. This Spring.NET configuration file is shown
        below.</p>

        <pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span> 
         <span style="color: #FF0000">xmlns:xsi</span>=<span style="color: #0000FF">"http://www.w3.org/2001/XMLSchema-instance"</span> 
         <span style="color: #FF0000">xsi:schemaLocation</span>=<span style="color: #0000FF">"http://www.springframework.net
         http://www.springframework.net/xsd/spring-objects.xsd"</span><span style="color: #A31515"> &gt;</span>
    
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"productDao"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"DaoApp.SimpleProductDao, DaoApp "</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"maxResults"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"${maxResults}"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"dbConnection"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"myConnection"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>
    
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myConnection"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"System.Data.Odbc.OdbcConnection, System.Data"</span><span style="color: #A31515">&gt;</span> 
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"connectionstring"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"${connection.string}"</span><span style="color: #A31515">/&gt;</span> 
    <span style="color: #A31515">&lt;/object&gt;</span>

    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"appConfigPropertyHolder"</span> 
            <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.PropertyPlaceholderConfigurer, Spring.Core"</span><span style="color: #A31515">&gt;</span>

        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"configSections"</span><span style="color: #A31515">&gt;</span>          
          <span style="color: #A31515">&lt;value&gt;</span>DaoConfiguration,DatabaseConfiguration<span style="color: #A31515">&lt;/value&gt;</span>                              
        <span style="color: #A31515">&lt;/property&gt;</span>              
       
    <span style="color: #A31515">&lt;/object&gt;</span>
<span style="color: #A31515">&lt;/objects&gt;</span></pre>

        <p>The values of <code class="literal">${maxResults}</code> and
        <code class="literal">${connection.string}</code> match the key names used in
        the two NameValueSectionHandlers <code class="literal">DaoConfiguration</code>
        and <code class="literal">DatabaseConfiguration</code>. The
        <code class="literal">PropertyPlaceholderConfigurer</code> refers to these two
        sections via a comma delimited list of section names in the
        <code class="literal">configSections</code> property. If you are using section
        groups, prefix the section group name, for example
        myConfigSection/DaoConfiguraiton.</p>

        <p>The <code class="literal">PropertyPlaceholderConfigurer</code> class also
        supports retrieving name value pairs from other
        <code class="literal">IResource</code> locations. These can be specified using
        the <code class="literal">Location</code> and <code class="literal">Locations</code>
        properties of the <code class="literal">PropertyPlaceHolderConfigurer</code>
        class.</p>

        <p>If there are properties with the same name in different resource
        locations the default behavior is that the last property processed
        overrides the previous values. This is behavior is controlled by the
        <code class="literal">LastLocationOverrides</code> property. True enables
        overriding while false will append the values as one would normally
        expect using <code class="literal">NameValueCollection.Add</code>.</p>

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
          <p>In an ASP.NET environment you must specify the full, four-part
          name of the assembly when using a
          <code class="literal">NameValueFileSectionHandler</code> </p><pre class="programlisting">
            <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"hibernateConfiguration"</span>
            <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"System.Configuration.NameValueFileSectionHandler, System,
            Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"</span><span style="color: #A31515">/&gt;</span>
          </pre>
        </td></tr></table></div>

        <div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d4e1994"></a>5.9.2.1.1.&nbsp;Type, Ref, and Expression substitution</h5></div></div></div>
          

          <p>The PropertyPlaceholderConfigurer can be used to substitute
          type names, which is sometimes useful when you have to pick a
          particular implementation class at runtime. For example:</p>

          <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"MyMovieFinder"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"${custom.moviefinder.type}"</span><span style="color: #A31515">/&gt;</span></pre>

          <p>If the class is unable to be resolved at runtime to a valid
          type, resolution of the object will fail once it is about to be
          created (which is during the PreInstantiateSingletons() phase of an
          ApplicationContext for a non-lazy-init object.)</p>

          <p>Similarly you can replace 'ref' and 'expression' metadata, as
          shown below</p>

          <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"TestObject"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Simple.TestObject, MyAssembly"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"age"</span> <span style="color: #FF0000">expression</span>=<span style="color: #0000FF">"${ageExpression}"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spouse"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"${spouse-ref}"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
        </div>

        <div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="objects-factory-placeholderconfigurer-envvars"></a>5.9.2.1.2.&nbsp;Replacement with Environment Variables</h5></div></div></div>
          

          <p>You may also use the value environment variables to replace
          property placeholders. The use of environment variables is
          controlled via the property
          <code class="literal">EnvironmentVariableMode</code>. This property is an
          enumeration of the type <code class="literal">EnvironmentVariablesMode</code>
          and has three values, Never, Fallback, and Override.
          <code class="literal">Fallback</code> is the default value and will resolve a
          property placeholder if it was not already done so via a value from
          a resource location. <code class="literal">Override</code> will apply
          environment variables before applying values defined from a resource
          location. <code class="literal">Never</code> will, quite appropriately,
          disable environment variable substitution. An example of how the
          <code class="literal">PropertyPlaceholderConfigurer</code> XML is modified to
          enable override usage is shown below </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"appConfigPropertyHolder"</span> 
        <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.PropertyPlaceholderConfigurer, Spring.Core"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"configSections"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"DaoConfiguration,DatabaseConfiguration"</span><span style="color: #A31515">/&gt;</span>
        <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"EnvironmentVariableMode"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Override"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>
<span style="color: #A31515">&lt;/objects&gt;</span></pre>
        </div>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-factory-overrideconfigurer"></a>5.9.2.2.&nbsp;Example: The
        <code class="literal">PropertyOverrideConfigurer</code></h4></div></div></div>
        

        <p>The <code class="literal">PropertyOverrideConfigurer</code>, another
        object factory post-processor, is similar to the
        <code class="literal">PropertyPlaceholderConfigurer</code>, but in contrast to
        the latter, the original definitions can have default values or no
        values at all for object properties. If an overriding configuration
        file does not have an entry for a certain object property, the default
        context definition is used.</p>

        <p>Note that the object factory definition is
        <span class="emphasis"><em>not</em></span> aware of being overridden, so it is not
        immediately obvious when looking at the XML definition file that the
        override configurer is being used. In case that there are multiple
        <code class="literal">PropertyOverrideConfigurer</code> instances that define
        different values for the same object property, the last one will win
        (due to the overriding mechanism).</p>

        <p>The example usage is similar to when using
        <code class="literal">PropertyPlaceHolderConfigurer</code> except that the key
        name refers to the name given to the object in the Spring.NET
        configuration file and is suffixed via 'dot' notation with the name of
        the property For example, if the application configuration file is
        </p><pre class="programlisting"><span style="color: #A31515">&lt;configuration&gt;</span>
  <span style="color: #A31515">&lt;configSections&gt;</span>
    <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"context"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.ContextHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
    <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"DaoConfigurationOverride"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"System.Configuration.NameValueSectionHandler"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/configSections&gt;</span>

  <span style="color: #A31515">&lt;DaoConfigurationOverride&gt;</span>
    <span style="color: #A31515">&lt;add</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"productDao.maxResults"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"1000"</span><span style="color: #A31515">/&gt;</span>
  <span style="color: #A31515">&lt;/DaoConfigurationOverride&gt;</span>
  
  <span style="color: #A31515">&lt;spring&gt;</span>
    <span style="color: #A31515">&lt;context&gt;</span>
      <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"assembly://DaoApp/DaoApp/objects.xml"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/context&gt;</span>
  <span style="color: #A31515">&lt;/spring&gt;</span>

<span style="color: #A31515">&lt;/configuration&gt;</span></pre><p> Then the value of 1000 will be used to
        overlay the value of 2000 set in the Spring.NET configuration file
        shown below </p><pre class="programlisting"><span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span> 
        <span style="color: #FF0000">xmlns:xsi</span>=<span style="color: #0000FF">"http://www.w3.org/2001/XMLSchema-instance"</span> 
        <span style="color: #FF0000">xsi:schemaLocation</span>=<span style="color: #0000FF">"http://www.springframework.net http://www.springframework.net/xsd/spring-objects.xsd"</span><span style="color: #A31515"> &gt;</span>

    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"productDao"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"PropPlayApp.SimpleProductDao, PropPlayApp "</span><span style="color: #A31515"> &gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"maxResults"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"2000"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"dbConnection"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"myConnection"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"log"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"daoLog"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>
    
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"daoLog"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.LogFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"logName"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"DAOLogger"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/object&gt;</span>
    
    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myConnection"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"System.Data.Odbc.OdbcConnection, System.Data"</span><span style="color: #A31515">&gt;</span> 
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"connectionstring"</span><span style="color: #A31515">&gt;</span> 
        <span style="color: #A31515">&lt;value&gt;</span>dsn=MyDSN;uid=sa;pwd=myPassword;<span style="color: #A31515">&lt;/value&gt;</span>
      <span style="color: #A31515">&lt;/property&gt;</span> 
    <span style="color: #A31515">&lt;/object&gt;</span> 

    <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"appConfigPropertyOverride"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.PropertyOverrideConfigurer, Spring.Core"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"configSections"</span><span style="color: #A31515">&gt;</span>          
        <span style="color: #A31515">&lt;value&gt;</span>DaoConfigurationOverride<span style="color: #A31515">&lt;/value&gt;</span>                              
      <span style="color: #A31515">&lt;/property&gt;</span> 
    <span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;/objects&gt;</span></pre>
      </div>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="objects-variablesource"></a>5.9.2.3.&nbsp;IVariableSource</h4></div></div></div>
        

        <p>The IVariableSource is the base interface for providing the
        ability to get the value of property placeholders (name-value) pairs
        from a variety of sources. Out of the box, Spring.NET supports a
        number of variable sources that allow users to obtain variable values
        from .NET config files, java-style property files, environment
        variables, command line arguments and the registry and the new
        connection strings configuration section in .NET 2.0. The list of
        implementing classes is listed below. Please refer to the SDK
        documentation for more information.</p>

        <div class="itemizedlist"><ul type="disc"><li>
            <p><code class="literal">ConfigSectionVariableSource</code></p>
          </li><li>
            <p><code class="literal">PropertyFileVariableSource</code></p>
          </li><li>
            <p><code class="literal">EnvironmentVariableSource</code></p>
          </li><li>
            <p><code class="literal">CommandLineArgsVariableSource</code></p>
          </li><li>
            <p><code class="literal">RegistryVariableSource</code></p>
          </li><li>
            <p><code class="literal">SpecialFolderVariableSource</code></p>
          </li><li>
            <p><code class="literal">ConnectionStringsVariableSource</code></p>
          </li></ul></div>

        <p>You use this by defining an instance of
        <code class="literal">Spring.Objects.Factory.Config.VariablePlaceholderConfigurer</code>
        in your configuration and set the property
        <code class="literal">VariableSource</code> to a single
        <code class="literal">IVariableSource</code> instance or the list property
        <code class="literal">VariableSources</code> to a list of
        <code class="literal">IVariableSource</code> instances. In the case of the same
        property defined in multiple <code class="literal">IVariableSource</code>
        implementations, the first one in the list that contains the property
        value will be used. </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.VariablePlaceholderConfigurer, Spring.Core"</span><span style="color: #A31515">&gt;</span>
   <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"VariableSources"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;list&gt;</span>
         <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.ConfigSectionVariableSource, Spring.Core"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"SectionNames"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"CryptedConfiguration"</span><span style="color: #A31515"> /&gt;</span>
         <span style="color: #A31515">&lt;/object&gt;</span>
      <span style="color: #A31515">&lt;/list&gt;</span>
   <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>
        </pre><p>The IVariableSource interface is shown below</p>

        <pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">interface</span> IVariableSource
{
  <span style="color: #0000FF">string</span> ResolveVariable(<span style="color: #0000FF">string</span> name);
}</pre>

        <p>This is a simple contract to implement if you should decide to
        create your own custom implemention. Look at the source code of the
        current implementations for some inspiration if you go that route. To
        register your own custom implemenation, simply configure
        VariablePlaceholderConfigurer to refer to your class.</p>
      </div>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-factory-lifecycle-factoryobject"></a>5.9.3.&nbsp;Customizing instantiation logic using
      <code class="literal">IFactoryObjects</code></h3></div></div></div>
      

      <p>The <code class="literal">Spring.Objects.Factory.IFactoryObject</code>
      interface is to be implemented by objects that <span class="emphasis"><em>are themselves
      factories</em></span>.</p>

      <p>The <code class="literal">IFactoryObject</code> interface is a point of
      pluggability into the Spring IoC containers instantiation logic. If you
      have some complex initialization code that is better expressed in C# as
      opposed to a (potentially) verbose amount of XML, you can create your
      own <code class="literal">IFactoryObject</code>, write the complex initialization
      inside that class, and then plug your custom
      <code class="literal">IFactoryObject</code> into the container.</p>

      <p>The <code class="literal">IFactoryObject</code> interface provides one
      method and two (read-only) properties: </p><div class="itemizedlist"><ul type="disc" compact><li>
            <p><code class="literal">object GetObject()</code>: has to return an
            instance of the object this factory creates. The instance can
            possibly be shared (depending on whether this factory provides
            singletons or prototypes).</p>
          </li><li>
            <p><code class="literal">bool IsSingleton</code>: has to return
            <code class="literal">true</code> if this IFactoryObject returns singletons,
            <code class="literal">false</code> otherwise.</p>
          </li><li>
            <p><code class="literal">Type ObjectType</code>: has to return either the
            object type returned by the <code class="methodname">GetObject()</code>
            method or <code class="literal">null</code> if the type isn't known in
            advance.</p>
          </li></ul></div>

      <p><code class="literal">IFactoryObject</code></p>

      <p>The IFactoryObject concept and interface is used in a number of
      places within the Spring Framework. Some examples of its use is
      described in <a class="xref" href="objects.html#objects-advancedproperty-setting" title="5.3.9.&nbsp;Setting a reference using the members of other objects and classes.">Section&nbsp;5.3.9, &#8220;Setting a reference using the members of other objects and
      classes.&#8221;</a> for the
      <code class="literal">PropertyRetrievingFactoryObject</code> and
      <code class="literal">FieldRetrievingFactoryObject</code>. An additional use of
      creating an custom IFactoryObject implementation is to retrieve an
      object from an embedded resource file and use it to set another objects
      dependency. An example of this is provided <a class="link" href="http://jira.springframework.org/browse/SPRNET-133#action_19743" target="_top">here</a>.</p>

      <p>Finally, there is sometimes a need to ask a container for an
      actual <code class="literal">IFactoryObject</code> instance itself, not the object
      it produces. This may be achieved by prepending the object id with
      '<code class="literal">&amp;</code>' (sans quotes) when calling the
      <code class="literal">GetObject</code> method of the
      <code class="literal">IObjectFactory</code> (including
      <code class="literal">IApplicationContext</code>). So for a given
      <code class="literal">IFactoryObject</code> with an id of
      '<code class="literal">myObject</code>', invoking
      <code class="literal">GetObject("myObject")</code> on the container will return
      the product of the <code class="literal">IFactoryObject</code>, but invoking
      <code class="literal">GetObject("&amp;myObject")</code> will return the
      <code class="literal">IFactoryObject</code> instance itself.</p>

      <div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d4e2104"></a>5.9.3.1.&nbsp;IConfigurableFactoryObject</h4></div></div></div>
        

        <p>The
        <code class="literal">Spring.Objects.Factory.IConfigurableFactoryObject</code>
        interface inherits from <code class="literal">IFactoryObject</code> interface
        and adds the following property.</p><div class="itemizedlist"><ul type="disc" compact><li>
              <p><code class="literal"> IObjectDefinition ProductTemplate </code>:
              Gets the template object definition that should be used to
              configure the instance of the object managed by this
              factory.</p>
            </li></ul></div>

        <p><code class="literal">IConfigurableFactoryObject</code> implementions you
        already have examples of in <a class="xref" href="webservices.html#client-side" title="27.3.&nbsp;Client-side">Section&nbsp;27.3, &#8220;Client-side&#8221;</a> are
        <code class="literal">WebServiceProxyFactory</code>.</p>
      </div>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="context-introduction"></a>5.10.&nbsp;The <code class="literal">IApplicationContext</code></h2></div></div></div>
    

    <p>While the <code class="literal">Spring.Objects</code> namespace provides basic
    functionality for managing and manipulating objects, often in a
    programmatic way, the <code class="literal">Spring.Context</code> namespace
    introduces the <code class="literal">IApplicationContext</code> interface, which
    enhances the functionality provided by the
    <code class="literal">IObjectFactory</code> interface in a more
    <span class="emphasis"><em>framework-oriented style</em></span>. Many users will use
    ApplicationContext in a completely declarative fashion, not even having to
    create it manually, but instead relying on support classes such as the
    .NET configuration section handlers such as ContextHandler and
    WebContextHandler together to declaratively define the ApplicationContext
    and retrieve it though a ContextRegistry. (Of course it is still possible
    to create an <code class="literal">IApplicationContext</code>
    Programatically).</p>

    <p>The basis for the context module is the
    <code class="literal">IApplicationContext</code> interface, located in the
    <code class="literal">Spring.Context</code> namespace. Deriving from the
    <code class="literal">IObjectFactory</code> interface, it provides all the
    functionality of the <code class="literal">IObjectFactory</code>. To be able to work
    in a more framework-oriented fashion, using layering and hierarchical
    contexts, the <code class="literal">Spring.Context</code> namespace also provides
    the following functionality</p><div class="itemizedlist"><ul type="disc" compact><li>
          <p><span class="emphasis"><em>Loading of multiple (hierarchical)
          contexts</em></span>, allowing some of them to be focused and used on
          one particular layer, for example the web layer of an
          application.</p>
        </li><li>
          <p><span class="emphasis"><em>Access to localized resources</em></span> at the
          application level by implementing
          <code class="literal">IMessageSource</code>.</p>
        </li><li>
          <p><span class="emphasis"><em>Uniform access to resources</em></span> that can be
          read in as an InputStream, such as URLs and files by implementing
          <code class="literal">IResourceLoader</code></p>
        </li><li>
          <p><span class="emphasis"><em>Loosely Coupled Event Propagation</em></span>.
          Publishers and subscribers of events do not have to be directly
          aware of each other as they register their interest indirectly
          through the application context.</p>
        </li></ul></div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d4e2148"></a>5.10.1.&nbsp;IObjectFactory or IApplicationContext?</h3></div></div></div>
      

      <p>Short version: use an
      <span class="emphasis"><em><code class="literal">IApplicationContext</code></em></span> unless you
      have a really good reason for not doing so. For those of you that are
      looking for slightly more depth as to the 'but why' of the above
      recommendation, keep reading.</p>

      <p>As the <code class="literal">IApplicationContext</code> includes all the
      functionality the object factory via its inheritance of the
      <code class="literal">IObjectFactory</code> interface, it is generally recommended
      to be used over the <code class="literal">IObjectFactory</code> except for a few
      limited situations where memory consumption might be critical. This may
      become more important if the .NET Compact Framework is supported. The
      history of <code class="literal">IObjectFactory</code> comes from the Spring Java
      framework, where the use of Spring in Applets was a concern to reduce
      memory consumption. However, for most 'typical' enterprise applications
      and systems, the <code class="literal">IApplicationContext</code> is what you will
      want to use. Spring generally makes heavy use of the
      <code class="literal">IObjectPostProcessor</code> extension point (to effect
      proxying and suchlike), and if you are using just a plain
      <code class="literal">IObjectFactory</code> then a fair amount of support such as
      transactions and AOP will not take effect (at least not without some
      extra steps on your part), which could be confusing because nothing will
      actually be wrong with the configuration.</p>

      <p>Find below a feature matrix that lists what features are provided
      by the <code class="literal">IObjectFactory</code> and
      <code class="literal">IApplicationContext</code> interfaces (and attendant
      implementations). The following sections describe functionality that
      <code class="literal">IApplicationContext</code> adds to the basic
      <code class="literal">IObjectFactory</code> capabilities in a lot more depth than
      the said feature matrix.)</p>

      <a name="context-introduction-ctx-vs-objectfactory-feature-matrix"></a>

      <div class="table"><a name="d4e2167"></a><div class="title">Table&nbsp;5.7.&nbsp;Feature Matrix</div><div class="table-contents">
        

        <table summary="Feature Matrix" width="100%" border="1"><colgroup><col align="left"><col><col></colgroup><thead><tr><th align="center">Feature</th><th align="center"><code class="literal">IObjectFactory</code></th><th align="center"><code class="literal">IApplicationContext</code></th></tr></thead><tbody><tr><td align="left"><p>Object instantiation/wiring</p></td><td align="center"><p>Yes</p></td><td align="center"><p>Yes</p></td></tr><tr><td align="left"><p>Automatic <code class="literal">IObjectPostProcessor</code>
              registration</p></td><td align="center"><p>No</p></td><td align="center"><p>Yes</p></td></tr><tr><td align="left"><p>Automatic
              <code class="literal">IObjectFactoryPostProcessor</code>
              registration</p></td><td align="center"><p>No</p></td><td align="center"><p>Yes</p></td></tr><tr><td align="left"><p>Convenient <code class="literal">IMessageSource</code>
              access</p></td><td align="center"><p>No</p></td><td align="center"><p>Yes</p></td></tr><tr><td align="left"><p><code class="literal">ApplicationEvent</code>
              publication</p></td><td align="center"><p>No</p></td><td align="center"><p>Yes</p></td></tr><tr><td align="left">Singleton service locator style access</td><td align="center">No</td><td align="center">Yes</td></tr><tr><td align="left">Declarative registration of custom resource protocol
              handler, XML Parsers for object definitions, and type
              aliases</td><td align="center">No</td><td align="center">Yes</td></tr></tbody></table>
      </div></div><br class="table-break">
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="context-configuration"></a>5.11.&nbsp;Configuration of IApplicationContext</h2></div></div></div>
    

    <p>Well known locations in the .NET application configuration file are
    used to register resource handlers, custom parsers, type alias, and custom
    type converts in addition to the context and objects sections mentioned
    previously. A sample .NET application configuration file showing all these
    features is shown below. Each section requires the use of a custom
    configuration section handler. Note that the types shown for resource
    handlers and parsers are fictional. </p><pre class="programlisting"><span style="color: #A31515">&lt;configuration&gt;</span>

  <span style="color: #A31515">&lt;configSections&gt;</span>
    <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>

      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"context"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.ContextHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objects"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.DefaultSectionHandler, Spring.Core"</span><span style="color: #A31515"> /&gt;</span>
        
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"parsers"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.NamespaceParsersSectionHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span> 
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"resources"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.</span><code class="literal">ResourceHandlersSectionHandler</code>, Spring.Core"/&gt;         
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"typeAliases"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.TypeAliasesSectionHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"typeConverters"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.TypeConvertersSectionHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
        
     <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
  <span style="color: #A31515">&lt;/configSections&gt;</span>

  <span style="color: #A31515">&lt;spring&gt;</span>
    <span style="color: #A31515">&lt;parsers&gt;</span> 
      <span style="color: #A31515">&lt;parser</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Aop.Config.AopNamespaceParser, Spring.Aop"</span><span style="color: #A31515"> /&gt;</span> 
      <span style="color: #A31515">&lt;parser</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Data.Config.DatabaseNamespaceParser, Spring.Data"</span><span style="color: #A31515"> /&gt;</span> 
    <span style="color: #A31515">&lt;/parsers&gt;</span> 
                                            
    <span style="color: #A31515">&lt;resources&gt;</span> 
      <span style="color: #A31515">&lt;handler</span> <span style="color: #FF0000">protocol</span>=<span style="color: #0000FF">"db"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyCompany.MyApp.Resources.MyDbResource"</span><span style="color: #A31515">/&gt;</span> 
    <span style="color: #A31515">&lt;/resources&gt;</span> 
        
    <span style="color: #A31515">&lt;context</span> <span style="color: #FF0000">caseSensitive</span>=<span style="color: #0000FF">"false"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"config://spring/objects"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"db://user:pass@dbName/MyDefinitionsTable"</span><span style="color: #A31515">/&gt;</span>         
    <span style="color: #A31515">&lt;/context&gt;</span>
        
    <span style="color: #A31515">&lt;typeAliases&gt;</span>
       <span style="color: #A31515">&lt;alias</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"WebServiceExporter"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Services.WebServiceExporter, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
       <span style="color: #A31515">&lt;alias</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"DefaultPointcutAdvisor"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Aop.Support.DefaultPointcutAdvisor, Spring.Aop"</span><span style="color: #A31515">/&gt;</span>
       <span style="color: #A31515">&lt;alias</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"AttributePointcut"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Aop.Support.AttributeMatchMethodPointcut, Spring.Aop"</span><span style="color: #A31515">/&gt;</span>
       <span style="color: #A31515">&lt;alias</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"CacheAttribute"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Attributes.CacheAttribute, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
       <span style="color: #A31515">&lt;alias</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"MyType"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyCompany.MyProject.MyNamespace.MyType, MyAssembly"</span><span style="color: #A31515">/&gt;</span>
     <span style="color: #A31515">&lt;/typeAliases&gt;</span>
        
    <span style="color: #A31515">&lt;typeConverters&gt;</span>
      <span style="color: #A31515">&lt;converter</span> <span style="color: #FF0000">for</span>=<span style="color: #0000FF">"Spring.Expressions.IExpression, Spring.Core"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.TypeConverters.ExpressionConverter, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
      <span style="color: #A31515">&lt;converter</span> <span style="color: #FF0000">for</span>=<span style="color: #0000FF">"MyTypeAlias"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"MyCompany.MyProject.Converters.MyTypeConverter, MyAssembly"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/typeConverters&gt;</span>       

    <span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>
        ...
    <span style="color: #A31515">&lt;/objects&gt;</span>

  <span style="color: #A31515">&lt;/spring&gt;</span>

<span style="color: #A31515">&lt;/configuration&gt;</span>
        </pre><p> The new sections are described below. The attribute
    <code class="literal">caseSensitive</code> allows the for both
    <code class="literal">IObjectFactory</code> and
    <code class="literal">IApplicationContext</code> implementations to not pay
    attention to the case of the object names. This is important in web
    applications so that ASP.NET pages can be resolved in a case independent
    manner. The default value is true.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="context-custom-parsers"></a>5.11.1.&nbsp;Registering custom parsers</h3></div></div></div>
      

      <p>Instead of using the default XML schema that is generic in nature
      to define an object's properties and dependencies, you can create your
      own XML schema specific to an application domain. This has the benefit
      of being easier to type and getting XML intellisense for the schema
      being used. The downside is that you need to write code that will
      transform this XML into Spring object definitions. One would typically
      implement a custom parser by deriving from the class
      <code class="literal">ObjectsNamespaceParser</code> and overriding the methods
      <code class="literal"> int ParseRootElement(XmlElement root, XmlResourceReader
      reader)</code> and <code class="literal">int ParseElement(XmlElement element,
      XmlResourceReader reader)</code>. Registering custom parsers outside
      of App.config will be addressed in a future release.</p>

      <p>To register a custom parser register a section handler of the type
      <code class="literal">Spring.Context.Support.NamespaceParsersSectionHandler</code>
      in the configSecitons section of App.config. The parser configuration
      section contains one or more &lt;parser&gt; elements each with a type
      attribute. Below is an example that registers all the namespaces
      provided in Spring.</p>

      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/admons/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top">
        <p>As of Spring.NET 1.2.0 it is no longer necessary to explicitly
        configure the namespace parsers that come with Spring via a custom
        section in App.config. You will still need to register custom
        namespace parsers if you are writing your own.</p>
      </td></tr></table></div>

      <pre class="programlisting"><span style="color: #A31515">&lt;configuration&gt;</span>

  <span style="color: #A31515">&lt;configSections&gt;</span>
    <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>
      <i style="color: #008000">&lt;!-- other configuration section handler defined here --&gt;</i>
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"parsers"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.NamespaceParsersSectionHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span> 
     <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
  <span style="color: #A31515">&lt;/configSections&gt;</span>

  <span style="color: #A31515">&lt;spring&gt;</span>
    <span style="color: #A31515">&lt;parsers&gt;</span> 
      <span style="color: #A31515">&lt;parser</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Aop.Config.AopNamespaceParser, Spring.Aop"</span><span style="color: #A31515"> /&gt;</span> 
      <span style="color: #A31515">&lt;parser</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Data.Config.DatabaseNamespaceParser, Spring.Data"</span><span style="color: #A31515"> /&gt;</span> 
      <span style="color: #A31515">&lt;parser</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Transaction.Config.TxNamespaceParser, Spring.Data"</span><span style="color: #A31515"> /&gt;</span>
      <span style="color: #A31515">&lt;parser</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Validation.Config.ValidationNamespaceParser, Spring.Core"</span><span style="color: #A31515"> /&gt;</span>
      <span style="color: #A31515">&lt;parser</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Remoting.Config.RemotingNamespaceParser, Spring.Services"</span><span style="color: #A31515"> /&gt;</span>
    <span style="color: #A31515">&lt;/parsers&gt;</span> 
  <span style="color: #A31515">&lt;/spring&gt;</span>

<span style="color: #A31515">&lt;/configuration&gt;</span></pre>

      <p>You can also register custom parser programmatically using the
      NamespaceParserRegistry. Here is an example taken from the code used in
      the Transactions Quickstart application.</p>

      <pre class="programlisting">NamespaceParserRegistry.RegisterParser(<span style="color: #0000FF">typeof</span>(DatabaseNamespaceParser));
NamespaceParserRegistry.RegisterParser(<span style="color: #0000FF">typeof</span>(TxNamespaceParser));
NamespaceParserRegistry.RegisterParser(<span style="color: #0000FF">typeof</span>(AopNamespaceParser));

IApplicationContext context = 
      <span style="color: #0000FF">new</span> XmlApplicationContext(<span style="color: #000000">"assembly://Spring.TxQuickStart.Tests/Spring.TxQuickStart/system-test-local-config.xml"</span>);</pre>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="context-custom-resourcehandler"></a>5.11.2.&nbsp;Registering custom resource handlers</h3></div></div></div>
      

      <p>Creating a custom resource handler means implementing the
      <code class="literal">IResource</code> interface. The base class
      <code class="literal">AbstractResource</code> is a useful starting point. Look at
      the Spring source for classes such as
      <code class="literal">FileSystemResource</code> or
      <code class="literal">AssemblyResource</code> for implementation tips. You can
      register your custom resource handler either within App.config, as shown
      in the program listing at the start of this section using a
      .<code class="literal">ResourceHandlersSectionHandler</code> or define an object
      of the type
      <code class="literal">Spring.Objects.Factory.Config.ResourceHandlerConfigurer</code>
      as you would any other Spring managed object. An example of the latter
      is shown below:</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myResourceHandlers"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.</span><code class="literal">ResourceHandlersSectionHandler</code>, Spring.Core"&gt;
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ResourceHandlers"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;dictionary&gt;</span>
              <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"db"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"MyCompany.MyApp.Resources.MyDbResource, MyAssembly"</span><span style="color: #A31515">/&gt;</span>
          <span style="color: #A31515">&lt;/dictionary&gt;</span>
      <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="context-type-alias"></a>5.11.3.&nbsp;Registering Type Aliases</h3></div></div></div>
      

      <p>Type aliases allow you to simplify Spring configuration file by
      replacing fully qualified type name with an alias for frequently used
      types. Aliases can be registered both within a config file and
      programatically and can be used anywhere in the context config file
      where a fully qualified type name is expected. Type aliases can also be
      defined for generic types.</p>

      <p>One way to configure a type alias is to define them in a custom
      config section in the Web/App.config file for your application, as well
      as the custom configuration section handler. See the previous XML
      configuration listing for an example that makes an alias for the
      WebServiceExporter type. Once you have aliases defined, you can simply
      use them anywhere where you would normally specify a fully qualified
      type name:</p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"MyWebService"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"WebServiceExporter"</span><span style="color: #A31515">&gt;</span>
    ...
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"cacheAspect"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"DefaultPointcutAdvisor"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Pointcut"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"AttributePointcut"</span><span style="color: #A31515">&gt;</span>
            <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Attribute"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"CacheAttribute"</span><span style="color: #A31515">/&gt;</span>       
        <span style="color: #A31515">&lt;/object&gt;</span>
    <span style="color: #A31515">&lt;/property&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"Advice"</span> <span style="color: #FF0000">ref</span>=<span style="color: #0000FF">"aspNetCacheAdvice"</span><span style="color: #A31515">/&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <p>To register a type alias register a section handler of the type
      <code class="literal">Spring.Context.Support.TypeAliasesSectionHandler</code> in
      the configSecitons section of App.config. The type alias configuration
      section contains one or more &lt;alias&gt; elements each with a name and
      a type attribute. Below is an example that registers the alias for
      WebServiceExporter</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;configuration&gt;</span>

  <span style="color: #A31515">&lt;configSections&gt;</span>
    <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>
      <i style="color: #008000">&lt;!-- other configuration section handler defined here --&gt;</i>
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"parsers"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.TypeAliasesSectionHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span> 
     <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
  <span style="color: #A31515">&lt;/configSections&gt;</span>

  <span style="color: #A31515">&lt;spring&gt;</span>
    <span style="color: #A31515">&lt;typeAliases&gt;</span>
       <span style="color: #A31515">&lt;alias</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"WebServiceExporter"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Web.Services.WebServiceExporter, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/typeAliases&gt;</span>
  <span style="color: #A31515">&lt;/spring&gt;</span>

<span style="color: #A31515">&lt;/configuration&gt;</span></pre>

      <p>For an example showing type aliases for generic types see <a class="xref" href="objects.html#objects-creation-generic-types" title="5.2.6.&nbsp;Object creation of generic types">Section&nbsp;5.2.6, &#8220;Object creation of generic types&#8221;</a>.</p>

      <p>Another way is to define an object of the type
      <code class="literal">Spring.Objects.Factory.Config.TypeAliasConfigurer</code>
      within the regular &lt;objects&gt; section of any standard Spring
      configuration file. This approach allows for more modularity in defining
      type aliases, for example if you can't access App.config/Web.config. An
      example of registration using a <code class="literal">TypeAliasConfigurer</code>
      is shown below</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myTypeAlias"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.TypeAliasConfigurer, Spring.Core"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"TypeAliases"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;dictionary&gt;</span>
              <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"WebServiceExporter"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Spring.Web.Services.WebServiceExporter, Spring.Web"</span><span style="color: #A31515">/&gt;</span>
              <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"DefaultPointcutAdvisor"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"Spring.Aop.Support.DefaultPointcutAdvisor, Spring.Aop"</span><span style="color: #A31515">/&gt;</span>
              <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"MyType"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"MyCompany.MyProject.MyNamespace.MyType, MyAssembly"</span><span style="color: #A31515">/&gt;</span>
          <span style="color: #A31515">&lt;/dictionary&gt;</span>
      <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="context-type-converters"></a>5.11.4.&nbsp;Registering Type Converters</h3></div></div></div>
      

      <p>The standard .NET mechanism for specifying a type converter is to
      add a <code class="literal">TypeConverter</code> attribute to a type definition to
      specify the type of the Converter. This is the preferred way of defining
      type converters if you control the source code for the type that you
      want to define a converter for. However, this configuration section
      allows you to specify converters for the types that you don't control,
      and it also allows you to override some of the standard type converters,
      such as the ones that are defined for some of the types in the .NET Base
      Class Library.</p>

      <p>You can specify the type converters in App.config by using
      Spring.Context.Support.TypeConvertersSectionHandler as shown before or
      define an object of the type
      <code class="literal">Spring.Objects.Factory.Config.</code><code class="literal">CustomConverterConfigurer</code>.
      An example of registration using a
      <code class="literal">CustomConverterConfigurer</code> is shown below</p>

      <pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"myTypeConverters"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.CustomConverterConfigurer, Spring.Core"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"CustomConverters"</span><span style="color: #A31515">&gt;</span>
          <span style="color: #A31515">&lt;dictionary&gt;</span>
              <span style="color: #A31515">&lt;entry</span> <span style="color: #FF0000">key</span>=<span style="color: #0000FF">"System.Date"</span> <span style="color: #FF0000">value</span>=<span style="color: #0000FF">"MyCompany.MyProject.MyNamespace.MyCustomDateConverter, MyAssembly"</span><span style="color: #A31515">/&gt;</span>
          <span style="color: #A31515">&lt;/dictionary&gt;</span>
      <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="context-functionality"></a>5.12.&nbsp;Added functionality of the
    <code class="literal">IApplicationContext</code></h2></div></div></div>
    

    <p>As already stated in the previous section, the
    <code class="literal">IApplicationContext</code> has a couple of features that
    distinguish it from the <code class="literal">IObjectFactory</code>. Let us review
    them one-by-one.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="context-functionality-hierarchy"></a>5.12.1.&nbsp;Context Hierarchies</h3></div></div></div>
      

      <p>You can structure the configuration information of application
      context into hierarchies that naturally reflect the internal layering of
      your application. As an example, abstract object definitions may appear
      in a parent application context configuration file, possibly as an
      embedded assembly resource so as not to invite accidental changes.
      </p><pre class="programlisting"><span style="color: #A31515">&lt;spring&gt;</span>
  <span style="color: #A31515">&lt;context&gt;</span>
    <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"assembly://MyAssembly/MyProject/root-objects.xml"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;context</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"mySubContext"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"file://objects.xml"</span><span style="color: #A31515">/&gt;</span>	
    <span style="color: #A31515">&lt;/context&gt;</span>
  <span style="color: #A31515">&lt;/context&gt;</span>
<span style="color: #A31515">&lt;/spring&gt;</span></pre><p> The nesting of <code class="literal">context</code>
      elements reflects the parent-child hierarchy you are creating. The
      nesting can be to any level though it is unlikely one would need a deep
      application hierarchy. The xml file must contain the
      <code class="literal">&lt;objects&gt;</code> as the root name. Another example of
      a hierarchy, but using sections in the application configuration file is
      shown below. </p><pre class="programlisting"><span style="color: #A31515">&lt;configSections&gt;</span>
  <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"spring"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"context"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.ContextHandler, Spring.Core"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objects"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.DefaultSectionHandler, Spring.Core"</span><span style="color: #A31515"> /&gt;</span>
    <span style="color: #A31515">&lt;sectionGroup</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"child"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;section</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"objects"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.DefaultSectionHandler, Spring.Core"</span><span style="color: #A31515"> /&gt;</span>
    <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
  <span style="color: #A31515">&lt;/sectionGroup&gt;</span>
<span style="color: #A31515">&lt;/configSections&gt;</span>

<span style="color: #A31515">&lt;spring&gt;</span>

  <span style="color: #A31515">&lt;context</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ParentContext"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"config://spring/objects"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;context</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"ChildContext"</span><span style="color: #A31515">&gt;</span>
      <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"config://spring/child/objects"</span><span style="color: #A31515">/&gt;</span>
    <span style="color: #A31515">&lt;/context&gt;</span>
  <span style="color: #A31515">&lt;/context&gt;</span>

  <span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>

    ...

  <span style="color: #A31515">&lt;/objects&gt;</span>

  <span style="color: #A31515">&lt;child&gt;</span>
    <span style="color: #A31515">&lt;objects</span> <span style="color: #FF0000">xmlns</span>=<span style="color: #0000FF">"http://www.springframework.net"</span><span style="color: #A31515">&gt;</span>

      ...

    <span style="color: #A31515">&lt;/objects&gt;</span>
  <span style="color: #A31515">&lt;/child&gt;</span>

<span style="color: #A31515">&lt;/spring&gt;</span></pre>

      <p>As a reminder, the <code class="literal">type</code> attribute of the
      context tag is optional and defaults to
      <code class="literal">Spring.Context.Support.XmlApplicationContext</code>. The
      name of the context can be used in conjunction with the service locator
      class, <code class="literal">ContextRegistry</code>, discussed in <a class="xref" href="objects.html#objects-servicelocator" title="5.15.&nbsp;Service Locator access">Section&nbsp;5.15, &#8220;Service Locator access&#8221;</a></p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="context-functionality-messagesource"></a>5.12.2.&nbsp;Using <code class="literal">IMessageSource</code></h3></div></div></div>
      

      <p>The <code class="literal">IApplicationContext</code> interface extends an
      interface called <code class="literal">IMessageSource</code> and provides
      localization (i18n or internationalization) services for text messages
      and other resource data types such as images. This functionality makes
      it easier to use .NET's localization features at an application level
      and also offers some performance enhancements due to caching of
      retrieved resources. Together with the
      <code class="literal">NestingMessageSource</code>, capable of hierarchical message
      resolving, these are the basic interfaces Spring.NET provides for
      localization. Let's quickly review the methods defined there:
      </p><div class="itemizedlist"><ul type="disc" compact><li>
            <p><code class="literal">string GetMessage(string name)</code>: retrieves
            a message from the <code class="literal">IMessageSource</code> and using
            CurrentUICulture.</p>
          </li><li>
            <p><code class="literal">string GetMessage(string name, CultureInfo
            cultureInfo)</code>: retrieves a message from the
            <code class="literal">IMessageSource</code> using a specified
            culture.</p>
          </li><li>
            <p><code class="literal">string GetMessage(string name, params object[]
            args)</code>: retrieves a message from the
            <code class="literal">IMessageSource</code> using a variable list of
            arguments as replacement values in the message. The
            CurrentUICulture is used to resolve the message.</p>
          </li><li>
            <p><code class="literal">string GetMessage(string name, CultureInfo
            cultureInfo, params object[] args)</code>: retrieves a message
            from the <code class="literal">IMessageSource</code> using a variable list
            of arguments as replacement values in the message. The specified
            culture is used to resolve the message.</p>
          </li><li>
            <p><code class="literal">string GetMessage(string name, string
            defaultMessage, CultureInfo culture, params object[]
            arguments)</code>: retrieves a message from the
            <code class="literal">IMessageSource</code> using a variable list of
            arguments as replacement values in the message. The specified
            culture is used to resolve the message. If no message can be
            resolved, the default message is used.</p>
          </li><li>
            <p><code class="literal">string GetMessage(IMessageSourceResolvable
            resolvable, CultureInfo culture) </code>: all properties used
            in the methods above are also wrapped in a class - the
            <code class="literal">MessageSourceResolvable</code>, which you can use in
            this method.</p>
          </li><li>
            <p><code class="literal">object GetResourceObject(string name)</code>:Get
            a localized resource object, i.e. Icon, Image, etc. given the
            resource name. The CurrentUICulture is used to resolve the
            resource object.</p>
          </li><li>
            <p><code class="literal">object GetResourceObject(string name, CultureInfo
            cultureInfo)</code>:Get a localized resource object, i.e. Icon,
            Image, etc. given the resource name. The specified culture is used
            to resolve the resource object.</p>
          </li><li>
            <p><code class="literal">void ApplyResources(object value, string
            objectName, CultureInfo cultureInfo)</code>: Uses a
            ComponentResourceManager to apply resources to all object
            properties that have a matching key name. Resource key names are
            of the form objectName.propertyName</p>
          </li></ul></div>

      <p>When an <code class="literal">IApplicationContext</code> gets loaded, it
      automatically searches for an <code class="literal">IMessageSource</code> object
      defined in the context. The object has to have the name
      <code class="literal">messageSource</code>. If such an object is found, all calls
      to the methods described above will be delegated to the message source
      that was found. If no message source was found, the
      <code class="literal">IApplicationContext</code> checks to see if it has a parent
      containing a similar object, with a similar name. If so, it uses that
      object as the <code class="literal">IMessageSource</code>. If it can't find any
      source for messages, an empty <code class="literal">StaticMessageSource</code>
      will be instantiated in order to be able to accept calls to the methods
      defined above.</p>

      <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning: Fallback behavior"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="images/admons/warning.png"></td><th align="left">Fallback behavior</th></tr><tr><td align="left" valign="top">
        

        <p>The fallback rules for localized resources seem to have a bug
        that is fixed by applying Service Pack 1 for .NET 1.1. This affects
        the use of IMessageSource.GetMessage methods that specify CultureInfo.
        The core of the issue in the .NET BCL is the method
        ResourceManager.GetObject that accepts CultureInfo.</p>
      </td></tr></table></div>

      <p>Spring.NET provides two <code class="literal">IMessageSource</code>
      implementations. These are <code class="literal">ResourceSetMessageSource</code>
      and <code class="literal">StaticMessageSource</code>. Both implement
      <code class="literal">IHierarchicalMessageSource</code> to resolve messages
      hierarchically. The <code class="literal">StaticMessageSource</code> is hardly
      ever used but provides programmatic ways to add messages to the source.
      The <code class="literal">ResourceSetMessageSource</code> is more interesting and
      an example is provided for in the distribution and discussed more
      extensively in the <a class="xref" href="quickstarts.html" title="Chapter&nbsp;35.&nbsp;IoC Quickstarts">Chapter&nbsp;35, <i>IoC Quickstarts</i></a> section. The
      <code class="literal">ResourceSetMessageSource</code> is configured by providing a
      list of <code class="literal">ResourceManager</code>s. When a message code is to
      be resolved, the list of ResourceManagers is searched to resolve the
      code. For each <code class="literal">ResourceManager</code> a
      <code class="literal">ResourceSet</code> is retrieved and asked to resolve the
      code. Note that this search does not replace the standard hub-and-spoke
      search for localized resources. The ResourceManagers list specifies the
      multiple 'hubs' where the standard search starts. </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"messageSource"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Context.Support.ResourceSetMessageSource, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"resourceManagers"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;list&gt;</span>
       <span style="color: #A31515">&lt;value&gt;</span>Spring.Examples.AppContext.MyResource, Spring.Examples.AppContext<span style="color: #A31515">&lt;/value&gt;</span>
    <span style="color: #A31515">&lt;/list&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <p>You can specify the arguments to construct a ResourceManager as a
      two part string value containing the base name of the resource and the
      assembly name. This will be converted to a ResourceManager via the
      <code class="literal">ResourceManagerConverter</code> TypeConverter. This
      converter can be similarly used to set a property on any object that is
      of the type <code class="literal">ResourceManager.</code> You may also specify an
      instance of the <code class="literal">ResourceManager</code> to use via an object
      reference. The convenience class
      <code class="literal">Spring.Objects.Factory.Config.ResourceManagerFactoryObject</code>
      can be used to conveniently create an instance of a ResourceManager.
      </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"myResourceManager"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Spring.Objects.Factory.Config.ResourceManagerFactoryObject, Spring.Core"</span><span style="color: #A31515">&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"baseName"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>Spring.Examples.AppContext.MyResource<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>
  <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"assemblyName"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;value&gt;</span>Spring.Examples.AppContext<span style="color: #A31515">&lt;/value&gt;</span>
  <span style="color: #A31515">&lt;/property&gt;</span>    
<span style="color: #A31515">&lt;/object&gt;</span></pre>

      <p>In application code, a call to <code class="literal">GetMessage</code> will
      retrieve a properly localized message string based on a code value. Any
      arguments present in the retrieved string are replaced using
      <code class="literal">String.Format</code> semantics. The ResourceManagers,
      ResourceSets and retrieved strings are cached to provide quicker lookup
      performance. The key 'HelloMessage' is contained in the resource file
      with a value of <code class="literal">Hello {0} {1}</code>. The following call on
      the application context will return the string <code class="literal">Hello Mr.
      Anderson</code>. <span class="emphasis"><em>Note</em></span> that the caching of
      ResourceSets is via the concatenation of the ResourceManager base name
      and the CultureInfo string. This combination must be unique.
      </p><pre class="programlisting"><span style="color: #0000FF">string</span> msg = ctx.GetMessage(<span style="color: #000000">"HelloMessage"</span>, 
                            <span style="color: #0000FF">new</span> <span style="color: #0000FF">object</span>[] {<span style="color: #000000">"Mr."</span>, <span style="color: #000000">"Anderson"</span>}, 
                            CultureInfo.CurrentCulture );
</pre>

      <p>It is possible to chain the resolution of messages by passing
      arguments that are themselves messages to be resolved giving you greater
      flexibility in how you can structure your message resolution. This is
      achieved by passing as an argument a class that implements
      <code class="literal">IMessageResolvable</code> instead of a string literal. The
      convenience class <code class="literal">DefaultMessageResolvable</code> is
      available for this purpose. As an example if the resource file contains
      a key name <code class="literal">error.required</code> that has the value
      '<code class="literal">{0} is required {1}</code>' and another key name
      <code class="literal">field.firstname</code> with the value '<code class="literal">First
      name</code>'. The following code will create the string
      '<code class="literal">First name is required dude!</code>' </p><pre class="programlisting"><span style="color: #0000FF">string</span>[] codes = {<span style="color: #000000">"field.firstname"</span>};
DefaultMessageResolvable dmr = <span style="color: #0000FF">new</span> DefaultMessageResolvable(codes, <span style="color: #0000FF">null</span>);
ctx.GetMessage(<span style="color: #000000">"error.required"</span>, 
		<span style="color: #0000FF">new</span> <span style="color: #0000FF">object</span>[] { dmr, <span style="color: #000000">"dude!"</span> }, 
                CultureInfo.CurrentCulture ));
</pre>

      <p>The examples directory in the distribution contains an example
      program, <code class="literal">Spring.Examples.AppContext</code>, that
      demonstrates usage of these features.</p>

      <p>The <code class="literal">IMessageSourceAware</code> interface can also be
      used to acquire a reference to any <code class="literal">IMessageSource</code>
      that has been defined. Any object that is defined in an
      <code class="literal">IApplicationContext</code> that implements the
      <code class="literal">IMessageSourceAware</code> interface will be injected with
      the application context's <code class="literal">IMessageSource</code> when it (the
      object) is being created and configured.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="context-functionality-resources"></a>5.12.3.&nbsp;Using resources within Spring.NET</h3></div></div></div>
      

      <p>A lot of applications need to access resources. Resources here,
      might mean files, but also news feeds from the Internet or normal web
      pages. Spring.NET provides a clean and transparent way of accessing
      resources in a protocol independent way. The
      <code class="literal">IApplicationContext</code> has a method
      (<code class="literal">GetResource(string)</code>) to take care of this. Refer to
      <a class="xref" href="resources.html#objects-iresource" title="7.1.&nbsp;Introduction">Section&nbsp;7.1, &#8220;Introduction&#8221;</a> for more information on the string
      format to use and the <code class="literal">IResource</code> abstraction in
      general.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="context-functionality-pubsub"></a>5.12.4.&nbsp;Loosely coupled events</h3></div></div></div>
      

      <p>The Eventing Registry allows developers to utilize a loosely
      coupled event wiring mechanism. By decoupling the event publication and
      the event subscription, most of the mundane event wiring is handled by
      the IoC container. Event publishers can publish their event to a central
      registry, either all of their events or a subset based on criteria such
      as delegate type, name, return value, etc... Event subscribers can
      choose to subscribe to any number of published events. Subscribers can
      subscriber to events based on the type of object exposing them, allowing
      one subscriber to handle all events of a certain type without regards to
      how many different instances of that type are created.</p>

      <p>The <code class="literal">Spring.Objects.Events.IEventRegistry</code>
      interface represents the central registry and defines publish and
      subscribe methods. </p><div class="itemizedlist"><ul type="disc" compact><li>
            <p><code class="literal">void PublishEvents( object sourceObject
            )</code>: publishes all events of the source object to
            subscribers that implement the correct handler methods.</p>
          </li><li>
            <p><code class="literal">void Subscribe(object subscriber )</code>: The
            subscriber receives all events from the source object for which it
            has matching handler methods.</p>
          </li><li>
            <p><code class="literal">void Subscribe(object subscriber, Type
            targetSourceType )</code>: The subscriber receives all events
            from a source object of a particular type for which it has
            matching handler methods.</p>
          </li><li>
            <p><code class="literal">void Unsubscribe(object subscriber )</code>:
            Unsubscribe all events from the source object for which it has
            matching handler methods.</p>
          </li><li>
            <p><code class="literal">void Unsubscribe(object subscriber, Type
            targetSourceType )</code>: Unsubscribe all events from a source
            object of a particular type for which it has matching handler
            methods.</p>
          </li></ul></div><p> <code class="literal">IApplicationContext</code> implements this
      interface and delegates the implementation to an instance of
      <code class="literal">Spring.Objects.Events.Support.EventRegistry</code>. You are
      free to create and use as many EventRegistries as you like but since it
      is common to use only one in an application,
      <code class="literal">IApplicationContext</code> provides convenient access to a
      single instance.</p>

      <p>Within the
      <code class="literal">example/Spring/Spring.Examples.EventRegistry</code>
      directory you will find an example on how to use this functionality.
      When you open up the project, the most interesting file is the
      EventRegistryApp.cs file. This application loads a set of object
      definitions from the application configuration file into an
      <code class="literal">IApplicationContext</code> instance. From there, three
      objects are loaded up: one publisher and two subscribers. The publisher
      publishes its events to the <code class="literal">IApplicationContext</code>
      instance: </p><pre class="programlisting"><i style="color: #008000">// Create the Application context using configuration file</i>
IApplicationContext ctx = ContextRegistry.GetContext();

<i style="color: #008000">// Gets the publisher from the application context</i>
MyEventPublisher publisher = (MyEventPublisher)ctx.GetObject(<span style="color: #000000">"MyEventPublisher"</span>);

<i style="color: #008000">// Publishes events to the context.</i>
ctx.PublishEvents( publisher );
</pre><p> One of the two subscribers subscribes to all events
      published to the <code class="literal">IApplicationContext</code> instance, using
      the publisher type as the filter criteria.</p><pre class="programlisting"><i style="color: #008000">// Gets first instance of subscriber</i>
MyEventSubscriber subscriber = (MyEventSubscriber)ctx.GetObject(<span style="color: #000000">"MyEventSubscriber"</span>);

<i style="color: #008000">// Gets second instance of subscriber</i>
MyEventSubscriber subscriber2 = (MyEventSubscriber)ctx.GetObject(<span style="color: #000000">"MyEventSubscriber"</span>);

<i style="color: #008000">// Subscribes the first instance to the any events published by the type MyEventPublisher</i>
ctx.Subscribe( subscriber, <span style="color: #0000FF">typeof</span>(MyEventPublisher) );</pre><p> This
      will wire the first subscriber to the original event publisher. Anytime
      the event publisher fires an event,
      (<code class="literal">publisher.ClientMethodThatTriggersEvent1();</code>) the
      first subscriber will handle the event, but the second subscriber will
      not. This allows for selective subscription, regardless of the original
      prototype definition.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="context-functionality-events"></a>5.12.5.&nbsp;Event notification from
      <code class="literal">IApplicationContext</code></h3></div></div></div>
      

      <p>Event handling in the <code class="literal">IApplicationContext</code> is
      provided through the <code class="literal">IApplicationEventListener</code>
      interface that contains the single method <code class="literal">void
      HandleApplicationEvent( object source, ApplicationEventArgs
      applicationEventArgs )</code>. Classes that implement the
      <code class="literal">IApplicationEventListener</code> interface are automatically
      registered as a listener with the
      <code class="literal">IApplicationContext</code>. Publishing an event is done via
      the context's <code class="literal">PublishEvent( ApplicationEventArgs eventArgs
      )</code> method. This implementation is based on the traditional
      <span class="emphasis"><em>Observer</em></span> design pattern.</p>

      <p>The event argument type, <code class="literal">ApplicationEventArgs</code>,
      adds the time of the event firing as a property. The derived class
      <code class="literal">ContextEventArgs</code> is used to notify observers on the
      lifecycle events of the application context. It contains a property
      <code class="literal">ContextEvent Event</code> that returns the enumeration
      <code class="literal">Refreshed</code> or <code class="literal">Closed.</code>. The
      <code class="literal">Refreshed</code> enumeration value indicated that the
      <code class="literal">IApplicationContext</code> was either initialized or
      refreshed. Initialized here means that all objects are loaded,
      singletons are pre-instantiated and the
      <code class="literal">IApplicationContext</code> is ready for use. The
      <code class="literal">Closed</code> is published when the
      <code class="literal">IApplicationContext</code> is closed using the
      <code class="literal">Dispose()</code> method on the
      <code class="literal">IConfigurableApplicationContext</code> interface. Closed
      here means that singletons are destroyed.</p>

      <p>Implementing custom events can be done as well. Simply call the
      <code class="literal">PublishEvent</code> method on the
      <code class="literal">IApplicationContext</code>, specifying a parameter which is
      an instance of your custom event argument subclass.</p>

      <p>Let's have a look at an example. First, the
      <code class="literal">IApplicationContext</code>: </p><pre class="programlisting"><span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"emailer"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Example.EmailObject"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"blackList"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;list&gt;</span>
            <span style="color: #A31515">&lt;value&gt;</span>black@list.org<span style="color: #A31515">&lt;/value&gt;</span>
            <span style="color: #A31515">&lt;value&gt;</span>white@list.org<span style="color: #A31515">&lt;/value&gt;</span>
            <span style="color: #A31515">&lt;value&gt;</span>john@doe.org<span style="color: #A31515">&lt;/value&gt;</span>
        <span style="color: #A31515">&lt;/list&gt;</span>
    <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span>

<span style="color: #A31515">&lt;object</span> <span style="color: #FF0000">id</span>=<span style="color: #0000FF">"blackListListener"</span> <span style="color: #FF0000">type</span>=<span style="color: #0000FF">"Example.BlackListNotifier"</span><span style="color: #A31515">&gt;</span>
    <span style="color: #A31515">&lt;property</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"notificationAddress"</span><span style="color: #A31515">&gt;</span>
        <span style="color: #A31515">&lt;value&gt;</span>spam@list.org<span style="color: #A31515">&lt;/value&gt;</span>
    <span style="color: #A31515">&lt;/property&gt;</span>
<span style="color: #A31515">&lt;/object&gt;</span></pre><p> and then, the actual objects: </p><pre class="programlisting"><span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> EmailObject : IApplicationContextAware {

    <i style="color: #008000">// the blacklist</i>
    <span style="color: #0000FF">private</span> IList blackList;
    
    <span style="color: #0000FF">public</span> IList BlackList
    {
      <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.blackList = <span style="color: #0000FF">value</span>; }
    }
    
    <span style="color: #0000FF">public</span> IApplicationContext ApplicationContext
    {
      <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.ctx = <span style="color: #0000FF">value</span>; }
    }
    
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">void</span> SendEmail(<span style="color: #0000FF">string</span> address, <span style="color: #0000FF">string</span> text) {
        <span style="color: #0000FF">if</span> (blackList.contains(address))
        {
            BlackListEvent evt = <span style="color: #0000FF">new</span> BlackListEvent(address, text);
            ctx.publishEvent(evt);
            <span style="color: #0000FF">return</span>;
        }
        <i style="color: #008000">// send email...</i>
    }
}

<span style="color: #0000FF">public</span> <span style="color: #0000FF">class</span> BlackListNotifier : IApplicationEventListener
{

    <i style="color: #008000">// notification address</i>
    <span style="color: #0000FF">private</span> <span style="color: #0000FF">string</span> notificationAddress;
    
    <span style="color: #0000FF">public</span> <span style="color: #0000FF">string</span> NotificationAddress
    {
      <span style="color: #0000FF">set</span> { <span style="color: #0000FF">this</span>.notificationAddress = <span style="color: #0000FF">value</span>; }
    }

    <span style="color: #0000FF">public</span> <span style="color: #0000FF">void</span> HandleApplicationEvent(ApplicationEvent evt)
    {
        <span style="color: #0000FF">if</span> (evt instanceof BlackListEvent)
        {
            <i style="color: #008000">// notify appropriate person</i>
        }
    }
}</pre>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-context-customization"></a>5.13.&nbsp;Customized behavior in the ApplicationContext</h2></div></div></div>
    

    <p>The <code class="literal">IObjectFactory</code> already offers a number of
    mechanisms to control the lifecycle of objects deployed in it (such as
    marker interfaces like <code class="literal">IInitializingObject</code> and
    <code class="literal">System.IDisposable</code>, their configuration only
    equivalents such as <code class="literal">init-method</code> and
    <code class="literal">destroy-method</code>) attributes in an XmlObjectFactory
    configuration, and object post-processors. In an
    <code class="literal">IApplicationContext</code>, all of these still work, but
    additional mechanisms are added for customizing behavior of objects and
    the container.</p>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-context-applicationcontextaware"></a>5.13.1.&nbsp;The <code class="literal">IApplicationContextAware</code> marker
      interface</h3></div></div></div>
      

      <p>All marker interfaces available with ObjectFactories still work.
      The <code class="literal">IApplicationContext</code> does add one extra marker
      interface which objects may implement,
      <code class="literal">IApplicationContextAware</code>. An object which implements
      this interface and is deployed into the context will be called back on
      creation of the object, using the interface's
      <code class="literal">ApplicationContext</code> property, and provided with a
      reference to the context, which may be stored for later interaction with
      the context.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-context-objectpostprocessor"></a>5.13.2.&nbsp;The <code class="literal">IObjectPostProcessor</code></h3></div></div></div>
      

      <p>Object post-processors are classes which implement the
      <code class="literal">Spring.Objects.Factory.Config.IObjectPostProcessor</code>
      interface, have <a class="link" href="objects.html#objects-factory-customizing" title="5.9.1.&nbsp;Customizing objects with IObjectPostProcessors">already</a> been mentioned. It
      is worth mentioning again here though, that post-processors are much
      more convenient to use in <code class="literal">IApplicationContext</code>s than
      in plain <code class="literal">IObjectFactory</code> instances. In an
      <code class="literal">IApplicationContext</code>, any deployed object which
      implements the above marker interface is automatically detected and
      registered as an object post-processor, to be called appropriately at
      creation time for each object in the factory.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-context-objectfactorypostprocessor"></a>5.13.3.&nbsp;The <code class="literal">IObjectFactoryPostProcessor</code></h3></div></div></div>
      

      <p>Object factory post-processors are classes which implement the
      <code class="literal">Spring.Objects.Factory.Config.IObjectFactoryPostProcessor</code>
      interface, have <a class="link" href="objects.html#objects-factory-customizing-factory-postprocessors" title="5.9.2.&nbsp;Customizing configuration metadata with ObjectFactoryPostProcessors">already</a>
      been mentioned. It is worth mentioning again here though, that object
      factory post-processors are much more convenient to use in
      <code class="literal">IApplicationContext</code>s. In an
      <code class="literal">IApplicationContext</code>, any deployed object which
      implements the above marker interface is automatically detected as an
      object factory post-processor, to be called at the appropriate
      time.</p>
    </div>

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="objects-context-placeholderconfigurer"></a>5.13.4.&nbsp;The <code class="literal">PropertyPlaceholderConfigurer</code></h3></div></div></div>
      

      <p>The <code class="literal">PropertyPlaceholderConfigurer</code> has <a class="link" href="objects.html#objects-factory-placeholderconfigurer" title="5.9.2.1.&nbsp;Example: The PropertyPlaceholderConfigurer">already</a> been
      described in the context of its use within an
      <code class="literal">IObjectFactory</code>. It is worth mentioning here though,
      that it is generally more convenient to use it with an
      <code class="literal">IApplicationContext</code>, since the context will
      automatically recognize and apply any object factory post-processors,
      such as this one, when they are simply deployed into it like any other
      object. There is no need for a manual step to execute it.</p>
    </div>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e2504"></a>5.14.&nbsp;Configuration of ApplicationContext without using XML</h2></div></div></div>
    

    <p>The class GenericApplicationContext can be used as a basis for
    creating an IApplicationContext implementation that read the container
    metadata from sources other than XML. This could be by scanning objects in
    a .DLL for known attributes or a scripting language that leverages a DSL
    to create terse IObjectDefinitions. There is a class,
    Spring.Objects.Factory.Support.ObjectDefinitionBuilder offers some
    convenience methods for creating an IObjectDefinition in a less verbose
    manner than using the RootObjectDefinition API. The following shows how to
    configure the GenericApplicationContext to read from XML, just so show
    familiar API usage</p>

    <pre class="programlisting">GenericApplicationContext ctx = <span style="color: #0000FF">new</span> GenericApplicationContext();
XmlObjectDefinitionReader reader = <span style="color: #0000FF">new</span> XmlObjectDefinitionReader(ctx);
reader.LoadObjectDefinitions(<span style="color: #000000">"assembly://Spring.Core.Tests/Spring.Context.Support/contextB.xml"</span>);
reader.LoadObjectDefinitions(<span style="color: #000000">"assembly://Spring.Core.Tests/Spring.Context.Support/contextC.xml"</span>);
reader.LoadObjectDefinitions(<span style="color: #000000">"assembly://Spring.Core.Tests/Spring.Context.Support/contextA.xml"</span>);
ctx.Refresh();</pre>

    <p>The implementation of IObjectDefinitionReader is responsible for
    creating the configuration metadata, i.e., implementations of
    RootObjectDefinition, etc. Note a web version of this application class
    has not yet been implemented.</p>

    <p>An example, with a<span class="emphasis"><em> yet to be created</em></span> DLL
    scanner, that would get configuration metadata from the .dll named
    MyAssembly.dll located in the runtime path, would look something like
    this</p>

    <pre class="programlisting">GenericApplicationContext ctx = <span style="color: #0000FF">new</span> GenericApplicationContext();
ObjectDefinitionScanner scanner = <span style="color: #0000FF">new</span> ObjectDefinitionScanner(ctx);
scanner.scan(<span style="color: #000000">"MyAssembly.dll"</span>);
ctx.refresh();</pre>

    <p>Refer to the Spring API documentation for more information.</p>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="objects-servicelocator"></a>5.15.&nbsp;Service Locator access</h2></div></div></div>
    

    <p>The majority of the code inside an application is best written in a
    Dependency Injection (Inversion of Control) style, where that code is
    served out of an <code class="literal">IObjectFactory</code> or
    <code class="literal">IApplicationContext</code> container, has its own dependencies
    supplied by the container when it is created, and is completely unaware of
    the container. However, there is sometimes a need for singleton (or
    quasi-singleton) style access to an <code class="literal">IObjectFactory</code> or
    <code class="literal">IApplicationContext</code>. For example, third party code may
    try to construct a new object directly without the ability to force it to
    get these objects out of the IObjectFactory. Similarly, nested user
    control components in a WinForms application are created inside the
    generated code in InitializeComponent. If this user control would like to
    obtain references to objects contained in the container it can use the
    service locator style approach and 'reach out' from inside the code to
    obtain the object it requires. (Note support for DI in WinForms is under
    development.)</p>

    <p>The <code class="literal">Spring.Context.Support.ContextRegistry</code> class
    allows you to obtain a reference to an
    <code class="literal">IApplicationContext</code> via a static locator method. The
    <code class="literal">ContextRegistry</code> is initialized when creating an
    <code class="literal">IApplicationContext</code> through use of the
    <code class="literal">ContextHandler</code> discussed previously. The simple static
    method <code class="literal">GetContext()</code> can then be used to retrieve the
    context. Alternatively, if you create an
    <code class="literal">IApplicationContext</code> though other means you can register
    it with the <code class="literal">ContextRegistry</code> via the method
    <code class="literal">void RegisterContext(IApplicationContext context)</code> in
    the start-up code of your application. Hierarchical context retrieval is
    also supported though the use of the <code class="literal">GetContext(string
    name)</code> method, for example:</p><pre class="programlisting">IApplicationContex ctx = ContextRegistry.GetContext(<span style="color: #000000">"mySubContext"</span>);</pre><p>
    This would retrieve the nested context for the context configuration shown
    previously.</p><pre class="programlisting"><span style="color: #A31515">&lt;spring&gt;</span>
  <span style="color: #A31515">&lt;context&gt;</span>
    <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"assembly://MyAssembly/MyProject/root-objects.xml"</span><span style="color: #A31515">/&gt;</span>
	<span style="color: #A31515">&lt;context</span> <span style="color: #FF0000">name</span>=<span style="color: #0000FF">"mySubContext"</span><span style="color: #A31515">&gt;</span>
	    <span style="color: #A31515">&lt;resource</span> <span style="color: #FF0000">uri</span>=<span style="color: #0000FF">"file://objects.xml"</span><span style="color: #A31515">/&gt;</span>	
        <span style="color: #A31515">&lt;/context&gt;</span>
  <span style="color: #A31515">&lt;/context&gt;</span>
<span style="color: #A31515">&lt;/spring&gt;</span></pre>

    <p>Do not call ContextRegistry.GetContext within a constructor as it
    will result in and endless recursion. (This is scheduled to be fixed in
    1.1.1) In this case it is quite likely you can use the
    IApplicationContextAware interface and then retrieve other objects in a
    service locator style inside an initialization method.</p>

    <p>The <code class="literal">ContextRegistry.Clear()</code> method will remove
    all contexts. On .NET 2.0, this will also call the ConfigurationManager's
    RefreshSection method so that the Spring context configuration section
    will be reread from disk when it is retrieved again. Note that in a web
    application RefeshSection will not work as advertised and you will need to
    touch the web.config files to reload a configuration.</p>
  </div>

  <div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e2536"></a>5.16.&nbsp;Stereotype attributes</h2></div></div></div>
    

    <p>Beginning with Spring 1.2, the [Repository] attribute was introduced
    as a marker for any class that fulfills the role or stereotype of a
    repository (a.k.a. Data Access Object or DAO). Among the possibilities for
    leveraging such a marker is the automatic translation of exceptions as
    described in <a class="link" href="orm.html#orm-hibernate-straight-ex" title="21.2.4.1.&nbsp;Exception Translation">Exception
    Translation.</a></p>

    <p>Spring 1.2 introduces further stereotype annotations: [Component]
    and [Service]. [Component] serves as a generic stereotype for any
    Spring-managed component; whereas, [Repository] and [Service] serve as
    specializations of [Component] for more specific use cases (e.g., in the
    persistence and service layers, respectively). The ASP.NET MVC
    [Controller] attribute will serve this purpose for the controller layer.
    What this means is that you can annotate your component classes with
    [Component], but by annotating them with [Repository] or [Service] your
    classes are more properly suited for processing by tools or associating
    with aspects. For example, these stereotype annotations make ideal targets
    for pointcuts. Of course, it is also possible that [Repository] and
    [Service] may carry additional semantics in future releases of the Spring
    Framework. Thus, if you are making a decision between using [Component] or
    [Service] for your service layer, [Service] is clearly the better choice.
    Similarly, as stated above, [Repository] is already supported as a marker
    for automatic exception translation in your persistence layer. The next
    version of Spring will use the [Component] attribute to perform attribute
    based autowiring by-type as in the Spring Java Framework.</p>
  </div>
<div class="footnotes"><br><hr width="100" align="left"><div class="footnote">
        <p><sup>[<a name="ftn.d4e276" href="#d4e276" class="para">1</a>] </sup>See the section entitled <a class="xref" href="background.html#background-ioc" title="3.1.&nbsp;Inversion of Control">Section&nbsp;3.1, &#8220;Inversion of Control&#8221;</a></p>
      </div><div class="footnote">
            <p><sup>[<a name="ftn.d4e579" href="#d4e579" class="para">2</a>] </sup>More information about assembly names can be found in the
            <span class="emphasis"><em>Assembly Names</em></span> section of the .NET Framework
            Developer's Guide (installed as part of the .NET SDK), or online
            at Microsoft's MSDN website, by searching for <span class="emphasis"><em>Assembly
            Names</em></span>.</p>
          </div><div class="footnote">
        <p><sup>[<a name="ftn.d4e1474" href="#d4e1474" class="para">3</a>] </sup>More information about creating custom
        <code class="literal">TypeConverter</code> implementations can be found online
        at Microsoft's MSDN website, by searching for <span class="emphasis"><em>Implementing a
        Type Converter</em></span>.</p>
      </div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" class="navfooter"><hr></hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="spring-core.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="objects-misc.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Part&nbsp;I.&nbsp;Core Technologies&nbsp;</td><td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.springsource.com/" title="SpringSource">Sponsored by SpringSource</a></span></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;6.&nbsp;The IObjectWrapper and Type conversion</td></tr></table></div></body></html>